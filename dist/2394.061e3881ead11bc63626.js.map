{"version":3,"file":"2394.061e3881ead11bc63626.js","mappings":"gNAyBA,MAiCA,GAAeA,EAAAA,EAAAA,KAAKC,EAAAA,EAAAA,IAClB,CAACC,GAAUC,aACT,MAAMC,GAAOC,EAAAA,EAAAA,KAAkBH,GACzBI,EAAOH,IAAUI,EAAAA,EAAAA,KAAWL,EAAQC,GAG1C,MAAO,CACLC,OACAI,YAJkBF,GAAOG,EAAAA,EAAAA,IAAuBH,QAAQI,IAJ1CT,CAjCiCU,EACnDC,SACAR,OACAD,SACAK,cACAK,cAEA,MAAM,iBAAEC,IAAqBC,EAAAA,EAAAA,MAEvBC,GAAOC,EAAAA,EAAAA,KAEPC,GAAyBC,EAAAA,EAAAA,IAAY,KACzCL,EAAiB,CAAEM,OAAQhB,EAAMiB,GAAIlB,OAAQA,IAC7CU,KACC,CAACT,EAAMU,EAAkBD,EAASV,IAErC,GAAKC,GAASD,EAId,OACEmB,EAAAA,EAAAA,GAACC,EAAAA,EAAa,CACZX,OAAQA,EACRC,QAASA,EACTW,MAAOR,EAAK,uBACZS,WAAWC,EAAAA,EAAAA,GAAWV,EAAK,8BAA+BR,IAC1DmB,aAAcX,EAAK,kBACnBY,eAAgBV,EAChBW,sBAAoB,M,oECzC1B,MAYA,GAAe7B,EAAAA,EAAAA,IAZE8B,EACfC,eAEA,MAAMf,GAAOgB,EAAAA,EAAAA,KAEb,OACEV,EAAAA,EAAAA,GAAA,QAAMW,UAAU,WAAUC,SACvBlB,EAAkB,SAAbe,EAAsB,cAAgB,kB,8CCIlD,QApBoBI,CAACC,EAA2BC,KAC1CC,EAAAA,KACFF,EAAUG,MAAMC,SAAW,eAGX9B,IAAd2B,IACFD,EAAUC,UAAYA,GAGpBC,EAAAA,KACFF,EAAUG,MAAMC,SAAW,I,gCC4B/B,MAAMC,EAAY,CAAC,EAAG,GAAI,GAAI,GAAI,IAAK,GAAI,GAAI,GAAI,IAAK,GAAI,IAAK,GAAI,IAAK,GAAI,GAAI,IAAK,IAAK,IAAK,EAAG,IAAK,GAAI,GAAI,GAAI,IAAK,IAAK,IAAK,IAAK,GAAI,GAAI,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,EAAG,IAAK,GAAI,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,GAAI,IAAK,GAAI,IAAK,IAAK,IAAK,IAAK,GAAI,IAAK,EAAG,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,GAAI,IAAK,IAAK,GAAI,GAAI,IAAK,IAAK,GAAI,GAAI,GAAI,IAAK,IAAK,IAAK,EAAG,IAAK,IAAK,GAAI,IAAK,IAAK,IAAK,IAAK,GAAI,IAAK,IAAK,IAAK,IAAK,IAAK,GAAI,GAAI,GAAI,GAAI,GAAI,IAAK,IAAK,IAAK,GAAI,IAAK,IAAK,GAAI,IAAK,GAAI,IAAK,EAAG,GAAI,IAAK,GAAI,GAAI,IAAK,IAAK,IAAK,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,IAAK,IAAK,IAAK,IAAK,IAAK,GAAI,GAAI,IAAK,IAAK,IAAK,IAAK,GAAI,IAAK,IAAK,IAAK,GAAI,IAAK,IAAK,GAAI,IAAK,IAAK,GAAI,GAAI,IAAK,IAAK,IAAK,GAAI,GAAI,GAAI,GAAI,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,GAAI,GAAI,GAAI,GAAI,GAAI,IAAK,IAAK,IAAK,GAAI,IAAK,IAAK,IAAK,GAAI,GAAI,IAAK,IAAK,IAAK,GAAI,IAAK,IAAK,GAAI,IAAK,IAAK,IAAK,IAAK,GAAI,IAAK,IAAK,IAAK,IAAK,GAAI,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,GAAI,IAAK,GAAI,GAAI,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,IAAK,GAAI,GAAI,IAAK,IAAK,GAAI,IAAK,IAAK,EAAG,GAAI,IAAK,GAAI,IAAK,IAAK,GAAI,GAAI,IAAK,GAAI,IAAK,GAAI,IAAK,IAAK,GAAI,IAAK,IAAK,IAAK,IAAK,GAAI,IAAK,IAAK,IAAK,GAAI,IAAK,GAAI,IAAK,GAE5qCC,EAAY,CAAC,EAAG,EAAG,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,GAAI,GAA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AAQ,MAAQ,MAAQ,MAAQ,MAAQ,MAAQ,MAAQ,MAAQ,MACxF,MAAQ,MAAQ,MAAQ,MAAQ,MAAQ,MAAQ,MAAQ,MAAQ,MAAQ,MAAQ,MAAQ,MACxF,MAAQ,MAAQ,MAAQ,MAAQ,MAAQ,MAAQ,MAAQ,MAAQ,MAAQ,MAAQ,MAAQ,MACxF,MAAQ,MAAQ,MAAQ,MAAQ,MAAQ,MAAQ,MAAQ,MAAQ,MAAQ,MAAQ,MAAQ,MACxF,MAAQ,MAAQ,MAAQ,MAAQ,MAAQ,MAAQ,MAAQ,MAAQ,MAAQ,MAAQ,MAAQ,MACxF,MAAQ,MAAQ,MAAQ,MAAQ,MAAQ,MAAQ,MAAQ,MAAQ,MAAQ,MAAQ,MAAQ,MACxF,MAAQ,MAAQ,MAAQ,MAAQ,MAAQ,MAAQ,MAAQ,MAAQ,MAAQ,MAAQ,MAAQ,MACxF,MAAQ,MAAQ,MAAQ,MAAQ,MAAQ,MAAQ,KAAQ,KAAQ,MAAQ,KAAQ,MAAQ,MACxF,MAAQ,MAAQ,MAAQ,MAAQ,MAAQ,MAAQ,MAAQ,MAAQ,MAAQ,MAAQ,MAAQ,MACxF,MAAQ,MAAQ,MAAQ,MAAQ,MAAQ,MAAQ,MAAQ,MAAQ,MAAQ,MAAQ,MAAQ,MACxF,MAAQ,MAAQ,MAAQ,MAAQ,MAAQ,MAAQ,KAAQ,MAAQ,MAAQ,MAAQ,MAAQ,MACxF,MAAQ,MAAQ,MAAQ,MAAQ,MAAQ,KAAQ,KAAQ,KAAQ,MAAQ,MAAQ,MAAQ,MACxF,MAAQ,MAAQ,MAAQ,MAAQ,MAAQ,MAAQ,MAAQ,MAAQ,MAAQ,MAAQ,MAAQ,MACxF,MAAQ,MAAQ,MAAQ,MAAQ,MAAQ,MAAQ,MAAQ,MAAQ,MAAQ,MAAQ,MAAQ,MACxF,MAAQ,MAAQ,MAAQ,MAAQ,MAAQ,MAAQ,MAAQ,MAAQ,MAAQ,MAAQ,MAAQ,MACxF,MAAQ,MAAQ,KAAQ,MAAQ,MAAQ,MAAQ,MAAQ,MAAQ,MAAQ,MAAQ,MAAQ,KACxF,MAAQ,MAAQ,MAAQ,MAAQ,MAAQ,KAAQ,MAAQ,MAAQ,MAAQ,MAAQ,MAAQ,MACxF,MAAQ,MAAQ,MAAQ,MAAQ,MAAQ,MAAQ,MAAQ,MAAQ,MAAQ,MAAQ,MAAQ,MACxF,MAAQ,MAAQ,MAAQ,MAAQ,MAAQ,MAAQ,MAAQ,MAAQ,MAAQ,MAAQ,MAAQ,MACxF,MAAQ,MAAQ,MAAQ,MAAQ,MAAQ,MAAQ,MAAQ,MAAQ,MAAQ,MAAQ,KAAQ,KACxF,MAAQ,MAAQ,MAAQ,MAAQ,MAAQ,MAAQ,MAAQ,MAAQ,MAAQ,MAAQ,MAAQ,MACxF,MAAQ,MAAQ,MAAQ,MAAQ,MAAQ,MAAQ,KAAQ,MAAQ,MAAQ,MAAQ,MAAQ,MACxF,MAAQ,MAAQ,MAAQ,MAAQ,MAAQ,MAAQ,MAAQ,MAAQ,MAAQ,MAAQ,MAAQ,MACxF,MAAQ,MAAQ,MAAQ,MAAQ,MAAQ,MAAQ,MAAQ,MAAQ,MAAQ,MAAQ,MAAQ,MACxF,MAAQ,MAAQ,MAAQ,MAAQ,MAAQ,MAAQ,MAAQ,MAAQ,MAAQ,MAAQ,MAAQ,MACxF,MAAQ,MAAQ,MAAQ,MAAQ,MAAQ,MAAQ,MAAQ,MAAQ,MAAQ,MAAQ,MAAQ,MACxF,MAAQ,MAAQ,MAAQ,MAAQ,MAAQ,MAAQ,MAAQ,MAAQ,MAAQ,MAAQ,MAAQ,MACxF,MAAQ,MAAQ,MAAQ,MAAQ,MAAQ,MAAQ,MAAQ,MAAQ,MAAQ,MAAQ,MAAQ,MACxF,MAAQ,MAAQ,MAAQ,KAAQ,MAAQ,MAAQ,KAAQ,MAAQ,MAAQ,MAAQ,MAAQ,MACxF,MAAQ,MAAQ,MAAQ,MAAQ,MAAQ,KAAQ,MAAQ,MAAQ,MAAQ,MAAQ,MAAQ,MACxF,KAAQ,MAAQ,MAAQ,KAAQ,MAAQ,MAAQ,MAAQ,MAAQ,MAAQ,MAAQ,MAAQ,MACxF,MAAQ,MAAQ,MAAQ,MAAQ,MAAQ,MAAQ,MAAQ,MAAQ,MAAQ,MAAQ,MAAQ,KACxF,MAAQ,MAAQ,MAAQ,MAAQ,MAAQ,MAAQ,MAAQ,MAAQ,MAAQ,MAAQ,MAAQ,MACxF,MAAQ,MAAQ,KAAQ,MAAQ,MAAQ,KAAQ,MAAQ,MAAQ,MAAQ,MAAQ,MAAQ,MACxF,MAAQ,MAAQ,MAAQ,MAAQ,MAAQ,MAAQ,MAAQ,MAAQ,MAAQ,MAAQ,MAAQ,MACxF,MAAQ,MAAQ,MAAQ,MAAQ,MAAQ,MAAQ,MAAQ,MAAQ,MAAQ,MAAQ,MAAQ,MACxF,MAAQ,MAAQ,MAAQ,MAAQ,MAAQ,MAAQ,MAAQ,MAAQ,MAAQ,MAAQ,MAAQ,MACxF,MAAQ,MAAQ,MAAQ,MAAQ,MAAQ,MAAQ,GAAQ,KAAQ,GAAQ,KAAQ,GAAQ,KACxF,GAAQ,KAAQ,GAAQ,KAAQ,GAAQ,KAAQ,GAAQ,KAAQ,GAAQ,KAAQ,GAAQ,KACxF,GAAQ,KAAQ,MAAQ,MAAQ,MAAQ,MAAQ,KAAQ,KA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","sources":["webpack://telegram-t/./src/components/right/DeleteMemberModal.tsx","webpack://telegram-t/./src/components/common/FakeIcon.tsx","webpack://telegram-t/./src/util/resetScroll.ts","webpack://telegram-t/./src/lib/fastBlur.js","webpack://telegram-t/./src/components/common/VerifiedIcon.tsx","webpack://telegram-t/./src/components/common/FullNameTitle.tsx","webpack://telegram-t/./src/components/common/FullNameTitle.module.scss?6448","webpack://telegram-t/./src/components/common/IconWithSpinner.tsx","webpack://telegram-t/./src/components/common/IconWithSpinner.module.scss?fa87","webpack://telegram-t/./src/global/selectors/calls.ts","webpack://telegram-t/./src/lib/secret-sauce/utils.ts","webpack://telegram-t/./src/lib/secret-sauce/parseSdp.ts","webpack://telegram-t/./src/lib/secret-sauce/buildSdp.ts","webpack://telegram-t/./src/lib/secret-sauce/blacksilence.ts","webpack://telegram-t/./src/lib/secret-sauce/secretsauce.ts","webpack://telegram-t/./src/lib/secret-sauce/p2p.ts","webpack://telegram-t/./src/global/actions/api/calls.async.ts","webpack://telegram-t/./src/util/phoneCallEmojiConstants.ts","webpack://telegram-t/./src/global/actions/apiUpdaters/calls.async.ts","webpack://telegram-t/./src/components/calls/group/helpers/formatGroupCallVolume.ts","webpack://telegram-t/./src/components/calls/group/GroupCallParticipantMenu.tsx","webpack://telegram-t/./src/hooks/useRunThrottled.ts","webpack://telegram-t/./src/components/calls/group/OutlinedMicrophoneIcon.tsx","webpack://telegram-t/./src/components/calls/group/GroupCallParticipant.module.scss?2375","webpack://telegram-t/./src/components/calls/group/GroupCallParticipant.tsx","webpack://telegram-t/./src/components/calls/group/GroupCallParticipantList.tsx","webpack://telegram-t/./src/components/calls/group/GroupCallParticipantList.module.scss?6462","webpack://telegram-t/./src/components/calls/group/GroupCallParticipantVideo.module.scss?799e","webpack://telegram-t/./src/components/calls/group/GroupCallParticipantVideo.tsx","webpack://telegram-t/./src/util/vibrate.ts","webpack://telegram-t/./src/components/calls/group/MicrophoneButton.module.scss?3a9a","webpack://telegram-t/./src/components/calls/group/MicrophoneButton.tsx","webpack://telegram-t/./src/components/calls/group/GroupCall.module.scss?4417","webpack://telegram-t/./src/components/calls/group/GroupCall.tsx","webpack://telegram-t/./src/components/calls/group/hooks/useGroupCallVideoLayout.ts","webpack://telegram-t/./src/components/calls/ActiveCallHeader.tsx","webpack://telegram-t/./src/components/calls/phone/PhoneCallButton.module.scss?9dea","webpack://telegram-t/./src/components/calls/phone/PhoneCallButton.tsx","webpack://telegram-t/./src/components/calls/phone/PhoneCall.module.scss?a250","webpack://telegram-t/./src/components/calls/phone/PhoneCall.tsx","webpack://telegram-t/./src/components/calls/phone/RatePhoneCallModal.module.scss?64f6","webpack://telegram-t/./src/components/calls/phone/RatePhoneCallModal.tsx","webpack://telegram-t/./src/bundles/calls.ts","webpack://telegram-t/./src/hooks/window/useFullscreen.ts","webpack://telegram-t/./src/components/common/gift/GiftEffectWrapper.tsx","webpack://telegram-t/./src/components/common/gift/GiftEffectWrapper.module.scss?3608","webpack://telegram-t/./src/hooks/useInfiniteScroll.ts"],"sourcesContent":["import type { FC } from '../../lib/teact/teact';\nimport { memo, useCallback } from '../../lib/teact/teact';\nimport { getActions, withGlobal } from '../../global';\n\nimport type { ApiChat } from '../../api/types';\n\nimport { getUserFirstOrLastName } from '../../global/helpers';\nimport { selectCurrentChat, selectUser } from '../../global/selectors';\nimport renderText from '../common/helpers/renderText';\n\nimport useOldLang from '../../hooks/useOldLang';\n\nimport ConfirmDialog from '../ui/ConfirmDialog';\n\nexport type OwnProps = {\n  isOpen: boolean;\n  userId?: string;\n  onClose: () => void;\n};\n\ntype StateProps = {\n  chat?: ApiChat;\n  contactName?: string;\n};\n\nconst DeleteMemberModal: FC<OwnProps & StateProps> = ({\n  isOpen,\n  chat,\n  userId,\n  contactName,\n  onClose,\n}) => {\n  const { deleteChatMember } = getActions();\n\n  const lang = useOldLang();\n\n  const handleDeleteChatMember = useCallback(() => {\n    deleteChatMember({ chatId: chat!.id, userId: userId! });\n    onClose();\n  }, [chat, deleteChatMember, onClose, userId]);\n\n  if (!chat || !userId) {\n    return undefined;\n  }\n\n  return (\n    <ConfirmDialog\n      isOpen={isOpen}\n      onClose={onClose}\n      title={lang('GroupRemoved.Remove')}\n      textParts={renderText(lang('PeerInfo.Confirm.RemovePeer', contactName))}\n      confirmLabel={lang('lng_box_remove')}\n      confirmHandler={handleDeleteChatMember}\n      confirmIsDestructive\n    />\n  );\n};\n\nexport default memo(withGlobal<OwnProps>(\n  (global, { userId }): Complete<StateProps> => {\n    const chat = selectCurrentChat(global);\n    const user = userId && selectUser(global, userId);\n    const contactName = user ? getUserFirstOrLastName(user) : undefined;\n\n    return {\n      chat,\n      contactName,\n    };\n  },\n)(DeleteMemberModal));\n","import { memo } from '../../lib/teact/teact';\n\nimport type { ApiFakeType } from '../../api/types';\n\nimport useLang from '../../hooks/useLang';\n\nimport './FakeIcon.scss';\n\ntype OwnProps = {\n  fakeType: ApiFakeType;\n};\n\nconst FakeIcon = ({\n  fakeType,\n}: OwnProps) => {\n  const lang = useLang();\n\n  return (\n    <span className=\"FakeIcon\">\n      {lang(fakeType === 'fake' ? 'FakeMessage' : 'ScamMessage')}\n    </span>\n  );\n};\n\nexport default memo(FakeIcon);\n","import { IS_IOS } from './browser/windowEnvironment';\nimport forceReflow from './forceReflow';\n\nconst resetScroll = (container: HTMLDivElement, scrollTop?: number) => {\n  if (IS_IOS) {\n    container.style.overflow = 'hidden';\n  }\n\n  if (scrollTop !== undefined) {\n    container.scrollTop = scrollTop;\n  }\n\n  if (IS_IOS) {\n    container.style.overflow = '';\n  }\n};\n\nexport function stopScrollInertia(element: HTMLElement) {\n  element.style.display = 'none';\n  forceReflow(element);\n  element.style.display = '';\n}\n\nexport default resetScroll;\n","/*\nSuperfast Blur - a fast Box Blur For Canvas\n\nVersion:     0.5\nAuthor:        Mario Klingemann\nContact:     mario@quasimondo.com\nWebsite:    http://www.quasimondo.com/BoxBlurForCanvas\nTwitter:    @quasimondo\n\nIn case you find this class useful - especially in commercial projects -\nI am not totally unhappy for a small donation to my PayPal account\nmario@quasimondo.de\n\nOr support me on flattr:\nhttps://flattr.com/thing/140066/Superfast-Blur-a-pretty-fast-Box-Blur-Effect-for-CanvasJavascript\n\nCopyright (c) 2011 Mario Klingemann\n\nPermission is hereby granted, free of charge, to any person\nobtaining a copy of this software and associated documentation\nfiles (the \"Software\"), to deal in the Software without\nrestriction, including without limitation the rights to use,\ncopy, modify, merge, publish, distribute, sublicense, and/or sell\ncopies of the Software, and to permit persons to whom the\nSoftware is furnished to do so, subject to the following\nconditions:\n\nThe above copyright notice and this permission notice shall be\nincluded in all copies or substantial portions of the Software.\n\nTHE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND,\nEXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES\nOF MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND\nNONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT\nHOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY,\nWHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING\nFROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR\nOTHER DEALINGS IN THE SOFTWARE.\n*/\n\n// eslint-disable-next-line @stylistic/max-len\nconst mul_table = [1, 57, 41, 21, 203, 34, 97, 73, 227, 91, 149, 62, 105, 45, 39, 137, 241, 107, 3, 173, 39, 71, 65, 238, 219, 101, 187, 87, 81, 151, 141, 133, 249, 117, 221, 209, 197, 187, 177, 169, 5, 153, 73, 139, 133, 127, 243, 233, 223, 107, 103, 99, 191, 23, 177, 171, 165, 159, 77, 149, 9, 139, 135, 131, 253, 245, 119, 231, 224, 109, 211, 103, 25, 195, 189, 23, 45, 175, 171, 83, 81, 79, 155, 151, 147, 9, 141, 137, 67, 131, 129, 251, 123, 30, 235, 115, 113, 221, 217, 53, 13, 51, 50, 49, 193, 189, 185, 91, 179, 175, 43, 169, 83, 163, 5, 79, 155, 19, 75, 147, 145, 143, 35, 69, 17, 67, 33, 65, 255, 251, 247, 243, 239, 59, 29, 229, 113, 111, 219, 27, 213, 105, 207, 51, 201, 199, 49, 193, 191, 47, 93, 183, 181, 179, 11, 87, 43, 85, 167, 165, 163, 161, 159, 157, 155, 77, 19, 75, 37, 73, 145, 143, 141, 35, 138, 137, 135, 67, 33, 131, 129, 255, 63, 250, 247, 61, 121, 239, 237, 117, 29, 229, 227, 225, 111, 55, 109, 216, 213, 211, 209, 207, 205, 203, 201, 199, 197, 195, 193, 48, 190, 47, 93, 185, 183, 181, 179, 178, 176, 175, 173, 171, 85, 21, 167, 165, 41, 163, 161, 5, 79, 157, 78, 154, 153, 19, 75, 149, 74, 147, 73, 144, 143, 71, 141, 140, 139, 137, 17, 135, 134, 133, 66, 131, 65, 129, 1];\n// eslint-disable-next-line @stylistic/max-len\nconst shg_table = [0, 9, 10, 10, 14, 12, 14, 14, 16, 15, 16, 15, 16, 15, 15, 17, 18, 17, 12, 18, 16, 17, 17, 19, 19, 18, 19, 18, 18, 19, 19, 19, 20, 19, 20, 20, 20, 20, 20, 20, 15, 20, 19, 20, 20, 20, 21, 21, 21, 20, 20, 20, 21, 18, 21, 21, 21, 21, 20, 21, 17, 21, 21, 21, 22, 22, 21, 22, 22, 21, 22, 21, 19, 22, 22, 19, 20, 22, 22, 21, 21, 21, 22, 22, 22, 18, 22, 22, 21, 22, 22, 23, 22, 20, 23, 22, 22, 23, 23, 21, 19, 21, 21, 21, 23, 23, 23, 22, 23, 23, 21, 23, 22, 23, 18, 22, 23, 20, 22, 23, 23, 23, 21, 22, 20, 22, 21, 22, 24, 24, 24, 24, 24, 22, 21, 24, 23, 23, 24, 21, 24, 23, 24, 22, 24, 24, 22, 24, 24, 22, 23, 24, 24, 24, 20, 23, 22, 23, 24, 24, 24, 24, 24, 24, 24, 23, 21, 23, 22, 23, 24, 24, 24, 22, 24, 24, 24, 23, 22, 24, 24, 25, 23, 25, 25, 23, 24, 25, 25, 24, 22, 25, 25, 25, 24, 23, 24, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 25, 23, 25, 23, 24, 25, 25, 25, 25, 25, 25, 25, 25, 25, 24, 22, 25, 25, 23, 25, 25, 20, 24, 25, 24, 25, 25, 22, 24, 25, 24, 25, 24, 25, 25, 24, 25, 25, 25, 25, 22, 25, 25, 25, 24, 25, 24, 25, 18];\n\nexport default function boxBlurCanvasRGB(context, top_x, top_y, width, height, radius, iterations) {\n  if (Number.isNaN(radius) || radius < 1) return;\n\n  radius |= 0;\n\n  if (Number.isNaN(iterations)) iterations = 1;\n  iterations |= 0;\n  if (iterations > 3) iterations = 3;\n  if (iterations < 1) iterations = 1;\n\n  const imageData = context.getImageData(top_x, top_y, width, height);\n\n  const pixels = imageData.data;\n\n  let rsum;\n  let gsum;\n  let bsum;\n  let x;\n  let y;\n  let i;\n  let p;\n  let p1;\n  let p2;\n  let yp;\n  let yi;\n  let yw;\n  let wm = width - 1;\n  let hm = height - 1;\n  let rad1 = radius + 1;\n\n  let r = [];\n  let g = [];\n  let b = [];\n\n  let mul_sum = mul_table[radius];\n  let shg_sum = shg_table[radius];\n\n  let vmin = [];\n  let vmax = [];\n\n  while (iterations-- > 0) {\n    yw = yi = 0;\n\n    for (y = 0; y < height; y++) {\n      rsum = pixels[yw] * rad1;\n      gsum = pixels[yw + 1] * rad1;\n      bsum = pixels[yw + 2] * rad1;\n\n      for (i = 1; i <= radius; i++) {\n        p = yw + (((i > wm ? wm : i)) << 2);\n        rsum += pixels[p++];\n        gsum += pixels[p++];\n        bsum += pixels[p++];\n      }\n\n      for (x = 0; x < width; x++) {\n        r[yi] = rsum;\n        g[yi] = gsum;\n        b[yi] = bsum;\n\n        if (y == 0) {\n          vmin[x] = ((p = x + rad1) < wm ? p : wm) << 2;\n          vmax[x] = ((p = x - radius) > 0 ? p << 2 : 0);\n        }\n\n        p1 = yw + vmin[x];\n        p2 = yw + vmax[x];\n\n        rsum += pixels[p1++] - pixels[p2++];\n        gsum += pixels[p1++] - pixels[p2++];\n        bsum += pixels[p1++] - pixels[p2++];\n\n        yi++;\n      }\n      yw += (width << 2);\n    }\n\n    for (x = 0; x < width; x++) {\n      yp = x;\n      rsum = r[yp] * rad1;\n      gsum = g[yp] * rad1;\n      bsum = b[yp] * rad1;\n\n      for (i = 1; i <= radius; i++) {\n        yp += (i > hm ? 0 : width);\n        rsum += r[yp];\n        gsum += g[yp];\n        bsum += b[yp];\n      }\n\n      yi = x << 2;\n      for (y = 0; y < height; y++) {\n        pixels[yi] = (rsum * mul_sum) >>> shg_sum;\n        pixels[yi + 1] = (gsum * mul_sum) >>> shg_sum;\n        pixels[yi + 2] = (bsum * mul_sum) >>> shg_sum;\n\n        if (x == 0) {\n          vmin[y] = ((p = y + rad1) < hm ? p : hm) * width;\n          vmax[y] = ((p = y - radius) > 0 ? p * width : 0);\n        }\n\n        p1 = x + vmin[y];\n        p2 = x + vmax[y];\n\n        rsum += r[p1] - r[p2];\n        gsum += g[p1] - g[p2];\n        bsum += b[p1] - b[p2];\n\n        yi += width << 2;\n      }\n    }\n  }\n\n  context.putImageData(imageData, top_x, top_y);\n}\n","import './VerifiedIcon.scss';\n\nconst VerifiedIcon = () => {\n  return (\n    <svg className=\"VerifiedIcon\" viewBox=\"0 0 24 24\">\n      <path d=\"M12.3 2.9c.1.1.2.1.3.2.7.6 1.3 1.1 2 1.7.3.2.6.4.9.4.9.1 1.7.2 2.6.2.5 0 .6.1.7.7.1.9.1 1.8.2 2.6 0 .4.2.7.4 1 .6.7 1.1 1.3 1.7 2 .3.4.3.5 0 .8-.5.6-1.1 1.3-1.6 1.9-.3.3-.5.7-.5 1.2-.1.8-.2 1.7-.2 2.5 0 .4-.2.5-.6.6-.8 0-1.6.1-2.5.2-.5 0-1 .2-1.4.5-.6.5-1.3 1.1-1.9 1.6-.3.3-.5.3-.8 0-.7-.6-1.4-1.2-2-1.8-.3-.2-.6-.4-.9-.4-.9-.1-1.8-.2-2.7-.2-.4 0-.5-.2-.6-.5 0-.9-.1-1.7-.2-2.6 0-.4-.2-.8-.4-1.1-.6-.6-1.1-1.3-1.6-2-.4-.4-.3-.5 0-1 .6-.6 1.1-1.3 1.7-1.9.3-.3.4-.6.4-1 0-.8.1-1.6.2-2.5 0-.5.1-.6.6-.6.9-.1 1.7-.1 2.6-.2.4 0 .7-.2 1-.4.7-.6 1.4-1.2 2.1-1.7.1-.2.3-.3.5-.2z\" style=\"fill: var(--color-fill)\" />\n      <path d=\"M16.4 10.1l-.2.2-5.4 5.4c-.1.1-.2.2-.4 0l-2.6-2.6c-.2-.2-.1-.3 0-.4.2-.2.5-.6.7-.6.3 0 .5.4.7.6l1.1 1.1c.2.2.3.2.5 0l4.3-4.3c.2-.2.4-.3.6 0 .1.2.3.3.4.5.2 0 .3.1.3.1z\" style=\"fill: var(--color-checkmark)\" />\n    </svg>\n  );\n};\n\nexport default VerifiedIcon;\n","import type { FC } from '../../lib/teact/teact';\nimport type React from '../../lib/teact/teact';\nimport { memo, useMemo } from '../../lib/teact/teact';\nimport { getActions } from '../../global';\n\nimport type {\n  ApiPeer,\n} from '../../api/types';\nimport type { ObserveFn } from '../../hooks/useIntersectionObserver';\nimport type { CustomPeer } from '../../types';\n\nimport { EMOJI_STATUS_LOOP_LIMIT } from '../../config';\nimport {\n  getChatTitle,\n  getUserFullName,\n  isAnonymousForwardsChat,\n  isChatWithRepliesBot,\n  isChatWithVerificationCodesBot,\n} from '../../global/helpers';\nimport { isApiPeerUser } from '../../global/helpers/peers';\nimport buildClassName from '../../util/buildClassName';\nimport { copyTextToClipboard } from '../../util/clipboard';\nimport stopEvent from '../../util/stopEvent';\nimport renderText from './helpers/renderText';\n\nimport useLang from '../../hooks/useLang';\nimport useLastCallback from '../../hooks/useLastCallback';\nimport useOldLang from '../../hooks/useOldLang';\n\nimport Transition from '../ui/Transition';\nimport CustomEmoji from './CustomEmoji';\nimport FakeIcon from './FakeIcon';\nimport GiftEffectWrapper from './gift/GiftEffectWrapper';\nimport StarIcon from './icons/StarIcon';\nimport VerifiedIcon from './VerifiedIcon';\n\nimport styles from './FullNameTitle.module.scss';\n\ntype OwnProps = {\n  peer: ApiPeer | CustomPeer;\n  className?: string;\n  style?: string;\n  noVerified?: boolean;\n  noFake?: boolean;\n  withEmojiStatus?: boolean;\n  emojiStatusSize?: number;\n  isSavedMessages?: boolean;\n  isSavedDialog?: boolean;\n  isMonoforum?: boolean;\n  monoforumBadgeClassName?: string;\n  noLoopLimit?: boolean;\n  canCopyTitle?: boolean;\n  iconElement?: React.ReactNode;\n  withStatusTextColor?: boolean;\n  onEmojiStatusClick?: NoneToVoidFunction;\n  observeIntersection?: ObserveFn;\n};\n\nconst FullNameTitle: FC<OwnProps> = ({\n  className,\n  style,\n  peer,\n  noVerified,\n  noFake,\n  withEmojiStatus,\n  emojiStatusSize,\n  isSavedMessages,\n  isSavedDialog,\n  noLoopLimit,\n  canCopyTitle,\n  iconElement,\n  isMonoforum,\n  monoforumBadgeClassName,\n  withStatusTextColor,\n  onEmojiStatusClick,\n  observeIntersection,\n}) => {\n  const { showNotification } = getActions();\n\n  const oldLang = useOldLang();\n  const lang = useLang();\n\n  const realPeer = 'id' in peer ? peer : undefined;\n  const customPeer = 'isCustomPeer' in peer ? peer : undefined;\n  const isUser = realPeer && isApiPeerUser(realPeer);\n  const title = realPeer && (isUser ? getUserFullName(realPeer) : getChatTitle(oldLang, realPeer));\n  const isPremium = (isUser && realPeer.isPremium) || customPeer?.isPremium;\n  const canShowEmojiStatus = withEmojiStatus && !isSavedMessages;\n  const emojiStatus = realPeer?.emojiStatus\n    || (customPeer?.emojiStatusId ? { type: 'regular', documentId: customPeer.emojiStatusId } : undefined);\n\n  const handleTitleClick = useLastCallback((e) => {\n    if (!title || !canCopyTitle) {\n      return;\n    }\n\n    stopEvent(e);\n    copyTextToClipboard(title);\n    showNotification({ message: `${isUser ? 'User' : 'Chat'} name was copied` });\n  });\n\n  const specialTitle = useMemo(() => {\n    if (customPeer) {\n      return renderText(customPeer.title || oldLang(customPeer.titleKey!));\n    }\n\n    if (isSavedMessages) {\n      return oldLang(isSavedDialog ? 'MyNotes' : 'SavedMessages');\n    }\n\n    if (isAnonymousForwardsChat(realPeer!.id)) {\n      return oldLang('AnonymousForward');\n    }\n\n    if (isChatWithRepliesBot(realPeer!.id)) {\n      return oldLang('RepliesTitle');\n    }\n\n    if (isChatWithVerificationCodesBot(realPeer!.id)) {\n      return oldLang('VerifyCodesNotifications');\n    }\n\n    return undefined;\n  }, [customPeer, isSavedDialog, isSavedMessages, oldLang, realPeer]);\n  const botVerificationIconId = realPeer?.botVerificationIconId;\n\n  return (\n    <div className={buildClassName('title', styles.root, className)} style={style}>\n      {botVerificationIconId && (\n        <CustomEmoji\n          documentId={botVerificationIconId}\n          size={emojiStatusSize}\n          loopLimit={!noLoopLimit ? EMOJI_STATUS_LOOP_LIMIT : undefined}\n          observeIntersectionForLoading={observeIntersection}\n        />\n      )}\n      <h3\n        dir=\"auto\"\n        role=\"button\"\n        className={buildClassName(\n          'fullName',\n          styles.fullName,\n          canCopyTitle && styles.canCopy,\n        )}\n        onClick={handleTitleClick}\n      >\n        {specialTitle || renderText(title || '')}\n      </h3>\n      {!iconElement && peer && (\n        <>\n          {!noVerified && peer?.isVerified && <VerifiedIcon />}\n          {!noFake && peer?.fakeType && <FakeIcon fakeType={peer.fakeType} />}\n          {canShowEmojiStatus && emojiStatus && (\n            <Transition\n              className={styles.statusTransition}\n              slideClassName={styles.statusTransitionSlide}\n              activeKey={Number(emojiStatus.documentId)}\n              name=\"slideFade\"\n              direction={-1}\n              shouldCleanup\n            >\n              <GiftEffectWrapper\n                withSparkles={emojiStatus.type === 'collectible'}\n                sparklesClassName=\"statusSparkles\"\n                sparklesColor={emojiStatus.type === 'collectible' && !withStatusTextColor\n                  ? emojiStatus.textColor : undefined}\n              >\n                <CustomEmoji\n                  className={buildClassName('no-selection', !withStatusTextColor && styles.statusPrimaryColor)}\n                  documentId={emojiStatus.documentId}\n                  size={emojiStatusSize}\n                  loopLimit={!noLoopLimit ? EMOJI_STATUS_LOOP_LIMIT : undefined}\n                  observeIntersectionForLoading={observeIntersection}\n                  onClick={onEmojiStatusClick}\n                />\n              </GiftEffectWrapper>\n            </Transition>\n          )}\n          {canShowEmojiStatus && !emojiStatus && isPremium && <StarIcon />}\n          {isMonoforum && (\n            <div className={buildClassName(styles.monoforumBadge, monoforumBadgeClassName)}>\n              {lang('MonoforumBadge')}\n            </div>\n          )}\n        </>\n      )}\n      {iconElement}\n    </div>\n  );\n};\n\nexport default memo(FullNameTitle);\n","// extracted by mini-css-extract-plugin\nexport default {\"root\":\"QljEeKI5\",\"statusTransition\":\"KBZgFSv7\",\"fullName\":\"AS54Cntu\",\"canCopy\":\"vr53L_9p\",\"statusTransitionSlide\":\"xmVxyvNy\",\"monoforumBadge\":\"Sdwfc851\",\"statusPrimaryColor\":\"z1sLOAjr\"};","import { memo } from '../../lib/teact/teact';\n\nimport type { IconName } from '../../types/icons';\n\nimport Spinner from '../ui/Spinner';\nimport Transition from '../ui/Transition';\nimport Icon from './icons/Icon';\n\nimport styles from './IconWithSpinner.module.scss';\n\ntype OwnProps = {\n  iconName: IconName;\n  isLoading?: boolean;\n};\n\nconst IconWithSpinner = ({ iconName, isLoading }: OwnProps) => {\n  return (\n    <Transition className={styles.root} activeKey={isLoading ? 0 : 1} name=\"fade\">\n      {isLoading ? (\n        <Spinner className={styles.spinner} color=\"white\" />\n      ) : (\n        <Icon className={styles.icon} name={iconName} />\n      )}\n    </Transition>\n  );\n};\n\nexport default memo(IconWithSpinner);\n","// extracted by mini-css-extract-plugin\nexport default {\"root\":\"LLqNvbR9\",\"spinner\":\"PbV71feg\",\"icon\":\"sohV68PB\"};","import type { GlobalState } from '../types';\n\nimport { getMainUsername, isChatBasicGroup } from '../helpers';\nimport { selectChat, selectChatFullInfo } from './chats';\nimport { selectUser } from './users';\n\nexport function selectChatGroupCall<T extends GlobalState>(global: T, chatId: string) {\n  const fullInfo = selectChatFullInfo(global, chatId);\n  if (!fullInfo || !fullInfo.groupCallId) return undefined;\n\n  return selectGroupCall(global, fullInfo.groupCallId);\n}\n\nexport function selectGroupCall<T extends GlobalState>(global: T, groupCallId: string) {\n  return global.groupCalls.byId[groupCallId];\n}\n\nexport function selectGroupCallParticipant<T extends GlobalState>(\n  global: T, groupCallId: string, participantId: string,\n) {\n  return selectGroupCall(global, groupCallId)?.participants[participantId];\n}\n\nexport function selectIsAdminInActiveGroupCall<T extends GlobalState>(global: T): boolean {\n  const chatId = selectActiveGroupCall(global)?.chatId;\n\n  if (!chatId) return false;\n\n  const chat = selectChat(global, chatId);\n  if (!chat) return false;\n\n  return (isChatBasicGroup(chat) && chat.isCreator) || Boolean(chat.adminRights?.manageCall);\n}\n\nexport function selectActiveGroupCall<T extends GlobalState>(global: T) {\n  const { groupCalls: { activeGroupCallId } } = global;\n  if (!activeGroupCallId) {\n    return undefined;\n  }\n\n  return selectGroupCall(global, activeGroupCallId);\n}\n\nexport function selectPhoneCallUser<T extends GlobalState>(global: T) {\n  const { phoneCall, currentUserId } = global;\n  if (!phoneCall || !phoneCall.participantId || !phoneCall.adminId) {\n    return undefined;\n  }\n\n  const id = phoneCall.adminId === currentUserId ? phoneCall.participantId : phoneCall.adminId;\n  return selectUser(global, id);\n}\n\nexport function selectCanInviteToActiveGroupCall<T extends GlobalState>(global: T) {\n  const groupCall = selectActiveGroupCall(global);\n\n  if (!groupCall || !groupCall.chatId) {\n    return false;\n  }\n\n  const chat = selectChat(global, groupCall.chatId);\n  if (!chat) {\n    return false;\n  }\n\n  const hasPublicUsername = Boolean(getMainUsername(chat));\n  if (hasPublicUsername) {\n    return true;\n  }\n\n  const inviteLink = selectChatFullInfo(global, chat.id)?.inviteLink;\n  return Boolean(inviteLink);\n}\n","import type { P2PPayloadType } from './p2pMessage';\nimport type { PayloadType } from './types';\n\n/// NOTE: telegram returns sign source, while webrtc uses unsign source internally\n/// unsign => sign\nexport function toTelegramSource(source: number) {\n  // eslint-disable-next-line no-bitwise\n  return source << 0;\n}\n\n/// NOTE: telegram returns sign source, while webrtc uses unsign source internally\n/// sign => unsign\nexport function fromTelegramSource(source: number) {\n  // eslint-disable-next-line no-bitwise\n  return source >>> 0;\n}\n\nexport function getAmplitude(array: Uint8Array, scale = 3) {\n  if (!array) return 0;\n\n  const { length } = array;\n  let total = 0;\n  for (let i = 0; i < length; i++) {\n    total += array[i] * array[i];\n  }\n  const rms = Math.sqrt(total / length) / 255;\n\n  return Math.min(1, rms * scale);\n}\n\nexport function p2pPayloadTypeToConference(p: P2PPayloadType): PayloadType {\n  return {\n    id: p.id,\n    name: p.name,\n    'rtcp-fbs': p.feedbackTypes,\n    clockrate: p.clockrate,\n    parameters: p.parameters,\n    channels: p.channels,\n  };\n}\n\nexport function isRelayAddress(candidate: string) {\n  const parts = candidate.split(' ');\n  return parts.some((part) => part === 'relay');\n}\n\nexport function removeRelatedAddress(candidate: string) {\n  const parts = candidate.split(' ');\n\n  const raddrIndex = parts.indexOf('raddr');\n  if (raddrIndex !== -1) {\n    parts.splice(raddrIndex, 2);\n  }\n\n  const rportIndex = parts.indexOf('rport');\n  if (rportIndex !== -1) {\n    parts.splice(rportIndex, 2);\n  }\n\n  return parts.join(' ');\n}\n\nexport const THRESHOLD = 0.1;\n\nexport const IS_SCREENSHARE_SUPPORTED = 'getDisplayMedia' in (navigator?.mediaDevices || {});\nexport const IS_ECHO_CANCELLATION_SUPPORTED = navigator?.mediaDevices?.getSupportedConstraints().echoCancellation;\n// @ts-ignore\nexport const IS_NOISE_SUPPRESSION_SUPPORTED = navigator?.mediaDevices?.getSupportedConstraints().noiseSuppression;\n","import { toTelegramSource } from './utils';\nimport type { JoinGroupCallPayload, SsrcGroup } from './types';\n\nexport default (sessionDescription: RTCSessionDescriptionInit, isP2p = false): JoinGroupCallPayload => {\n  if (!sessionDescription || !sessionDescription.sdp) {\n    throw Error('Failed parsing SDP: session description is null');\n  }\n\n  const sections = sessionDescription\n    .sdp\n    .split('\\r\\nm=')\n    .map((s, i) => (i === 0 ? s : `m=${s}`))\n    .reduce((acc: Record<string, string[]>, el) => {\n      const name = el.match(/^m=(.+?)\\s/)?.[1] || 'header';\n      acc[acc.hasOwnProperty(name) && name === 'video' ? 'screencast' : name] = el.split('\\r\\n').filter(Boolean);\n      return acc;\n    }, {});\n\n  const lookup = (prefix: string, sectionName?: string) => {\n    if (!sectionName) {\n      return Object.values(sections).map((section) => {\n        return section.find((line) => line.startsWith(prefix))?.substr(prefix.length);\n      }).filter(Boolean)[0];\n    } else {\n      return sections[sectionName]?.find((line) => line.startsWith(prefix))?.substr(prefix.length);\n    }\n  };\n\n  const parseExtmaps = (sectionName: string) => {\n    return sections[sectionName].filter((l) => l.startsWith('a=extmap')).map((l) => {\n      const [, id, uri] = l.match(/extmap:(\\d+)(?:\\/.+)?\\s(.+)/)!;\n      return { id: Number(id), uri };\n    });\n  };\n\n  const parsePayloadTypes = (sectionName: string) => {\n    const payloads = sections[sectionName].filter((l) => l.startsWith('a=rtpmap')).map((l) => {\n      const [, id, data] = l.match(/:(\\d+)\\s(.+)/) || [];\n      const [name, clockrate, channels] = data.split('/');\n      return {\n        id: Number(id), name, clockrate: Number(clockrate), ...(channels && { channels: Number(channels) }),\n      };\n    });\n\n    const fbParams = sections[sectionName].filter((l) => l.startsWith('a=rtcp-fb')).map((l) => {\n      const [, id, data] = l.match(/:(\\d+)\\s(.+)/) || [];\n      const [type, subtype] = data.split(' ');\n      return { id: Number(id), type, subtype: subtype || '' };\n    });\n\n    const parameters = sections[sectionName].filter((l) => l.startsWith('a=fmtp')).map((l) => {\n      const [, id, data] = l.match(/:(\\d+)\\s(.+)/) || [];\n      const d = data?.split(';').reduce((acc: Record<string, string>, q) => {\n        const [name, value] = q.split('=');\n        acc[name] = value;\n        return acc;\n      }, {});\n      if (!d || Object.values(d).some((z) => !z)) return undefined;\n      return { id: Number(id), data: d };\n    }).filter(Boolean);\n\n    return payloads.map((payload) => {\n      const p = parameters.filter((l) => l!.id === payload.id).map((q) => q!.data).reduce((acc, el) => {\n        return Object.assign(acc, el);\n      }, {});\n      const f = fbParams.filter((l) => l.id === payload.id).map((l) => {\n        return {\n          type: l.type,\n          subtype: l.subtype,\n        };\n      });\n\n      return {\n        ...payload,\n        ...(Object.keys(p).length > 0 && { parameters: p }),\n        ...(f.length > 0 && { feedbackTypes: f }),\n      };\n    });\n  };\n\n  const rawSource = lookup('a=ssrc:', 'audio');\n  const sourceAudio = rawSource && Number(rawSource.split(' ')[0]);\n\n  // TODO multiple source groups\n  const rawSourceVideo = lookup('a=ssrc-group:', 'video')?.split(' ') || undefined;\n  const rawSourceScreencast = lookup('a=ssrc-group:', 'screencast')?.split(' ') || undefined;\n\n  if (!rawSourceVideo) {\n    throw Error('Failed parsing SDP: no video ssrc');\n  }\n\n  const [hash, fingerprint] = lookup('a=fingerprint:')?.split(' ') || [];\n\n  const setup = lookup('a=setup:');\n  if (!hash || !fingerprint) {\n    throw Error('Failed parsing SDP: no fingerprint');\n  }\n\n  console.log(sections);\n\n  const ufrag = lookup('a=ice-ufrag:');\n  const pwd = lookup('a=ice-pwd:');\n\n  if (!ufrag || !pwd) {\n    throw Error('Failed parsing SDP: no ICE ufrag or pwd');\n  }\n\n  return {\n    fingerprints: [\n      {\n        fingerprint,\n        hash,\n        setup: isP2p ? setup! : 'active',\n      },\n    ],\n    pwd,\n    ufrag,\n    ...(sourceAudio && { ssrc: toTelegramSource(sourceAudio) }),\n    ...(rawSourceVideo && {\n      'ssrc-groups': [\n        {\n          semantics: rawSourceVideo[0],\n          sources: rawSourceVideo.slice(1, rawSourceVideo.length).map(Number).map(toTelegramSource),\n        },\n        (isP2p && rawSourceScreencast && {\n          semantics: rawSourceScreencast[0],\n          sources: rawSourceScreencast.slice(1, rawSourceScreencast.length).map(Number).map(toTelegramSource),\n        }),\n      ].filter(Boolean) as SsrcGroup[],\n    }),\n    ...(isP2p && {\n      audioExtmap: parseExtmaps('audio'),\n      videoExtmap: parseExtmaps('video'),\n      screencastExtmap: parseExtmaps('screencast'),\n      audioPayloadTypes: parsePayloadTypes('audio'),\n      videoPayloadTypes: parsePayloadTypes('video'),\n      screencastPayloadTypes: parsePayloadTypes('screencast'),\n    }),\n  };\n};\n","import type {\n  Candidate, GroupCallTransport, PayloadType, RTPExtension, SsrcGroup,\n} from './types';\nimport { fromTelegramSource } from './utils';\n\nexport type Conference = {\n  sessionId: number;\n  audioExtensions: RTPExtension[];\n  videoExtensions: RTPExtension[];\n  audioPayloadTypes: PayloadType[];\n  videoPayloadTypes: PayloadType[];\n  ssrcs: Ssrc[];\n  transport: GroupCallTransport;\n};\n\nexport type Ssrc = {\n  userId: string;\n  endpoint: string;\n  mid: string;\n  isMain: boolean;\n  isRemoved?: boolean;\n  isVideo: boolean;\n  isPresentation?: boolean;\n  sourceGroups: SsrcGroup[];\n};\n\nexport default (conference: Conference, isAnswer = false, isPresentation = false, isP2p = false) => {\n  const lines: string[] = [];\n\n  const add = (value: string) => {\n    lines.push(value);\n  };\n\n  const {\n    sessionId,\n    ssrcs,\n    audioExtensions,\n    videoExtensions,\n    audioPayloadTypes,\n    videoPayloadTypes,\n    transport: {\n      ufrag,\n      pwd,\n      fingerprints,\n      candidates,\n    },\n  } = conference;\n\n  // Header\n  add('v=0'); // version\n  add(`o=- ${sessionId} 2 IN IP4 0.0.0.0`); // sessionId, 2=sessionVersion\n  add('s=-'); // name of the session\n  add('t=0 0'); // time when session is valid\n  add('a=ice-options:trickle');\n  add('a=msid-semantic:WMS *');\n  add(`a=group:BUNDLE ${ssrcs.map((ssrc) => ssrc.mid).join(' ')}${isPresentation ? '' : ` ${isP2p ? '3' : '2'}`}`);\n  // ice-lite: is a minimal version of the ICE specification, intended only for servers running on a public IP address\n  if (!isP2p) add('a=ice-lite');\n\n  const addCandidate = (c: Candidate) => {\n    if (c.sdpString) {\n      add(`a=${c.sdpString}`);\n    } else {\n      let str = '';\n      str += 'a=candidate:';\n      str += `${c.foundation} ${c.component} ${c.protocol} ${c.priority} ${c.ip} ${c.port} typ ${c.type}`;\n      if ('rel-addr' in c) {\n        str += ` raddr ${c['rel-addr']} rport ${c['rel-port']}`;\n      }\n      str += ` generation ${c.generation}`;\n      add(str);\n    }\n  };\n\n  const addTransport = () => {\n    add(`a=ice-ufrag:${ufrag}`);\n    add(`a=ice-pwd:${pwd}`);\n    fingerprints.forEach((fingerprint) => {\n      add(`a=fingerprint:${fingerprint.hash} ${fingerprint.fingerprint}`);\n      add(`a=setup:${isP2p ? (fingerprint.setup) : 'passive'}`);\n    });\n\n    candidates.forEach(addCandidate);\n  };\n\n  const addPayloadType = (payloadType: PayloadType) => {\n    const {\n      channels, id, name, clockrate, parameters,\n    } = payloadType;\n\n    const channelsString = channels ? `/${channels}` : '';\n    add(`a=rtpmap:${id} ${name}/${clockrate}${channelsString}`);\n\n    if (parameters) {\n      const parametersString = Object.keys(parameters).map((key) => {\n        return `${key}=${parameters![key]};`;\n      }).join(' ');\n\n      add(`a=fmtp:${id} ${parametersString}`);\n    }\n\n    payloadType['rtcp-fbs']?.forEach((fbParam) => {\n      add(`a=rtcp-fb:${id} ${fbParam.type}${fbParam.subtype ? ` ${fbParam.subtype}` : ''}`);\n    });\n  };\n\n  const addSsrcEntry = (entry: Ssrc) => {\n    const payloadTypes = entry.isVideo ? videoPayloadTypes : audioPayloadTypes;\n\n    const type = entry.isVideo ? 'video' : 'audio';\n    add(`m=${type} ${entry.isMain ? 1 : 0} RTP/SAVPF ${payloadTypes.map((l) => l.id).join(' ')}`);\n    add('c=IN IP4 0.0.0.0');\n    add('b=AS:1300'); // 1300000 / 1000\n    add(`a=mid:${entry.mid}`);\n    add('a=rtcp-mux');\n    payloadTypes.forEach(addPayloadType);\n\n    add('a=rtcp:1 IN IP4 0.0.0.0');\n    if (entry.isVideo) {\n      add('a=rtcp-rsize');\n    }\n\n    (entry.isVideo ? videoExtensions : audioExtensions).forEach(({ id, uri }) => {\n      add(`a=extmap:${id} ${uri}`);\n    });\n\n    if (entry.isRemoved) {\n      add('a=inactive');\n      return;\n    }\n\n    addTransport();\n\n    if (isP2p) {\n      add('a=sendrecv');\n      add('a=bundle-only');\n    } else {\n      if (isAnswer) {\n        add('a=recvonly');\n        return;\n      }\n      if (entry.isMain) {\n        add('a=sendrecv');\n      } else {\n        add('a=sendonly');\n        add('a=bundle-only');\n      }\n    }\n\n    entry.sourceGroups.forEach((sourceGroup) => {\n      if (sourceGroup.semantics) {\n        add(`a=ssrc-group:${sourceGroup.semantics} ${sourceGroup.sources.map(fromTelegramSource).join(' ')}`);\n      }\n      sourceGroup.sources.forEach((ssrcTelegram) => {\n        const ssrc = fromTelegramSource(ssrcTelegram);\n        add(`a=ssrc:${ssrc} cname:${entry.endpoint}`);\n        add(`a=ssrc:${ssrc} msid:${entry.endpoint} ${entry.endpoint}`);\n        add(`a=ssrc:${ssrc} mslabel:${entry.endpoint}`);\n        add(`a=ssrc:${ssrc} label:${entry.endpoint}`);\n      });\n    });\n  };\n\n  if (!isP2p) {\n    ssrcs.filter((ssrc) => ssrc.mid === '0' || ssrc.mid === '1').map(addSsrcEntry);\n  } else {\n    ssrcs.filter(addSsrcEntry);\n  }\n\n  if (!isPresentation) {\n    add('m=application 1 UDP/DTLS/SCTP webrtc-datachannel');\n    add('c=IN IP4 0.0.0.0');\n    addTransport();\n    add('a=ice-options:trickle');\n    add(`a=mid:${isP2p ? '3' : (isPresentation ? '1' : '2')}`);\n    add('a=sctp-port:5000');\n    add('a=max-message-size:262144');\n  }\n\n  if (!isP2p) {\n    ssrcs.filter((ssrc) => ssrc.mid !== '0' && ssrc.mid !== '1').map(addSsrcEntry);\n  }\n\n  return `${lines.join('\\n')}\\n`;\n};\n","// https://blog.mozilla.org/webrtc/warm-up-with-replacetrack/\n\nexport const silence = (ctx: AudioContext) => {\n  const oscillator = ctx.createOscillator();\n  const dst = oscillator.connect(ctx.createMediaStreamDestination());\n  oscillator.start();\n  return new MediaStream([Object.assign((dst as any).stream.getAudioTracks()[0], { enabled: false })]);\n};\n\nexport const black = ({ width = 640, height = 480 } = {}) => {\n  const canvas = Object.assign(document.createElement('canvas'), { width, height });\n  const ctx = canvas.getContext('2d');\n  if (!ctx) throw Error('Cannot create canvas ctx');\n\n  ctx.fillRect(0, 0, width, height);\n  const stream = canvas.captureStream();\n  return new MediaStream([Object.assign(stream.getVideoTracks()[0], { enabled: false })]);\n};\n","import parseSdp from './parseSdp';\nimport { ColibriClass } from './colibriClass';\nimport type {\n  GroupCallConnectionData, GroupCallConnectionState, GroupCallParticipant, JoinGroupCallPayload,\n} from './types';\nimport buildSdp, { Conference, Ssrc } from './buildSdp';\nimport { black, silence } from './blacksilence';\nimport {\n  getAmplitude,\n  IS_ECHO_CANCELLATION_SUPPORTED,\n  IS_NOISE_SUPPRESSION_SUPPORTED,\n  THRESHOLD,\n} from './utils';\nimport Deferred from \"../../util/Deferred\";\nimport safePlay from \"../../util/safePlay\";\n\nexport type StreamType = 'audio' | 'video' | 'presentation';\nconst DEFAULT_MID = 3;\ntype GroupCallState = {\n  connection?: RTCPeerConnection;\n  screenshareConnection?: RTCPeerConnection;\n  dataChannel?: RTCDataChannel;\n  screenshareDataChannel?: RTCDataChannel;\n  participants?: GroupCallParticipant[];\n  conference?: Partial<Conference>;\n  screenshareConference?: Partial<Conference>;\n  streams?: Record<string, {\n    audio?: MediaStream;\n    video?: MediaStream;\n    presentation?: MediaStream;\n  }>;\n  participantFunctions?: Record<string, {\n    setVolume?: (volume: number) => void;\n    toggleMute?: (muted: boolean) => void;\n    getCurrentAmplitude?: () => number;\n  }>;\n  onUpdate?: (...args: any[]) => void;\n  myId?: string;\n  black?: MediaStream;\n  silence?: MediaStream;\n  updatingParticipantsQueue?: any[];\n  facingMode?: VideoFacingModeEnum;\n  isSpeakerDisabled?: boolean;\n  analyserInterval?: number;\n  speaking?: Record<string, number>;\n  audioElement?: HTMLAudioElement;\n  destination?: MediaStreamAudioDestinationNode;\n  audioContext?: AudioContext;\n  mediaStream?: MediaStream;\n  lastMid: number;\n  audioStream?: MediaStream;\n  audioSource?: MediaStreamAudioSourceNode;\n  audioAnalyser?: AnalyserNode;\n};\n\nlet state: GroupCallState | undefined;\n\nexport async function getDevices(streamType: StreamType, isInput = true) {\n  return (await navigator.mediaDevices.enumerateDevices())\n    .filter((l) => l.kind === `${streamType}${isInput ? 'input' : 'output'}`);\n}\n\nexport function toggleSpeaker() {\n  if (!state) {\n    return;\n  }\n\n  state.isSpeakerDisabled = !state.isSpeakerDisabled;\n  state?.onUpdate?.({\n    '@type': 'updateGroupCallConnectionState',\n    connectionState: 'connected',\n    isSpeakerDisabled: state.isSpeakerDisabled,\n  });\n  if (state.participantFunctions) {\n    Object.values(state.participantFunctions).forEach((l) => {\n      l.toggleMute?.(!!state?.isSpeakerDisabled);\n    });\n  }\n}\n\nfunction leavePresentation(isFromToggle?: boolean) {\n  if (!state) {\n    return;\n  }\n  state.screenshareDataChannel?.close();\n  state.screenshareConnection?.close();\n\n  if (!isFromToggle) {\n    state.onUpdate?.({\n      '@type': 'updateGroupCallLeavePresentation',\n    });\n  }\n}\n\nexport function toggleNoiseSuppression() {\n  if (!state || !state.myId || !state.streams) {\n    return;\n  }\n\n  const audioStream = state.streams[state.myId].audio;\n  if (!audioStream) {\n    return;\n  }\n\n  const track = audioStream.getTracks()[0];\n\n  if (!track) {\n    return;\n  }\n\n  // @ts-ignore\n  const { echoCancellation, noiseSuppression } = track.getConstraints();\n\n  track.applyConstraints({\n    echoCancellation: !echoCancellation,\n    // @ts-ignore\n    noiseSuppression: !noiseSuppression,\n  });\n}\n\nexport function getUserStreams(userId: string) {\n  return state?.streams?.[userId];\n}\n\nexport function setVolume(userId: string, volume: number) {\n  const participantFunctions = state?.participantFunctions?.[userId];\n  if (!participantFunctions) return;\n  participantFunctions.setVolume?.(volume);\n}\n\nexport function isStreamEnabled(streamType: StreamType, userId?: string) {\n  const id = userId || state?.myId;\n  const stream = id && getUserStreams(id)?.[streamType];\n  if (!stream) return false;\n\n  return stream.getTracks()[0]?.enabled;\n}\n\nfunction updateGroupCallStreams(userId: string) {\n  state?.onUpdate?.({\n    '@type': 'updateGroupCallStreams',\n    userId,\n    hasAudioStream: isStreamEnabled('audio', userId),\n    hasVideoStream: isStreamEnabled('video', userId),\n    hasPresentationStream: isStreamEnabled('presentation', userId),\n    amplitude: state.speaking?.[userId],\n  });\n}\n\nasync function getUserStream(streamType: StreamType, facing: VideoFacingModeEnum = 'user') {\n  if (streamType === 'audio' && state?.audioStream) {\n    return state.audioStream;\n  }\n\n  if (streamType === 'presentation') {\n    return (navigator.mediaDevices as any).getDisplayMedia({\n      audio: false,\n      video: true,\n    });\n  }\n\n  const media = await navigator.mediaDevices.getUserMedia({\n    audio: streamType === 'audio' ? {\n      // @ts-ignore\n      ...(IS_ECHO_CANCELLATION_SUPPORTED && {echoCancellation: true}),\n      ...(IS_NOISE_SUPPRESSION_SUPPORTED && {noiseSuppression: true}),\n    } : false,\n    video: streamType === 'video' ? {\n      facingMode: facing,\n    } : false,\n  });\n\n  if (state && streamType === 'audio') {\n    state.audioStream = media;\n  }\n\n  if (streamType === 'video') {\n    const vid = document.createElement('video');\n    vid.srcObject = media;\n\n    const deferred = new Deferred();\n    vid.oncanplay = () => deferred.resolve();\n    await deferred.promise;\n  }\n\n  return media;\n}\n\nexport async function switchCameraInput() {\n  if (!state?.myId || !state.connection || !state.streams || !state.facingMode) {\n    return;\n  }\n\n  const stream = getUserStreams(state.myId)?.video;\n\n  if (!stream) return;\n\n  const track = stream.getTracks()[0];\n\n  if (!track) {\n    return;\n  }\n\n  const sender = state.connection.getSenders().find((l) => track.id === l.track?.id);\n\n  if (!sender) {\n    return;\n  }\n\n  state.facingMode = state.facingMode === 'environment' ? 'user' : 'environment';\n  try {\n    const newStream = await getUserStream('video', state.facingMode);\n\n    await sender.replaceTrack(newStream.getTracks()[0]);\n    state.streams[state.myId].video = newStream;\n  } catch (e) {\n\n  }\n}\n\nexport async function toggleStream(streamType: StreamType, value: boolean | undefined = undefined) {\n  if (!state || !state.myId || !state.connection || !state.streams) {\n    return;\n  }\n\n  const stream = getUserStreams(state.myId)?.[streamType];\n  if (!stream) return;\n\n  const track = stream.getTracks()[0];\n\n  if (!track) {\n    return;\n  }\n\n  const sender = [\n    ...state.connection.getSenders(),\n    ...(state.screenshareConnection?.getSenders() || []),\n  ].find((l) => track.id === l.track?.id);\n\n  if (!sender) {\n    return;\n  }\n\n  value = value === undefined ? !track.enabled : value;\n\n  try {\n    if (value && !track.enabled) {\n      const newStream = await getUserStream(streamType);\n      await sender.replaceTrack(newStream.getTracks()[0]);\n      state.streams[state.myId][streamType] = newStream;\n      if (streamType === 'video') {\n        state.facingMode = 'user';\n      } else if (streamType === 'audio') {\n        const { audioContext } = state;\n        if (!audioContext) return;\n        const source = state.audioSource || audioContext.createMediaStreamSource(newStream);\n\n        const analyser = state.audioAnalyser || audioContext.createAnalyser();\n        analyser.minDecibels = -100;\n        analyser.maxDecibels = -30;\n        analyser.smoothingTimeConstant = 0.05;\n        analyser.fftSize = 1024;\n\n        source.connect(analyser);\n\n        state = {\n          ...state,\n          audioSource: source,\n          audioAnalyser: analyser,\n          participantFunctions: {\n            ...state.participantFunctions,\n            [state.myId]: {\n              ...state.participantFunctions?.[state.myId],\n              getCurrentAmplitude: () => {\n                const array = new Uint8Array(analyser.frequencyBinCount);\n                analyser.getByteFrequencyData(array);\n                return getAmplitude(array, 1.5);\n              },\n            },\n          },\n        };\n      }\n    } else if (!value && track.enabled) {\n      const newStream = streamType === 'audio' ? state.silence : state.black;\n      if (!newStream) return;\n\n      await sender.replaceTrack(newStream.getTracks()[0]);\n      state.streams[state.myId][streamType] = newStream;\n      if (streamType === 'video') {\n        state.facingMode = undefined;\n      }\n\n      if(streamType !== 'audio') {\n        // We only want to stop video streams\n        track.stop();\n      } else {\n        state.audioSource?.disconnect();\n        state.audioAnalyser?.disconnect();\n      }\n    }\n    updateGroupCallStreams(state.myId!);\n    if (streamType === 'presentation' && !value) leavePresentation(true);\n  } catch (e) {\n\n  }\n}\n\nfunction updateConnectionState(connectionState: GroupCallConnectionState) {\n  state?.onUpdate?.({\n    '@type': 'updateGroupCallConnectionState',\n    connectionState,\n  });\n}\n\nexport function leaveGroupCall() {\n  if (!state) {\n    return;\n  }\n\n  if (state.myId && state.streams?.[state.myId]) {\n    Object.values(state.streams[state.myId] || {}).forEach((stream) => {\n      stream?.getTracks().forEach((track) => {\n        track.stop();\n      });\n    });\n  }\n\n  state.audioStream?.getTracks().forEach((track) => {\n    track.stop();\n  });\n  leavePresentation(true);\n  state.dataChannel?.close();\n  state.connection?.close();\n  updateConnectionState('disconnected');\n\n  if (state.analyserInterval) {\n    clearInterval(state.analyserInterval);\n  }\n\n  state = undefined;\n}\n\nfunction analyzeAmplitudes() {\n  if (!state || !state.participantFunctions) return;\n\n  Object.keys(state.participantFunctions).forEach((id) => {\n    const { getCurrentAmplitude } = state!.participantFunctions![Number(id)];\n\n    if (getCurrentAmplitude) {\n      const amplitude = getCurrentAmplitude();\n      const prevAmplitude = state!.speaking![id] || 0;\n      state!.speaking![id] = amplitude;\n      if ((amplitude > THRESHOLD && prevAmplitude <= THRESHOLD)\n        || (amplitude <= THRESHOLD && prevAmplitude > THRESHOLD)) {\n        updateGroupCallStreams(id);\n      }\n    }\n  });\n}\n\nfunction createDataChannel(connection: RTCPeerConnection) {\n  const dataChannel = connection.createDataChannel('data', {\n    id: 0,\n  });\n\n  dataChannel.onopen = () => {\n    // console.log('Data channel open!');\n  };\n\n  dataChannel.onmessage = (e) => {\n    // console.log('onmessage');\n    const data = JSON.parse(e.data) as ColibriClass;\n    // console.log(data);\n    switch (data.colibriClass) {\n      case 'DominantSpeakerEndpointChangeEvent':\n        break;\n      case 'SenderVideoConstraints':\n\n        break;\n      case 'EndpointConnectivityStatusChangeEvent':\n\n        break;\n    }\n  };\n\n  dataChannel.onerror = (e) => {\n    console.log('%conerror', 'background: green; font-size: 5em');\n    console.error(e);\n  };\n\n  return dataChannel;\n}\n\nexport async function handleUpdateGroupCallParticipants(updatedParticipants: GroupCallParticipant[]) {\n  if (!state) {\n    return;\n  }\n\n  const {\n    participants, conference, connection, myId,\n  } = state;\n\n  if (!participants || !conference || !connection || !conference.ssrcs || !conference.transport || !myId) {\n    return;\n  }\n\n  // Joined from another client\n  if (updatedParticipants.find((participant) => {\n    return participant.isSelf\n      && participant.source\n      !== state?.conference?.ssrcs?.find((l) => l.isMain && !l.isVideo)?.sourceGroups[0].sources[0];\n  })) {\n    leaveGroupCall();\n    return;\n  }\n\n  const newEndpoints: string[] = [];\n  updatedParticipants.forEach((participant) => {\n    if (participant.isSelf) {\n      if (participant.isMuted && !participant.canSelfUnmute) {\n        // Muted by admin\n        toggleStream('audio', false);\n        toggleStream('video', false);\n        toggleStream('presentation', false);\n      }\n      return;\n    }\n\n    const { isLeft } = participant;\n    const isAudioLeft = participant.isMuted || participant.isMutedByMe;\n    const isVideoLeft = !participant.isVideoJoined || !participant.video || isLeft;\n    const isPresentationLeft = !participant.presentation || isLeft;\n\n    let hasVideo = false;\n    let hasAudio = false;\n    let hasPresentation = false;\n\n    conference.ssrcs!.filter((l) => l.userId === participant.id).forEach((ssrc) => {\n      if (!ssrc.isVideo) {\n        if (ssrc.sourceGroups[0].sources[0] === participant.source) {\n          hasAudio = true;\n        }\n        // console.log('has audio, removed=', isAudioLeft);\n        ssrc.isRemoved = isAudioLeft;\n      }\n\n      if (ssrc.isVideo) {\n        if (!ssrc.isPresentation) {\n          if (!!participant.video && ssrc.endpoint === participant.video.endpoint) {\n            hasVideo = true;\n          }\n          // console.log('has video = ', hasVideo, ' removed=', isVideoLeft);\n          ssrc.isRemoved = isVideoLeft;\n        }\n\n        if (ssrc.isPresentation) {\n          if (!!participant.presentation && ssrc.endpoint === participant.presentation.endpoint) {\n            hasPresentation = true;\n          }\n          // console.log('has presentation, removed=', isPresentationLeft);\n          ssrc.isRemoved = isPresentationLeft;\n        }\n      }\n    });\n\n    if (!isAudioLeft && !hasAudio) {\n      // console.log('add audio');\n      state!.lastMid = state!.lastMid + 1;\n      conference.ssrcs!.push({\n        userId: participant.id,\n        isMain: false,\n        endpoint: `audio${participant.source}`,\n        isVideo: false,\n        sourceGroups: [{\n          sources: [participant.source],\n        }],\n        mid: state!.lastMid.toString()\n      });\n    }\n\n    if (!isVideoLeft && !hasVideo && participant.video) {\n      // console.log('add video', participant.video);\n      state!.lastMid = state!.lastMid + 1;\n\n      newEndpoints.push(participant.video.endpoint);\n      conference.ssrcs!.push({\n        userId: participant.id,\n        isMain: false,\n        endpoint: participant.video.endpoint,\n        isVideo: true,\n        sourceGroups: participant.video.sourceGroups,\n        mid: state!.lastMid.toString()\n      });\n    }\n\n    if (!isPresentationLeft && !hasPresentation && participant.presentation) {\n      // console.log('add presentation');\n      state!.lastMid = state!.lastMid + 1;\n      conference.ssrcs!.push({\n        isPresentation: true,\n        userId: participant.id,\n        isMain: false,\n        endpoint: participant.presentation.endpoint,\n        isVideo: true,\n        sourceGroups: participant.presentation.sourceGroups,\n        mid: state!.lastMid.toString()\n      });\n    }\n  });\n\n  if (state.updatingParticipantsQueue) {\n    state.updatingParticipantsQueue.push(conference);\n    return;\n  } else {\n    state.updatingParticipantsQueue = [];\n  }\n\n  const sdp = buildSdp(conference as Conference);\n  await connection.setRemoteDescription({\n    type: 'offer',\n    sdp,\n  });\n\n  try {\n    const answer = await connection.createAnswer();\n    await connection.setLocalDescription(answer);\n\n    updateGroupCallStreams(myId);\n    if (state.updatingParticipantsQueue.length > 0) {\n      // eslint-disable-next-line no-restricted-syntax\n      for (const newConference of state.updatingParticipantsQueue) {\n        await connection.setRemoteDescription({\n          type: 'offer',\n          sdp: buildSdp(newConference as Conference),\n        });\n        const answerNew = await connection.createAnswer();\n        await connection.setLocalDescription(answerNew);\n        updateGroupCallStreams(myId);\n\n        // if (newEndpoints.length > 0) {\n        //   sendDataChannelMessage({\n        //     colibriClass: 'ReceiverVideoConstraints',\n        //     defaultConstraints: {\n        //       maxHeight: 0,\n        //     },\n        //     constraints: {\n        //       ...(newEndpoints.reduce((acc: Record<string, any>, el) => {\n        //         acc[el] = {\n        //           minHeight: 0,\n        //           maxHeight: 1080,\n        //         };\n        //         return acc;\n        //       }, {})),\n        //     },\n        //     onStageEndpoints: [],\n        //   });\n        // }\n      }\n    }\n    state.updatingParticipantsQueue = undefined;\n  } catch (e) {\n    console.error(e);\n  }\n}\n//\n// function sendDataChannelMessage(message: ColibriClass) {\n//   if (!state || !state.dataChannel || state.dataChannel.readyState !== 'open') {\n//     return;\n//   }\n//\n//   // console.log('SEND!', message);\n//   state.dataChannel.send(JSON.stringify(message));\n// }\n\nexport async function handleUpdateGroupCallConnection(data: GroupCallConnectionData, isPresentation: boolean) {\n  if (!state) {\n    return;\n  }\n\n  const conference = isPresentation ? state.screenshareConference : state.conference;\n  const connection = isPresentation ? state.screenshareConnection : state.connection;\n\n  if (!conference || !connection || !conference.ssrcs) {\n    return;\n  }\n\n  const sessionId = Date.now();\n  const newConference = {\n    ...conference,\n    transport: data.transport,\n    sessionId,\n    audioExtensions: data.audio?.['rtp-hdrexts'],\n    audioPayloadTypes: data.audio?.['payload-types'],\n    videoExtensions: data.video?.['rtp-hdrexts'],\n    videoPayloadTypes: data.video?.['payload-types'],\n  } as Conference;\n\n  state = {\n    ...state,\n    ...(!isPresentation ? { conference: newConference } : { screenshareConference: newConference }),\n  };\n\n  try {\n    await connection.setRemoteDescription({\n      type: 'answer',\n      sdp: buildSdp(newConference, true, isPresentation),\n    });\n\n    // state.resolveTest();\n    // state.test = true;\n  } catch (e) {\n    console.error(e);\n  }\n}\n\nfunction handleTrack(e: RTCTrackEvent) {\n  if (!state || !state.audioElement || !state.audioContext || !state.mediaStream) {\n    return;\n  }\n  const ssrc = state.conference?.ssrcs?.find((l) => l.endpoint === e.track.id);\n  if (!ssrc || !ssrc.userId) {\n    return;\n  }\n\n  const { userId, isPresentation } = ssrc;\n  const participant = state.participants?.find((p) => p.id === userId);\n\n  const streamType = (e.track.kind === 'video' ? (isPresentation ? 'presentation' : 'video') : 'audio') as StreamType;\n\n  e.track.onended = () => {\n    delete state?.streams?.[userId][streamType];\n    updateGroupCallStreams(userId);\n  };\n\n  const stream = e.streams[0];\n\n  if (e.track.kind === 'audio') {\n    const { mediaStream } = state;\n    const audioContext = new (window.AudioContext)();\n    const source = audioContext.createMediaStreamSource(stream);\n\n    const gainNode = audioContext.createGain();\n    gainNode.gain.value = (participant?.volume || 10000) / 10000;\n\n    const muteNode = audioContext.createGain();\n    gainNode.gain.value = 1;\n\n    const analyser = audioContext.createAnalyser();\n    analyser.minDecibels = -100;\n    analyser.maxDecibels = -30;\n    analyser.smoothingTimeConstant = 0.05;\n    analyser.fftSize = 1024;\n\n    source.connect(analyser).connect(muteNode).connect(gainNode).connect(audioContext.destination);\n\n    mediaStream!.addTrack(source.mediaStream.getAudioTracks()[0]);\n\n    // https://stackoverflow.com/questions/41784137/webrtc-doesnt-work-with-audiocontext#comment117600018_41784241\n    const test = new Audio();\n    test.srcObject = stream;\n    // test.srcObject = source.mediaStream;\n    test.muted = true;\n    test.remove();\n\n    state = {\n      ...state,\n      participantFunctions: {\n        ...state.participantFunctions,\n        [userId]: {\n          ...state.participantFunctions?.[userId],\n          setVolume: (volume: number) => {\n            gainNode.gain.value = volume > 1 ? volume * 2 : volume;\n          },\n          toggleMute: (muted?: boolean) => {\n            muteNode.gain.value = muted ? 0 : 1;\n          },\n          getCurrentAmplitude: () => {\n            const array = new Uint8Array(analyser.frequencyBinCount);\n            analyser.getByteFrequencyData(array);\n            return getAmplitude(array, 1.5);\n          },\n        },\n      },\n    };\n  }\n\n  state = {\n    ...state,\n    streams: {\n      ...state.streams,\n      [userId]: {\n        ...state.streams?.[userId],\n        [streamType]: stream,\n      },\n    },\n  };\n\n  updateGroupCallStreams(userId);\n}\n\nfunction initializeConnection(\n  streams: MediaStream[],\n  resolve: (payload: JoinGroupCallPayload) => void,\n  isPresentation = false,\n) {\n  const connection = new RTCPeerConnection();\n\n  const dataChannel = isPresentation ? undefined : createDataChannel(connection);\n\n  streams.forEach((stream) => stream.getTracks().forEach((track) => {\n    connection.addTrack(track, stream);\n  }));\n\n  if (!isPresentation) {\n    connection.oniceconnectionstatechange = () => {\n      const connectionState = connection.iceConnectionState;\n      console.log('iceconnectionstatechange', connectionState);\n      if (connectionState === 'connected' || connectionState === 'completed') {\n        updateConnectionState('connected');\n      } else if (connectionState === 'checking' || connectionState === 'new') {\n        updateConnectionState('connecting');\n      } else if (connection.iceConnectionState === 'disconnected') {\n        updateConnectionState('reconnecting');\n      }\n    };\n  }\n  connection.onconnectionstatechange = () => {\n    console.log('connectionstatechange', connection.connectionState);\n  }\n  connection.ontrack = handleTrack;\n  connection.onnegotiationneeded = async () => {\n    if (!state) return;\n\n    console.log('onnegotiationneeded');\n\n    const { myId } = state;\n\n    if (!myId) {\n      return;\n    }\n    const offer = await connection.createOffer({\n      offerToReceiveVideo: true,\n      offerToReceiveAudio: !isPresentation,\n    });\n    console.log('offer created');\n\n    await connection.setLocalDescription(offer);\n    console.log('local desc set');\n\n    if (!offer.sdp) {\n      return;\n    }\n\n    const sdp = parseSdp(offer);\n    const audioSsrc: Ssrc | undefined = !isPresentation ? {\n      userId: '',\n      sourceGroups: [\n        {\n          sources: [sdp.ssrc || 0],\n        },\n      ],\n      isRemoved: isPresentation,\n      isMain: true,\n      isVideo: false,\n      isPresentation,\n      endpoint: isPresentation ? '1' : '0',\n      mid: isPresentation ? '1' : '0'\n    } : undefined;\n\n    const videoSsrc: Ssrc | undefined = sdp['ssrc-groups'] && {\n      isPresentation,\n      userId: '',\n      sourceGroups: sdp['ssrc-groups'],\n      isMain: true,\n      isVideo: true,\n      endpoint: isPresentation ? '0' : '1',\n      mid: isPresentation ? '0' : '1'\n    };\n\n    const conference = isPresentation ? state.screenshareConference : state.conference;\n\n    const ssrcs: Ssrc[] = [];\n    if (isPresentation) {\n      if (videoSsrc) ssrcs.push(videoSsrc);\n      if (audioSsrc) ssrcs.push(audioSsrc);\n    } else {\n      if (audioSsrc) ssrcs.push(audioSsrc);\n      if (videoSsrc) ssrcs.push(videoSsrc);\n    }\n\n    const audioStream = streams.find((l) => l.getTracks()[0].kind === 'audio');\n    const videoStream = streams.find((l) => l.getTracks()[0].kind === 'video');\n\n    state = {\n      ...state,\n      ...(!isPresentation ? {\n        conference: {\n          ...conference,\n          ssrcs,\n        },\n      } : {\n        screenshareConference: {\n          ...conference,\n          ssrcs,\n        },\n      }),\n      streams: {\n        ...state.streams,\n        [myId]: {\n          ...state.streams?.[myId],\n          ...(audioStream && { audio: audioStream }),\n          ...(!isPresentation && videoStream ? { video: videoStream } : { presentation: videoStream }),\n        },\n      },\n    };\n\n    updateGroupCallStreams(myId);\n\n    resolve(sdp);\n  };\n\n  return { connection, dataChannel };\n}\n\nexport async function startSharingScreen(): Promise<JoinGroupCallPayload | undefined> {\n  if (!state) {\n    return undefined;\n  }\n\n  try {\n    const stream: MediaStream | undefined = await getUserStream('presentation');\n\n    if (!stream) {\n      return undefined;\n    }\n\n    stream.getTracks()[0].onended = () => {\n      if (state && state.myId) {\n        delete state.streams?.[state.myId].presentation;\n        updateGroupCallStreams(state.myId);\n        leavePresentation();\n      }\n    };\n\n    return await new Promise((resolve) => {\n      const { connection, dataChannel } = initializeConnection([stream], resolve, true);\n      state = {\n        ...state!,\n        screenshareConnection: connection,\n        screenshareDataChannel: dataChannel,\n      };\n    });\n  } catch (e) {\n    return undefined;\n  }\n}\n\nexport function joinGroupCall(\n  myId: string,\n  audioContext: AudioContext,\n  audioElement: HTMLAudioElement,\n  onUpdate: (...args: any[]) => void,\n): Promise<JoinGroupCallPayload> {\n  if (state) {\n    throw Error('Already in call');\n  }\n\n  updateConnectionState('connecting');\n\n  const mediaStream = new MediaStream();\n  audioElement.srcObject = mediaStream;\n  safePlay(audioElement);\n\n  state = {\n    onUpdate,\n    participants: [],\n    myId,\n    speaking: {},\n    silence: silence(audioContext),\n    black: black({ width: 640, height: 480 }),\n    // @ts-ignore\n    analyserInterval: setInterval(analyzeAmplitudes, 1000),\n    audioElement,\n    // destination,\n    audioContext,\n    mediaStream,\n    lastMid: DEFAULT_MID,\n  };\n\n  // Prepare microphone\n  getUserStream('audio');\n\n  return new Promise((resolve) => {\n    state = {\n      ...state!,\n      ...initializeConnection([state!.silence!, state!.black!], resolve),\n    };\n  });\n}\n","import { black, silence } from './blacksilence';\nimport type { ApiPhoneCallConnection, P2pParsedSdp } from './types';\nimport parseSdp from './parseSdp';\nimport type { MediaContent, MediaStateMessage, P2pMessage } from './p2pMessage';\nimport {\n  fromTelegramSource,\n  IS_ECHO_CANCELLATION_SUPPORTED,\n  IS_NOISE_SUPPRESSION_SUPPORTED, \n  p2pPayloadTypeToConference,\n} from './utils';\nimport buildSdp, { Conference } from './buildSdp';\nimport { StreamType } from './secretsauce';\n\ntype P2pState = {\n  connection: RTCPeerConnection;\n  dataChannel: RTCDataChannel;\n  emitSignalingData: (data: P2pMessage) => void;\n  onUpdate: (...args: any[]) => void;\n  conference?: Partial<Conference>;\n  isOutgoing: boolean;\n  pendingCandidates: string[];\n  streams: {\n    video?: MediaStream;\n    audio?: MediaStream;\n    presentation?: MediaStream;\n    ownAudio?: MediaStream;\n    ownVideo?: MediaStream;\n    ownPresentation?: MediaStream;\n  };\n  silence: MediaStream;\n  blackVideo: MediaStream;\n  blackPresentation: MediaStream;\n  mediaState: Omit<MediaStateMessage, '@type'>;\n  audio: HTMLAudioElement;\n  gotInitialSetup?: boolean;\n  facingMode?: VideoFacingModeEnum;\n};\n\nlet state: P2pState | undefined;\n\nconst ICE_CANDIDATE_POOL_SIZE = 10;\n\nexport function getStreams() {\n  return state?.streams;\n}\n\nfunction updateStreams() {\n  state?.onUpdate({\n    ...state.mediaState,\n    '@type': 'updatePhoneCallMediaState',\n  });\n}\n\nfunction getUserStream(streamType: StreamType, facing: VideoFacingModeEnum = 'user') {\n  if (streamType === 'presentation') {\n    return (navigator.mediaDevices as any).getDisplayMedia({\n      audio: false,\n      video: true,\n    });\n  }\n\n  return navigator.mediaDevices.getUserMedia({\n    audio: streamType === 'audio' ? {\n      ...(IS_ECHO_CANCELLATION_SUPPORTED && { echoCancellation: true }),\n      ...(IS_NOISE_SUPPRESSION_SUPPORTED && { noiseSuppression: true }),\n    } : false,\n    video: streamType === 'video' ? {\n      facingMode: facing,\n    } : false,\n  });\n}\n\nexport async function switchCameraInputP2p() {\n  if (!state || !state.facingMode) {\n    return;\n  }\n\n  const stream = state.streams.ownVideo;\n\n  if (!stream) return;\n\n  const track = stream.getTracks()[0];\n\n  if (!track) {\n    return;\n  }\n\n  const sender = state.connection.getSenders().find((l) => track.id === l.track?.id);\n\n  if (!sender) {\n    return;\n  }\n\n  state.facingMode = state.facingMode === 'environment' ? 'user' : 'environment';\n  try {\n    const newStream = await getUserStream('video', state.facingMode);\n\n    await sender.replaceTrack(newStream.getTracks()[0]);\n    state.streams.ownVideo = newStream;\n    updateStreams();\n  } catch (e) {\n\n  }\n}\n\nexport async function toggleStreamP2p(streamType: StreamType, value: boolean | undefined = undefined) {\n  if (!state) return;\n  const stream = streamType === 'audio' ? state.streams.ownAudio\n    : (streamType === 'video' ? state.streams.ownVideo : state.streams.ownPresentation);\n\n  if (!stream) return;\n  const track = stream.getTracks()[0];\n\n  if (!track) {\n    return;\n  }\n\n  const sender = state.connection.getSenders().find((l) => track.id === l.track?.id);\n\n  if (!sender) {\n    return;\n  }\n\n  value = value === undefined ? !track.enabled : value;\n\n  try {\n    if (value && !track.enabled) {\n      const newStream = await getUserStream(streamType);\n      newStream.getTracks()[0].onended = () => {\n        toggleStreamP2p(streamType, false);\n      };\n      await sender.replaceTrack(newStream.getTracks()[0]);\n      if (streamType === 'audio') {\n        state.streams.ownAudio = newStream;\n      } else if (streamType === 'video') {\n        state.streams.ownVideo = newStream;\n        state.facingMode = 'user';\n      } else {\n        state.streams.ownPresentation = newStream;\n      }\n      if (streamType === 'video' || streamType === 'presentation') {\n        toggleStreamP2p(streamType === 'video' ? 'presentation' : 'video', false);\n      }\n      // if (streamType === 'video') {\n      //   state.facingMode = 'user';\n      // }\n    } else if (!value && track.enabled) {\n      track.stop();\n      const newStream = streamType === 'audio' ? state.silence\n        : (streamType === 'video' ? state.blackVideo : state.blackPresentation);\n      if (!newStream) return;\n\n      await sender.replaceTrack(newStream.getTracks()[0]);\n\n      if (streamType === 'audio') {\n        state.streams.ownAudio = newStream;\n      } else if (streamType === 'video') {\n        state.streams.ownVideo = newStream;\n      } else {\n        state.streams.ownPresentation = newStream;\n      }\n      // if (streamType === 'video') {\n      //   state.facingMode = undefined;\n      // }\n    }\n    updateStreams();\n    sendMediaState();\n  } catch (err) {\n    console.error(err)\n  }\n}\n\nexport async function joinPhoneCall(\n  connections: ApiPhoneCallConnection[],\n  emitSignalingData: (data: P2pMessage) => void,\n  isOutgoing: boolean,\n  shouldStartVideo: boolean,\n  isP2p: boolean,\n  onUpdate: (...args: any[]) => void,\n) {\n  const conn = new RTCPeerConnection({\n    iceServers: connections.map((connection) => (\n      {\n        urls: [\n          connection.isTurn && `turn:${connection.ip}:${connection.port}`,\n          connection.isStun && `stun:${connection.ip}:${connection.port}`,\n        ].filter(Boolean),\n        username: connection.username,\n        credentialType: 'password',\n        credential: connection.password,\n      }\n    )),\n    iceTransportPolicy: isP2p ? 'all' : 'relay',\n    bundlePolicy: 'max-bundle',\n    iceCandidatePoolSize: ICE_CANDIDATE_POOL_SIZE,\n  });\n\n  conn.onicecandidate = (e) => {\n    if (!e.candidate) {\n      return;\n    };\n    emitSignalingData({\n      '@type': 'Candidates',\n      candidates: [{\n        sdpString: e.candidate.candidate,\n      }],\n    });\n  };\n\n  conn.onconnectionstatechange = () => {\n    onUpdate({\n      '@type': 'updatePhoneCallConnectionState',\n      connectionState: conn.connectionState,\n    });\n  };\n\n  conn.ontrack = (e) => {\n    if (!state) return;\n\n    const stream = e.streams[0];\n    if (e.track.kind === 'audio') {\n      state.audio.srcObject = stream;\n      state.audio.play().catch();\n      state.streams.audio = stream;\n    } else if (e.transceiver.mid === '1') {\n      state.streams.video = stream;\n    } else {\n      state.streams.presentation = stream;\n    }\n\n    updateStreams();\n  };\n\n  conn.oniceconnectionstatechange = async (e) => {\n    switch(conn.iceConnectionState) {\n      case 'disconnected':\n      case 'failed':\n        if (isOutgoing) {\n          await createOffer(conn, {\n            offerToReceiveAudio: true,\n            offerToReceiveVideo: true,\n            iceRestart: true,\n          });\n        }\n      default:\n        break;\n    }\n  }\n\n  const slnc = silence(new AudioContext());\n  const video = black({ width: 640, height: 480 });\n  const screenshare = black({ width: 640, height: 480 });\n  conn.addTrack(slnc.getTracks()[0], slnc);\n  conn.addTrack(video.getTracks()[0], video);\n  conn.addTrack(screenshare.getTracks()[0], screenshare);\n\n  const dc = conn.createDataChannel('data', {\n    id: 0,\n    negotiated: true,\n  });\n\n  dc.onmessage = (e) => {\n    processSignalingMessage(JSON.parse(e.data));\n  };\n\n  const audio = new Audio();\n\n  state = {\n    audio,\n    connection: conn,\n    emitSignalingData,\n    isOutgoing,\n    pendingCandidates: [],\n    onUpdate,\n    streams: {\n      ownVideo: video,\n      ownAudio: slnc,\n      ownPresentation: screenshare,\n    },\n    mediaState: {\n      isBatteryLow: false,\n      screencastState: 'inactive',\n      videoState: 'inactive',\n      videoRotation: 0,\n      isMuted: true,\n    },\n    blackVideo: video,\n    blackPresentation: screenshare,\n    silence: slnc,\n    dataChannel: dc,\n  };\n\n  try {\n    toggleStreamP2p('audio', true);\n  } catch (err) {\n    console.error(err)\n  }\n\n  if (isOutgoing) {\n    await createOffer(conn, {\n      offerToReceiveAudio: true,\n      offerToReceiveVideo: true,\n    })\n  }\n}\n\nexport function stopPhoneCall() {\n  if (!state) return;\n\n  state.streams.ownVideo?.getTracks().forEach((track) => track.stop());\n  state.streams.ownPresentation?.getTracks().forEach((track) => track.stop());\n  state.streams.ownAudio?.getTracks().forEach((track) => track.stop());\n  state.dataChannel.close();\n  state.connection.close();\n  state = undefined;\n}\n\nfunction sendMediaState() {\n  if (!state) return;\n  const { emitSignalingData, streams } = state;\n\n  emitSignalingData({\n    '@type': 'MediaState',\n    videoRotation: 0,\n    isMuted: !streams.ownAudio?.getTracks()[0].enabled,\n    isBatteryLow: true,\n    videoState: streams.ownVideo?.getTracks()[0].enabled ? 'active' : 'inactive',\n    screencastState: streams.ownPresentation?.getTracks()[0].enabled ? 'active' : 'inactive',\n  });\n}\n\nfunction filterVP8(mediaContent: MediaContent) {\n  if (!state || state.isOutgoing) return mediaContent;\n\n  const { payloadTypes } = mediaContent!;\n  const idx = payloadTypes.findIndex((payloadType) => payloadType.name === 'VP8');\n  const vp8PayloadType = payloadTypes[idx];\n  const rtxIdx = payloadTypes.findIndex((payloadType) => Number(payloadType.parameters?.apt) === vp8PayloadType.id);\n  mediaContent.payloadTypes = [payloadTypes[idx], payloadTypes[rtxIdx]];\n\n  return mediaContent;\n}\n\nfunction sendInitialSetup(sdp: P2pParsedSdp) {\n  if (!state) return;\n  const { emitSignalingData } = state;\n\n  if (!sdp.ssrc || !sdp['ssrc-groups'] || !sdp['ssrc-groups'][0] || !sdp['ssrc-groups'][1]) return;\n\n  emitSignalingData({\n    '@type': 'InitialSetup',\n    fingerprints: sdp.fingerprints,\n    ufrag: sdp.ufrag,\n    pwd: sdp.pwd,\n    audio: {\n      ssrc: fromTelegramSource(sdp.ssrc).toString(),\n      ssrcGroups: [],\n      payloadTypes: sdp.audioPayloadTypes,\n      rtpExtensions: sdp.audioExtmap,\n    },\n    video: filterVP8({\n      ssrc: fromTelegramSource(sdp['ssrc-groups'][0].sources[0]).toString(),\n      ssrcGroups: [{\n        semantics: sdp['ssrc-groups'][0].semantics,\n        ssrcs: sdp['ssrc-groups'][0].sources.map(fromTelegramSource),\n      }],\n      payloadTypes: sdp.videoPayloadTypes,\n      rtpExtensions: sdp.videoExtmap,\n    }),\n    screencast: filterVP8({\n      ssrc: fromTelegramSource(sdp['ssrc-groups'][1].sources[0]).toString(),\n      ssrcGroups: [{\n        semantics: sdp['ssrc-groups'][1].semantics,\n        ssrcs: sdp['ssrc-groups'][1].sources.map(fromTelegramSource),\n      }],\n      payloadTypes: sdp.screencastPayloadTypes,\n      rtpExtensions: sdp.screencastExtmap,\n    }),\n  });\n}\n\nexport async function processSignalingMessage(message: P2pMessage) {\n  if (!state || !state.connection) return;\n\n  switch (message['@type']) {\n    case 'MediaState': {\n      state.mediaState = message;\n      updateStreams();\n      sendMediaState();\n      break;\n    }\n    case 'Candidates': {\n      const { pendingCandidates, gotInitialSetup } = state;\n      message.candidates.forEach((candidate) => {\n        pendingCandidates.push(candidate.sdpString);\n      });\n      if (gotInitialSetup) {\n        await commitPendingIceCandidates();\n      }\n      break;\n    }\n    case 'InitialSetup': {\n      const {\n        connection, isOutgoing,\n      } = state;\n      if (!connection) return;\n\n      const newConference = {\n        transport: {\n          candidates: [],\n          ufrag: message.ufrag,\n          pwd: message.pwd,\n          fingerprints: message.fingerprints,\n          'rtcp-mux': false,\n          xmlns: '',\n        },\n        sessionId: Date.now(),\n        ssrcs: [\n          message.audio && {\n            isVideo: false,\n            isMain: false,\n            userId: '123',\n            endpoint: '0',\n            mid: '0',\n            sourceGroups: [{\n              sources: [message.audio.ssrc],\n            }],\n          },\n          message.video && {\n            isVideo: true,\n            isPresentation: false,\n            isMain: false,\n            userId: '123',\n            endpoint: '1',\n            mid: '1',\n            sourceGroups: message.video.ssrcGroups.map((l) => ({\n              semantics: l.semantics,\n              sources: l.ssrcs,\n            })),\n          },\n          message.screencast && {\n            isVideo: true,\n            isPresentation: true,\n            isMain: false,\n            userId: '123',\n            endpoint: '2',\n            mid: '2',\n            sourceGroups: message.screencast.ssrcGroups.map((l) => ({\n              semantics: l.semantics,\n              sources: l.ssrcs,\n            })),\n          },\n        ],\n        audioPayloadTypes: message.audio!.payloadTypes?.map(p2pPayloadTypeToConference) || [],\n        audioExtensions: message.audio!.rtpExtensions,\n        videoPayloadTypes: filterVP8(message.video!).payloadTypes?.map(p2pPayloadTypeToConference) || [],\n        videoExtensions: message.video!.rtpExtensions,\n      } as Conference;\n\n      await connection.setRemoteDescription({\n        sdp: buildSdp(newConference, isOutgoing, undefined, true),\n        type: isOutgoing ? 'answer' : 'offer',\n      });\n\n      state.conference = newConference;\n\n      if (!isOutgoing) {\n        const answer = await connection.createAnswer();\n        await connection.setLocalDescription(answer);\n        sendInitialSetup(parseSdp(connection.localDescription!, true) as P2pParsedSdp);\n      }\n      state.gotInitialSetup = true;\n      await commitPendingIceCandidates();\n      break;\n    }\n  }\n}\n\nasync function commitPendingIceCandidates() {\n  if (!state) {\n    return;\n  }\n  const { pendingCandidates, connection } = state;\n  if (!pendingCandidates.length) {\n    return;\n  }\n  await Promise.all(pendingCandidates.map((c) => tryAddCandidate(connection, c)));\n  state.pendingCandidates = [];\n}\n\nasync function tryAddCandidate(connection: RTCPeerConnection, candidate: string) {\n  try {\n    await connection.addIceCandidate({\n      candidate,\n      sdpMLineIndex: 0,\n    })\n  } catch (err) {\n    console.error(err);\n  }\n}\n\nasync function createOffer(conn: RTCPeerConnection, params: RTCOfferOptions) {\n  const offer = await conn.createOffer(params);\n  await conn.setLocalDescription(offer);\n  sendInitialSetup(parseSdp(conn.localDescription!, true) as P2pParsedSdp);\n}\n","import type { ActionReturnType } from '../../types';\n\nimport { GROUP_CALL_VOLUME_MULTIPLIER } from '../../../config';\nimport {\n  isStreamEnabled,\n  joinGroupCall,\n  leaveGroupCall,\n  setVolume, startSharingScreen,\n  stopPhoneCall,\n  toggleStream,\n} from '../../../lib/secret-sauce';\nimport { getCurrentTabId } from '../../../util/establishMultitabRole';\nimport { callApi } from '../../../api/gramjs';\nimport { addActionHandler, getGlobal, setGlobal } from '../../index';\nimport {\n  removeGroupCall,\n  updateActiveGroupCall,\n} from '../../reducers/calls';\nimport { updateTabState } from '../../reducers/tabs';\nimport { selectChat, selectTabState, selectUser } from '../../selectors';\nimport {\n  selectActiveGroupCall, selectPhoneCallUser,\n} from '../../selectors/calls';\nimport { getGroupCallAudioContext, getGroupCallAudioElement, removeGroupCallAudioElement } from '../ui/calls';\nimport { loadFullChat } from './chats';\n\nconst HANG_UP_UI_DELAY = 500;\n\naddActionHandler('leaveGroupCall', async (global, actions, payload): Promise<void> => {\n  const {\n    isFromLibrary, shouldDiscard, shouldRemove, rejoin,\n    isPageUnload, tabId = getCurrentTabId(),\n  } = payload || {};\n\n  const groupCall = selectActiveGroupCall(global);\n  if (!groupCall) {\n    return;\n  }\n\n  global = updateActiveGroupCall(global, { connectionState: 'disconnected' }, groupCall.participantsCount - 1);\n  global = {\n    ...global,\n    groupCalls: {\n      ...global.groupCalls,\n      activeGroupCallId: undefined,\n    },\n  };\n  setGlobal(global);\n\n  await callApi('leaveGroupCall', {\n    call: groupCall, isPageUnload,\n  });\n  await callApi('abortRequestGroup', 'call');\n\n  if (shouldDiscard) {\n    await callApi('discardGroupCall', {\n      call: groupCall,\n    });\n  }\n\n  global = getGlobal();\n  if (shouldRemove) {\n    global = removeGroupCall(global, groupCall.id);\n  }\n\n  removeGroupCallAudioElement();\n\n  setGlobal(global);\n\n  actions.toggleGroupCallPanel({ force: undefined, tabId });\n\n  if (!isFromLibrary) {\n    leaveGroupCall();\n  }\n\n  actions.afterHangUp();\n\n  if (rejoin) {\n    actions.requestMasterAndJoinGroupCall({\n      ...rejoin,\n      tabId,\n    });\n  }\n});\n\naddActionHandler('toggleGroupCallVideo', async (global): Promise<void> => {\n  const groupCall = selectActiveGroupCall(global);\n  const user = selectUser(global, global.currentUserId!);\n  if (!user || !groupCall) {\n    return;\n  }\n\n  await toggleStream('video');\n\n  await callApi('editGroupCallParticipant', {\n    call: groupCall,\n    videoStopped: !isStreamEnabled('video'),\n    participant: user,\n  });\n});\n\naddActionHandler('requestToSpeak', (global, actions, payload): ActionReturnType => {\n  const { value } = payload || { value: true };\n  const groupCall = selectActiveGroupCall(global);\n  const user = selectUser(global, global.currentUserId!);\n  if (!user || !groupCall) {\n    return;\n  }\n\n  void callApi('editGroupCallParticipant', {\n    call: groupCall,\n    raiseHand: value,\n    participant: user,\n  });\n});\n\naddActionHandler('setGroupCallParticipantVolume', (global, actions, payload): ActionReturnType => {\n  const { participantId, volume } = payload;\n\n  const groupCall = selectActiveGroupCall(global);\n  const user = selectUser(global, participantId);\n  if (!user || !groupCall) {\n    return;\n  }\n\n  setVolume(participantId, Math.floor(volume / GROUP_CALL_VOLUME_MULTIPLIER) / 100);\n\n  void callApi('editGroupCallParticipant', {\n    call: groupCall,\n    volume: Number(volume),\n    participant: user,\n  });\n});\n\naddActionHandler('toggleGroupCallMute', async (global, actions, payload): Promise<void> => {\n  const { participantId, value } = payload || {};\n  const groupCall = selectActiveGroupCall(global);\n  const user = selectUser(global, participantId || global.currentUserId!);\n  if (!user || !groupCall) {\n    return;\n  }\n\n  const muted = value === undefined ? isStreamEnabled('audio', user.id) : value;\n\n  if (!participantId) {\n    await toggleStream('audio');\n  } else {\n    setVolume(participantId, muted ? 0 : 1);\n  }\n\n  await callApi('editGroupCallParticipant', {\n    call: groupCall,\n    muted,\n    participant: user,\n  });\n});\n\naddActionHandler('toggleGroupCallPresentation', async (global, actions, payload): Promise<void> => {\n  const groupCall = selectActiveGroupCall(global);\n  const user = selectUser(global, global.currentUserId!);\n  if (!user || !groupCall) {\n    return;\n  }\n\n  const value = payload?.value !== undefined ? payload?.value : !isStreamEnabled('presentation');\n  if (value) {\n    const params = await startSharingScreen();\n    if (!params) {\n      return;\n    }\n\n    await callApi('joinGroupCallPresentation', {\n      call: groupCall,\n      params,\n    });\n  } else {\n    await toggleStream('presentation', false);\n    await callApi('leaveGroupCallPresentation', {\n      call: groupCall,\n    });\n  }\n\n  await callApi('editGroupCallParticipant', {\n    call: groupCall,\n    presentationPaused: !isStreamEnabled('presentation'),\n    participant: user,\n  });\n});\n\naddActionHandler('connectToActiveGroupCall', async (global, actions, payload): Promise<void> => {\n  const { tabId = getCurrentTabId() } = payload || {};\n  const groupCall = selectActiveGroupCall(global);\n  if (!groupCall) return;\n\n  if (groupCall.connectionState === 'discarded') {\n    actions.showNotification({ message: 'This voice chat is not active', tabId });\n    return;\n  }\n\n  const audioElement = getGroupCallAudioElement();\n  const audioContext = getGroupCallAudioContext();\n\n  if (!audioElement || !audioContext) {\n    return;\n  }\n\n  const {\n    currentUserId,\n  } = global;\n\n  if (!currentUserId) return;\n\n  const params = await joinGroupCall(currentUserId, audioContext, audioElement, actions.apiUpdate);\n\n  const result = await callApi('joinGroupCall', {\n    call: groupCall,\n    params,\n    inviteHash: groupCall.inviteHash,\n  });\n\n  global = getGlobal();\n\n  if (!result) {\n    actions.showNotification({\n      // TODO[lang] Localize error message\n      message: 'Failed to join voice chat',\n      tabId,\n    });\n    actions.leaveGroupCall({ tabId });\n    return;\n  }\n\n  actions.loadMoreGroupCallParticipants();\n\n  if (groupCall.chatId) {\n    global = getGlobal();\n    const chat = selectChat(global, groupCall.chatId);\n    if (!chat) return;\n    await loadFullChat(global, actions, chat);\n  }\n});\n\naddActionHandler('connectToActivePhoneCall', async (global, actions): Promise<void> => {\n  const { phoneCall } = global;\n\n  if (!phoneCall) return;\n\n  const user = selectPhoneCallUser(global);\n\n  if (!user) return;\n\n  const dhConfig = await callApi('getDhConfig');\n\n  if (!dhConfig) return;\n\n  await callApi('createPhoneCallState', [true]);\n\n  const gAHash = await callApi('requestPhoneCall', [dhConfig]);\n\n  const result = await callApi('requestCall', { user, gAHash, isVideo: phoneCall.isVideo });\n\n  if (!result) {\n    if ('hangUp' in actions) actions.hangUp({ tabId: getCurrentTabId() });\n  }\n});\n\naddActionHandler('acceptCall', async (global): Promise<void> => {\n  const { phoneCall } = global;\n\n  if (!phoneCall) return;\n\n  const dhConfig = await callApi('getDhConfig');\n  if (!dhConfig) return;\n\n  await callApi('createPhoneCallState', [false]);\n\n  const gB = await callApi('acceptPhoneCall', [dhConfig]);\n  await callApi('acceptCall', { call: phoneCall, gB });\n});\n\naddActionHandler('sendSignalingData', (global, actions, payload): ActionReturnType => {\n  const { phoneCall } = global;\n  if (!phoneCall) {\n    return;\n  }\n\n  const data = JSON.stringify(payload);\n\n  (async () => {\n    const encodedData = await callApi('encodePhoneCallData', [data]);\n\n    if (!encodedData) return;\n\n    callApi('sendSignalingData', { data: encodedData, call: phoneCall });\n  })();\n});\n\naddActionHandler('closeCallRatingModal', (global, actions, payload): ActionReturnType => {\n  const { tabId = getCurrentTabId() } = payload || {};\n  return updateTabState(global, {\n    ratingPhoneCall: undefined,\n  }, tabId);\n});\n\naddActionHandler('setCallRating', (global, actions, payload): ActionReturnType => {\n  const { rating, comment, tabId = getCurrentTabId() } = payload;\n\n  const { ratingPhoneCall } = selectTabState(global, tabId);\n  if (!ratingPhoneCall) {\n    return undefined;\n  }\n\n  callApi('setCallRating', { call: ratingPhoneCall, rating, comment });\n\n  return updateTabState(global, {\n    ratingPhoneCall: undefined,\n  }, tabId);\n});\n\naddActionHandler('hangUp', (global, actions, payload): ActionReturnType => {\n  const { isPageUnload, tabId = getCurrentTabId() } = payload || {};\n  const { phoneCall } = global;\n\n  if (!phoneCall) return undefined;\n\n  if (phoneCall.state === 'discarded') {\n    callApi('destroyPhoneCallState');\n    stopPhoneCall();\n\n    global = {\n      ...global,\n      phoneCall: undefined,\n    };\n    setGlobal(global);\n    actions.toggleGroupCallPanel({ force: undefined, tabId });\n\n    actions.afterHangUp();\n\n    return undefined;\n  }\n\n  callApi('destroyPhoneCallState');\n  stopPhoneCall();\n  callApi('discardCall', { call: phoneCall, isPageUnload });\n\n  if (phoneCall.state === 'requesting') {\n    global = {\n      ...global,\n      phoneCall: undefined,\n    };\n    setGlobal(global);\n    actions.toggleGroupCallPanel({ force: undefined, tabId });\n\n    actions.afterHangUp();\n\n    return undefined;\n  }\n\n  setTimeout(() => {\n    global = getGlobal();\n    global = {\n      ...global,\n      phoneCall: undefined,\n    };\n    setGlobal(global);\n\n    actions.toggleGroupCallPanel({ force: undefined, tabId });\n    actions.afterHangUp();\n  }, HANG_UP_UI_DELAY);\n\n  return undefined;\n});\n","export const EMOJI_DATA = new Uint16Array([\n  0xd83d, 0xde09, 0xd83d, 0xde0d, 0xd83d, 0xde1b, 0xd83d, 0xde2d, 0xd83d, 0xde31, 0xd83d, 0xde21,\n  0xd83d, 0xde0e, 0xd83d, 0xde34, 0xd83d, 0xde35, 0xd83d, 0xde08, 0xd83d, 0xde2c, 0xd83d, 0xde07,\n  0xd83d, 0xde0f, 0xd83d, 0xdc6e, 0xd83d, 0xdc77, 0xd83d, 0xdc82, 0xd83d, 0xdc76, 0xd83d, 0xdc68,\n  0xd83d, 0xdc69, 0xd83d, 0xdc74, 0xd83d, 0xdc75, 0xd83d, 0xde3b, 0xd83d, 0xde3d, 0xd83d, 0xde40,\n  0xd83d, 0xdc7a, 0xd83d, 0xde48, 0xd83d, 0xde49, 0xd83d, 0xde4a, 0xd83d, 0xdc80, 0xd83d, 0xdc7d,\n  0xd83d, 0xdca9, 0xd83d, 0xdd25, 0xd83d, 0xdca5, 0xd83d, 0xdca4, 0xd83d, 0xdc42, 0xd83d, 0xdc40,\n  0xd83d, 0xdc43, 0xd83d, 0xdc45, 0xd83d, 0xdc44, 0xd83d, 0xdc4d, 0xd83d, 0xdc4e, 0xd83d, 0xdc4c,\n  0xd83d, 0xdc4a, 0x270c, 0x270b, 0xd83d, 0xdc50, 0xd83d, 0xdc46, 0xd83d, 0xdc47, 0xd83d, 0xdc49,\n  0xd83d, 0xdc48, 0xd83d, 0xde4f, 0xd83d, 0xdc4f, 0xd83d, 0xdcaa, 0xd83d, 0xdeb6, 0xd83c, 0xdfc3,\n  0xd83d, 0xdc83, 0xd83d, 0xdc6b, 0xd83d, 0xdc6a, 0xd83d, 0xdc6c, 0xd83d, 0xdc6d, 0xd83d, 0xdc85,\n  0xd83c, 0xdfa9, 0xd83d, 0xdc51, 0xd83d, 0xdc52, 0xd83d, 0xdc5f, 0xd83d, 0xdc5e, 0xd83d, 0xdc60,\n  0xd83d, 0xdc55, 0xd83d, 0xdc57, 0xd83d, 0xdc56, 0xd83d, 0xdc59, 0xd83d, 0xdc5c, 0xd83d, 0xdc53,\n  0xd83c, 0xdf80, 0xd83d, 0xdc84, 0xd83d, 0xdc9b, 0xd83d, 0xdc99, 0xd83d, 0xdc9c, 0xd83d, 0xdc9a,\n  0xd83d, 0xdc8d, 0xd83d, 0xdc8e, 0xd83d, 0xdc36, 0xd83d, 0xdc3a, 0xd83d, 0xdc31, 0xd83d, 0xdc2d,\n  0xd83d, 0xdc39, 0xd83d, 0xdc30, 0xd83d, 0xdc38, 0xd83d, 0xdc2f, 0xd83d, 0xdc28, 0xd83d, 0xdc3b,\n  0xd83d, 0xdc37, 0xd83d, 0xdc2e, 0xd83d, 0xdc17, 0xd83d, 0xdc34, 0xd83d, 0xdc11, 0xd83d, 0xdc18,\n  0xd83d, 0xdc3c, 0xd83d, 0xdc27, 0xd83d, 0xdc25, 0xd83d, 0xdc14, 0xd83d, 0xdc0d, 0xd83d, 0xdc22,\n  0xd83d, 0xdc1b, 0xd83d, 0xdc1d, 0xd83d, 0xdc1c, 0xd83d, 0xdc1e, 0xd83d, 0xdc0c, 0xd83d, 0xdc19,\n  0xd83d, 0xdc1a, 0xd83d, 0xdc1f, 0xd83d, 0xdc2c, 0xd83d, 0xdc0b, 0xd83d, 0xdc10, 0xd83d, 0xdc0a,\n  0xd83d, 0xdc2b, 0xd83c, 0xdf40, 0xd83c, 0xdf39, 0xd83c, 0xdf3b, 0xd83c, 0xdf41, 0xd83c, 0xdf3e,\n  0xd83c, 0xdf44, 0xd83c, 0xdf35, 0xd83c, 0xdf34, 0xd83c, 0xdf33, 0xd83c, 0xdf1e, 0xd83c, 0xdf1a,\n  0xd83c, 0xdf19, 0xd83c, 0xdf0e, 0xd83c, 0xdf0b, 0x26a1, 0x2614, 0x2744, 0x26c4, 0xd83c, 0xdf00,\n  0xd83c, 0xdf08, 0xd83c, 0xdf0a, 0xd83c, 0xdf93, 0xd83c, 0xdf86, 0xd83c, 0xdf83, 0xd83d, 0xdc7b,\n  0xd83c, 0xdf85, 0xd83c, 0xdf84, 0xd83c, 0xdf81, 0xd83c, 0xdf88, 0xd83d, 0xdd2e, 0xd83c, 0xdfa5,\n  0xd83d, 0xdcf7, 0xd83d, 0xdcbf, 0xd83d, 0xdcbb, 0x260e, 0xd83d, 0xdce1, 0xd83d, 0xdcfa, 0xd83d,\n  0xdcfb, 0xd83d, 0xdd09, 0xd83d, 0xdd14, 0x23f3, 0x23f0, 0x231a, 0xd83d, 0xdd12, 0xd83d, 0xdd11,\n  0xd83d, 0xdd0e, 0xd83d, 0xdca1, 0xd83d, 0xdd26, 0xd83d, 0xdd0c, 0xd83d, 0xdd0b, 0xd83d, 0xdebf,\n  0xd83d, 0xdebd, 0xd83d, 0xdd27, 0xd83d, 0xdd28, 0xd83d, 0xdeaa, 0xd83d, 0xdeac, 0xd83d, 0xdca3,\n  0xd83d, 0xdd2b, 0xd83d, 0xdd2a, 0xd83d, 0xdc8a, 0xd83d, 0xdc89, 0xd83d, 0xdcb0, 0xd83d, 0xdcb5,\n  0xd83d, 0xdcb3, 0x2709, 0xd83d, 0xdceb, 0xd83d, 0xdce6, 0xd83d, 0xdcc5, 0xd83d, 0xdcc1, 0x2702,\n  0xd83d, 0xdccc, 0xd83d, 0xdcce, 0x2712, 0x270f, 0xd83d, 0xdcd0, 0xd83d, 0xdcda, 0xd83d, 0xdd2c,\n  0xd83d, 0xdd2d, 0xd83c, 0xdfa8, 0xd83c, 0xdfac, 0xd83c, 0xdfa4, 0xd83c, 0xdfa7, 0xd83c, 0xdfb5,\n  0xd83c, 0xdfb9, 0xd83c, 0xdfbb, 0xd83c, 0xdfba, 0xd83c, 0xdfb8, 0xd83d, 0xdc7e, 0xd83c, 0xdfae,\n  0xd83c, 0xdccf, 0xd83c, 0xdfb2, 0xd83c, 0xdfaf, 0xd83c, 0xdfc8, 0xd83c, 0xdfc0, 0x26bd, 0x26be,\n  0xd83c, 0xdfbe, 0xd83c, 0xdfb1, 0xd83c, 0xdfc9, 0xd83c, 0xdfb3, 0xd83c, 0xdfc1, 0xd83c, 0xdfc7,\n  0xd83c, 0xdfc6, 0xd83c, 0xdfca, 0xd83c, 0xdfc4, 0x2615, 0xd83c, 0xdf7c, 0xd83c, 0xdf7a, 0xd83c,\n  0xdf77, 0xd83c, 0xdf74, 0xd83c, 0xdf55, 0xd83c, 0xdf54, 0xd83c, 0xdf5f, 0xd83c, 0xdf57, 0xd83c,\n  0xdf71, 0xd83c, 0xdf5a, 0xd83c, 0xdf5c, 0xd83c, 0xdf61, 0xd83c, 0xdf73, 0xd83c, 0xdf5e, 0xd83c,\n  0xdf69, 0xd83c, 0xdf66, 0xd83c, 0xdf82, 0xd83c, 0xdf70, 0xd83c, 0xdf6a, 0xd83c, 0xdf6b, 0xd83c,\n  0xdf6d, 0xd83c, 0xdf6f, 0xd83c, 0xdf4e, 0xd83c, 0xdf4f, 0xd83c, 0xdf4a, 0xd83c, 0xdf4b, 0xd83c,\n  0xdf52, 0xd83c, 0xdf47, 0xd83c, 0xdf49, 0xd83c, 0xdf53, 0xd83c, 0xdf51, 0xd83c, 0xdf4c, 0xd83c,\n  0xdf50, 0xd83c, 0xdf4d, 0xd83c, 0xdf46, 0xd83c, 0xdf45, 0xd83c, 0xdf3d, 0xd83c, 0xdfe1, 0xd83c,\n  0xdfe5, 0xd83c, 0xdfe6, 0x26ea, 0xd83c, 0xdff0, 0x26fa, 0xd83c, 0xdfed, 0xd83d, 0xddfb, 0xd83d,\n  0xddfd, 0xd83c, 0xdfa0, 0xd83c, 0xdfa1, 0x26f2, 0xd83c, 0xdfa2, 0xd83d, 0xdea2, 0xd83d, 0xdea4,\n  0x2693, 0xd83d, 0xde80, 0x2708, 0xd83d, 0xde81, 0xd83d, 0xde82, 0xd83d, 0xde8b, 0xd83d, 0xde8e,\n  0xd83d, 0xde8c, 0xd83d, 0xde99, 0xd83d, 0xde97, 0xd83d, 0xde95, 0xd83d, 0xde9b, 0xd83d, 0xdea8,\n  0xd83d, 0xde94, 0xd83d, 0xde92, 0xd83d, 0xde91, 0xd83d, 0xdeb2, 0xd83d, 0xdea0, 0xd83d, 0xde9c,\n  0xd83d, 0xdea6, 0x26a0, 0xd83d, 0xdea7, 0x26fd, 0xd83c, 0xdfb0, 0xd83d, 0xddff, 0xd83c, 0xdfaa,\n  0xd83c, 0xdfad, 0xd83c, 0xddef, 0xd83c, 0xddf5, 0xd83c, 0xddf0, 0xd83c, 0xddf7, 0xd83c, 0xdde9,\n  0xd83c, 0xddea, 0xd83c, 0xdde8, 0xd83c, 0xddf3, 0xd83c, 0xddfa, 0xd83c, 0xddf8, 0xd83c, 0xddeb,\n  0xd83c, 0xddf7, 0xd83c, 0xddea, 0xd83c, 0xddf8, 0xd83c, 0xddee, 0xd83c, 0xddf9, 0xd83c, 0xddf7,\n  0xd83c, 0xddfa, 0xd83c, 0xddec, 0xd83c, 0xdde7, 0x0031, 0x20e3, 0x0032, 0x20e3, 0x0033, 0x20e3,\n  0x0034, 0x20e3, 0x0035, 0x20e3, 0x0036, 0x20e3, 0x0037, 0x20e3, 0x0038, 0x20e3, 0x0039, 0x20e3,\n  0x0030, 0x20e3, 0xd83d, 0xdd1f, 0x2757, 0x2753, 0x2665, 0x2666, 0xd83d, 0xdcaf, 0xd83d, 0xdd17,\n  0xd83d, 0xdd31, 0xd83d, 0xdd34, 0xd83d, 0xdd35, 0xd83d, 0xdd36, 0xd83d, 0xdd37,\n]);\n\nexport const EMOJI_OFFSETS = [\n  0, 2, 4, 6, 8, 10, 12, 14, 16, 18, 20, 22,\n  24, 26, 28, 30, 32, 34, 36, 38, 40, 42, 44, 46,\n  48, 50, 52, 54, 56, 58, 60, 62, 64, 66, 68, 70,\n  72, 74, 76, 78, 80, 82, 84, 86, 87, 88, 90, 92,\n  94, 96, 98, 100, 102, 104, 106, 108, 110, 112, 114, 116,\n  118, 120, 122, 124, 126, 128, 130, 132, 134, 136, 138, 140,\n  142, 144, 146, 148, 150, 152, 154, 156, 158, 160, 162, 164,\n  166, 168, 170, 172, 174, 176, 178, 180, 182, 184, 186, 188,\n  190, 192, 194, 196, 198, 200, 202, 204, 206, 208, 210, 212,\n  214, 216, 218, 220, 222, 224, 226, 228, 230, 232, 234, 236,\n  238, 240, 242, 244, 246, 248, 250, 252, 254, 256, 258, 259,\n  260, 261, 262, 264, 266, 268, 270, 272, 274, 276, 278, 280,\n  282, 284, 286, 288, 290, 292, 294, 295, 297, 299, 301, 303,\n  305, 306, 307, 308, 310, 312, 314, 316, 318, 320, 322, 324,\n  326, 328, 330, 332, 334, 336, 338, 340, 342, 344, 346, 348,\n  350, 351, 353, 355, 357, 359, 360, 362, 364, 365, 366, 368,\n  370, 372, 374, 376, 378, 380, 382, 384, 386, 388, 390, 392,\n  394, 396, 398, 400, 402, 404, 406, 407, 408, 410, 412, 414,\n  416, 418, 420, 422, 424, 426, 427, 429, 431, 433, 435, 437,\n  439, 441, 443, 445, 447, 449, 451, 453, 455, 457, 459, 461,\n  463, 465, 467, 469, 471, 473, 475, 477, 479, 481, 483, 485,\n  487, 489, 491, 493, 495, 497, 499, 501, 503, 505, 507, 508,\n  510, 511, 513, 515, 517, 519, 521, 522, 524, 526, 528, 529,\n  531, 532, 534, 536, 538, 540, 542, 544, 546, 548, 550, 552,\n  554, 556, 558, 560, 562, 564, 566, 567, 569, 570, 572, 574,\n  576, 578, 582, 586, 590, 594, 598, 602, 606, 610, 614, 618,\n  620, 622, 624, 626, 628, 630, 632, 634, 636, 638, 640, 641,\n  642, 643, 644, 646, 648, 650, 652, 654, 656, 658,\n];\n","import type { ApiPhoneCall } from '../../../api/types';\nimport type { ApiCallProtocol } from '../../../lib/secret-sauce';\nimport type { ActionReturnType } from '../../types';\n\nimport {\n  handleUpdateGroupCallConnection,\n  handleUpdateGroupCallParticipants,\n  joinPhoneCall, processSignalingMessage,\n} from '../../../lib/secret-sauce';\nimport { ARE_CALLS_SUPPORTED } from '../../../util/browser/windowEnvironment';\nimport { getCurrentTabId } from '../../../util/establishMultitabRole';\nimport { omit } from '../../../util/iteratees';\nimport * as langProvider from '../../../util/oldLangProvider';\nimport { EMOJI_DATA, EMOJI_OFFSETS } from '../../../util/phoneCallEmojiConstants';\nimport { callApi } from '../../../api/gramjs';\nimport { addActionHandler, getGlobal, setGlobal } from '../../index';\nimport { updateGroupCall, updateGroupCallParticipant } from '../../reducers/calls';\nimport { updateTabState } from '../../reducers/tabs';\nimport { selectActiveGroupCall, selectGroupCallParticipant, selectPhoneCallUser } from '../../selectors/calls';\n\naddActionHandler('apiUpdate', (global, actions, update): ActionReturnType => {\n  const { activeGroupCallId } = global.groupCalls;\n\n  switch (update['@type']) {\n    case 'updateGroupCallLeavePresentation': {\n      actions.toggleGroupCallPresentation({ value: false });\n      break;\n    }\n    case 'updateGroupCallStreams': {\n      if (!update.userId || !activeGroupCallId) break;\n      if (!selectGroupCallParticipant(global, activeGroupCallId, update.userId)) break;\n\n      return updateGroupCallParticipant(global, activeGroupCallId, update.userId, omit(update, ['@type', 'userId']));\n    }\n    case 'updateGroupCallConnectionState': {\n      if (!activeGroupCallId) break;\n\n      if (update.connectionState === 'disconnected') {\n        if ('leaveGroupCall' in actions) actions.leaveGroupCall({ isFromLibrary: true, tabId: getCurrentTabId() });\n        break;\n      }\n\n      return updateGroupCall(global, activeGroupCallId, {\n        connectionState: update.connectionState,\n        isSpeakerDisabled: update.isSpeakerDisabled,\n      });\n    }\n    case 'updateGroupCallParticipants': {\n      const { groupCallId, participants } = update;\n      if (activeGroupCallId === groupCallId) {\n        void handleUpdateGroupCallParticipants(participants);\n      }\n      break;\n    }\n    case 'updateGroupCallConnection': {\n      if (update.data.stream) {\n        actions.showNotification({ message: 'Big live streams are not yet supported', tabId: getCurrentTabId() });\n        if ('leaveGroupCall' in actions) actions.leaveGroupCall({ tabId: getCurrentTabId() });\n        break;\n      }\n      void handleUpdateGroupCallConnection(update.data, update.presentation);\n\n      const groupCall = selectActiveGroupCall(global);\n      if (groupCall?.participants && Object.keys(groupCall.participants).length > 0) {\n        void handleUpdateGroupCallParticipants(Object.values(groupCall.participants));\n      }\n      break;\n    }\n    case 'updatePhoneCallMediaState':\n      return {\n        ...global,\n        phoneCall: {\n          ...global.phoneCall,\n          ...omit(update, ['@type']),\n        } as ApiPhoneCall,\n      };\n    case 'updatePhoneCall': {\n      if (!ARE_CALLS_SUPPORTED) return undefined;\n      const { phoneCall, currentUserId } = global;\n\n      const call: ApiPhoneCall = {\n        ...phoneCall,\n        ...update.call,\n      };\n\n      const isOutgoing = phoneCall?.adminId === currentUserId;\n\n      global = {\n        ...global,\n        phoneCall: call,\n      };\n      setGlobal(global);\n      global = getGlobal();\n\n      if (phoneCall && phoneCall.id && call.id !== phoneCall.id) {\n        if (call.state !== 'discarded') {\n          callApi('discardCall', {\n            call,\n            isBusy: true,\n          });\n        }\n        return undefined;\n      }\n\n      const {\n        accessHash, state, connections, gB,\n      } = call;\n\n      if (state === 'active' || state === 'accepted') {\n        if (!verifyPhoneCallProtocol(call.protocol)) {\n          const user = selectPhoneCallUser(global);\n          if ('hangUp' in actions) actions.hangUp({ tabId: getCurrentTabId() });\n          actions.showNotification({\n            message: langProvider.oldTranslate('VoipPeerIncompatible', user?.firstName),\n            tabId: getCurrentTabId(),\n          });\n          return undefined;\n        }\n      }\n\n      if (state === 'discarded') {\n        // Discarded from other device\n        if (!phoneCall) return undefined;\n\n        return updateTabState(global, {\n          ...(call.needRating && { ratingPhoneCall: call }),\n          isCallPanelVisible: undefined,\n        }, getCurrentTabId());\n      } else if (state === 'accepted' && accessHash && gB) {\n        (async () => {\n          const { gA, keyFingerprint, emojis } = await callApi('confirmPhoneCall', [gB, EMOJI_DATA, EMOJI_OFFSETS]);\n\n          global = getGlobal();\n          const newCall = {\n            ...global.phoneCall,\n            emojis,\n          } as ApiPhoneCall;\n\n          global = {\n            ...global,\n            phoneCall: newCall,\n          };\n          setGlobal(global);\n\n          callApi('confirmCall', {\n            call, gA, keyFingerprint,\n          });\n        })();\n      } else if (state === 'active' && connections && phoneCall?.state !== 'active') {\n        if (!isOutgoing) {\n          callApi('receivedCall', { call });\n          (async () => {\n            const { emojis } = await callApi('confirmPhoneCall', [call.gAOrB!, EMOJI_DATA, EMOJI_OFFSETS]);\n\n            global = getGlobal();\n            const newCall = {\n              ...global.phoneCall,\n              emojis,\n            } as ApiPhoneCall;\n\n            global = {\n              ...global,\n              phoneCall: newCall,\n            };\n            setGlobal(global);\n          })();\n        }\n        void joinPhoneCall(\n          connections,\n          actions.sendSignalingData,\n          isOutgoing,\n          Boolean(call?.isVideo),\n          Boolean(call.isP2pAllowed),\n          actions.apiUpdate,\n        );\n      }\n\n      return global;\n    }\n    case 'updatePhoneCallConnectionState': {\n      const { connectionState } = update;\n\n      if (!global.phoneCall) return global;\n\n      if (connectionState === 'closed' || connectionState === 'disconnected' || connectionState === 'failed') {\n        if ('hangUp' in actions) actions.hangUp({ tabId: getCurrentTabId() });\n        return undefined;\n      }\n\n      return {\n        ...global,\n        phoneCall: {\n          ...global.phoneCall,\n          isConnected: connectionState === 'connected',\n        },\n      };\n    }\n    case 'updatePhoneCallSignalingData': {\n      const { phoneCall } = global;\n\n      if (!phoneCall) {\n        break;\n      }\n\n      callApi('decodePhoneCallData', [update.data])?.then(processSignalingMessage);\n      break;\n    }\n  }\n\n  return undefined;\n});\n\nfunction verifyPhoneCallProtocol(protocol?: ApiCallProtocol) {\n  return protocol?.libraryVersions.some((version) => {\n    return version === '4.0.0' || version === '4.0.1';\n  });\n}\n","import type { GroupCallParticipant } from '../../../../lib/secret-sauce';\n\nimport { GROUP_CALL_DEFAULT_VOLUME, GROUP_CALL_VOLUME_MULTIPLIER } from '../../../../config';\n\nexport default function formatGroupCallVolume(participant: GroupCallParticipant) {\n  return Math.floor((participant.volume || GROUP_CALL_DEFAULT_VOLUME) / GROUP_CALL_VOLUME_MULTIPLIER).toString();\n}\n","import type { ElementRef, FC } from '../../../lib/teact/teact';\nimport type React from '../../../lib/teact/teact';\nimport { memo, useEffect, useState } from '../../../lib/teact/teact';\nimport { getActions, withGlobal } from '../../../global';\n\nimport type { GroupCallParticipant } from '../../../lib/secret-sauce';\nimport type { MenuPositionOptions } from '../../ui/Menu';\n\nimport { GROUP_CALL_DEFAULT_VOLUME, GROUP_CALL_VOLUME_MULTIPLIER } from '../../../config';\nimport { selectIsAdminInActiveGroupCall } from '../../../global/selectors/calls';\nimport buildClassName from '../../../util/buildClassName';\nimport { LOCAL_TGS_URLS } from '../../common/helpers/animatedAssets';\n\nimport useFlag from '../../../hooks/useFlag';\nimport useLastCallback from '../../../hooks/useLastCallback';\nimport useOldLang from '../../../hooks/useOldLang';\nimport useRunThrottled from '../../../hooks/useRunThrottled';\n\nimport AnimatedIcon from '../../common/AnimatedIcon';\nimport DeleteMemberModal from '../../right/DeleteMemberModal';\nimport Menu from '../../ui/Menu';\nimport MenuItem from '../../ui/MenuItem';\n\nimport './GroupCallParticipantMenu.scss';\n\nconst SPEAKER_ICON_DISABLED_SEGMENT: [number, number] = [0, 17];\nconst SPEAKER_ICON_ENABLED_SEGMENT: [number, number] = [17, 34];\n\ntype OwnProps =\n  {\n    participant?: GroupCallParticipant;\n    onCloseAnimationEnd: VoidFunction;\n    onClose: VoidFunction;\n    isDropdownOpen: boolean;\n    menuRef?: ElementRef<HTMLDivElement>;\n  }\n  & MenuPositionOptions;\n\ntype StateProps = {\n  isAdmin: boolean;\n};\n\nconst VOLUME_ZERO = 0;\nconst VOLUME_LOW = 50;\nconst VOLUME_MEDIUM = 100;\nconst VOLUME_NORMAL = 150;\n\nconst VOLUME_CHANGE_THROTTLE = 500;\n\nconst SPEAKER_ICON_SIZE = 24;\n\nconst GroupCallParticipantMenu: FC<OwnProps & StateProps> = ({\n  participant,\n  onCloseAnimationEnd,\n  onClose,\n  isDropdownOpen,\n  isAdmin,\n  menuRef,\n  ...menuPositionOptions\n}) => {\n  const {\n    toggleGroupCallMute,\n    setGroupCallParticipantVolume,\n    toggleGroupCallPanel,\n    openChat,\n    requestToSpeak,\n  } = getActions();\n\n  const lang = useOldLang();\n  const [isDeleteUserModalOpen, openDeleteUserModal, closeDeleteUserModal] = useFlag();\n\n  const id = participant?.id;\n  const {\n    isMutedByMe, isMuted, isSelf, canSelfUnmute,\n  } = participant || {};\n  const isRaiseHand = Boolean(participant?.raiseHandRating);\n  const shouldRaiseHand = !canSelfUnmute && isMuted;\n\n  const [localVolume, setLocalVolume] = useState(\n    isMutedByMe ? VOLUME_ZERO : ((participant?.volume || GROUP_CALL_DEFAULT_VOLUME) / GROUP_CALL_VOLUME_MULTIPLIER),\n  );\n\n  const [shouldPlay, setShouldPlay] = useState(false);\n\n  const isLocalVolumeZero = localVolume === VOLUME_ZERO;\n  const speakerIconPlaySegment = isLocalVolumeZero ? SPEAKER_ICON_DISABLED_SEGMENT : SPEAKER_ICON_ENABLED_SEGMENT;\n\n  useEffect(() => {\n    if (isDropdownOpen) return;\n    setShouldPlay(false);\n  }, [isDropdownOpen]);\n\n  const handleSetLocalVolume = useLastCallback((volume: number) => {\n    setLocalVolume(volume);\n    const isNewLocalVolumeZero = volume === VOLUME_ZERO;\n    setShouldPlay(isNewLocalVolumeZero !== isLocalVolumeZero);\n  });\n\n  useEffect(() => {\n    setLocalVolume(isMutedByMe\n      ? VOLUME_ZERO\n      : ((participant?.volume || GROUP_CALL_DEFAULT_VOLUME) / GROUP_CALL_VOLUME_MULTIPLIER));\n    // We only want to initialize local volume when switching participants and ignore following updates from server\n    // eslint-disable-next-line react-hooks-static-deps/exhaustive-deps\n  }, [id]);\n\n  const runThrottled = useRunThrottled(VOLUME_CHANGE_THROTTLE);\n\n  const handleRemove = useLastCallback((e: React.SyntheticEvent<any>) => {\n    e.stopPropagation();\n    openDeleteUserModal();\n    onClose();\n  });\n\n  const handleCancelRequestToSpeak = useLastCallback((e: React.SyntheticEvent<any>) => {\n    e.stopPropagation();\n    requestToSpeak({\n      value: false,\n    });\n    onClose();\n  });\n\n  const handleMute = useLastCallback((e: React.SyntheticEvent<any>) => {\n    e.stopPropagation();\n    onClose();\n\n    if (!isAdmin) {\n      handleSetLocalVolume(isMutedByMe ? GROUP_CALL_DEFAULT_VOLUME / GROUP_CALL_VOLUME_MULTIPLIER : VOLUME_ZERO);\n    } else if (shouldRaiseHand) {\n      handleSetLocalVolume((participant?.volume ?? GROUP_CALL_DEFAULT_VOLUME) / GROUP_CALL_VOLUME_MULTIPLIER);\n    }\n\n    toggleGroupCallMute({\n      participantId: id!,\n      value: isAdmin ? !shouldRaiseHand : !isMutedByMe,\n    });\n  });\n\n  const handleOpenProfile = useLastCallback((e: React.SyntheticEvent<any>) => {\n    e.stopPropagation();\n    toggleGroupCallPanel();\n    openChat({\n      id,\n    });\n    onClose();\n  });\n\n  const handleChangeVolume = (e: React.ChangeEvent<HTMLInputElement>) => {\n    const value = Number(e.target.value);\n    handleSetLocalVolume(value);\n\n    runThrottled(() => {\n      if (value === VOLUME_ZERO) {\n        toggleGroupCallMute({\n          participantId: id!,\n          value: true,\n        });\n      } else {\n        setGroupCallParticipantVolume({\n          participantId: id!,\n          volume: Math.floor(value * GROUP_CALL_VOLUME_MULTIPLIER),\n        });\n      }\n    });\n  };\n\n  return (\n    <div>\n      <Menu\n        isOpen={isDropdownOpen}\n        ref={menuRef}\n        withPortal\n        onClose={onClose}\n        onCloseAnimationEnd={onCloseAnimationEnd}\n        className=\"participant-menu with-menu-transitions\"\n\n        {...menuPositionOptions}\n      >\n        {!isSelf && !shouldRaiseHand && (\n          <div className=\"group\">\n            <div className={buildClassName(\n              'volume-control',\n              localVolume < VOLUME_LOW && 'low',\n              localVolume >= VOLUME_LOW && localVolume < VOLUME_MEDIUM && 'medium',\n              localVolume >= VOLUME_MEDIUM && localVolume < VOLUME_NORMAL && 'normal',\n              localVolume >= VOLUME_NORMAL && 'high',\n            )}\n            >\n              <input\n                type=\"range\"\n                min=\"0\"\n                max=\"200\"\n                value={localVolume}\n                onChange={handleChangeVolume}\n              />\n              <div className=\"info\">\n                <AnimatedIcon\n                  tgsUrl={LOCAL_TGS_URLS.Speaker}\n                  play={shouldPlay ? speakerIconPlaySegment.toString() : false}\n                  playSegment={speakerIconPlaySegment}\n                  size={SPEAKER_ICON_SIZE}\n                />\n                <span>\n                  {localVolume}\n                  %\n                </span>\n              </div>\n            </div>\n          </div>\n        )}\n        <div className=\"group\">\n          {(isRaiseHand && isSelf) && (\n            <MenuItem\n              icon=\"stop-raising-hand\"\n              onClick={handleCancelRequestToSpeak}\n            >\n              {lang('VoipGroupCancelRaiseHand')}\n            </MenuItem>\n          )}\n          {!isSelf && <MenuItem icon=\"user\" onClick={handleOpenProfile}>{lang('VoipGroupOpenProfile')}</MenuItem>}\n          {!isSelf && (\n            // TODO cross mic\n            <MenuItem\n              icon={isMuted ? (isAdmin && shouldRaiseHand ? 'allow-speak' : 'microphone-alt') : 'microphone-alt'}\n              onClick={handleMute}\n            >\n              {isAdmin\n                ? lang(shouldRaiseHand ? 'VoipGroupAllowToSpeak' : 'VoipMute')\n                : lang(isMutedByMe ? 'VoipGroupUnmuteForMe' : 'VoipGroupMuteForMe')}\n            </MenuItem>\n          )}\n          {!isSelf && isAdmin && (\n            // TODO replace with hand\n            <MenuItem icon=\"delete-user\" destructive onClick={handleRemove}>\n              {lang('VoipGroupUserRemove')}\n            </MenuItem>\n          )}\n        </div>\n      </Menu>\n\n      {!isSelf && isAdmin && (\n        <DeleteMemberModal\n          isOpen={isDeleteUserModalOpen}\n          userId={id}\n          onClose={closeDeleteUserModal}\n        />\n      )}\n    </div>\n  );\n};\n\nexport default memo(withGlobal<OwnProps>(\n  (global): Complete<StateProps> => {\n    return {\n      isAdmin: selectIsAdminInActiveGroupCall(global),\n    };\n  },\n)(GroupCallParticipantMenu));\n","import useThrottledCallback from './useThrottledCallback';\n\nexport default function useRunThrottled(ms: number, noFirst?: boolean, deps: any = []) {\n  return useThrottledCallback((cb: NoneToVoidFunction) => {\n    cb();\n    // eslint-disable-next-line react-hooks-static-deps/exhaustive-deps\n  }, deps, ms, noFirst);\n}\n","import type { FC } from '../../../lib/teact/teact';\nimport { memo, useMemo } from '../../../lib/teact/teact';\n\nimport type { GroupCallParticipant } from '../../../lib/secret-sauce';\n\nimport { THRESHOLD } from '../../../lib/secret-sauce';\nimport { LOCAL_TGS_URLS } from '../../common/helpers/animatedAssets';\n\nimport usePreviousDeprecated from '../../../hooks/usePreviousDeprecated';\n\nimport AnimatedIcon from '../../common/AnimatedIcon';\n\ntype OwnProps = {\n  participant: GroupCallParticipant;\n  noColor?: boolean;\n  className?: string;\n};\n\nconst OutlinedMicrophoneIcon: FC<OwnProps> = ({\n  participant,\n  noColor,\n  className,\n}) => {\n  const { isMuted, isMutedByMe } = participant;\n  const isSpeaking = (participant.amplitude || 0) > THRESHOLD;\n  const isRaiseHand = Boolean(participant.raiseHandRating);\n  const prevIsRaiseHand = usePreviousDeprecated(isRaiseHand);\n  const canSelfUnmute = Boolean(participant?.canSelfUnmute);\n  const shouldRaiseHand = !canSelfUnmute && isMuted;\n  const prevIsMuted = usePreviousDeprecated(isMuted);\n\n  const playSegment: [number, number] = useMemo(() => {\n    if (isMuted && !prevIsMuted) {\n      return [43, 64];\n    }\n\n    if (!isMuted && prevIsMuted) {\n      return [22, 42];\n    }\n\n    if (isRaiseHand && !prevIsRaiseHand) {\n      return [65, 84];\n    }\n\n    if (!shouldRaiseHand && prevIsRaiseHand) {\n      return [0, 21];\n    }\n\n    // TODO cancel request to speak should play in reverse\n    // if (!isRaiseHand && prevIsRaiseHand) {\n    //   return [84, 65];\n    // }\n\n    return isMuted ? [22, 23] : [43, 44];\n    // eslint-disable-next-line\n  }, [isMuted, shouldRaiseHand, isRaiseHand]);\n\n  const microphoneColor: string = useMemo(() => {\n    if (noColor) {\n      return '#ffffff';\n    }\n\n    if (isRaiseHand) {\n      return '#4da6e0';\n    }\n\n    if (shouldRaiseHand || isMutedByMe) {\n      return '#ff706f';\n    }\n\n    if (isSpeaking) {\n      return '#57bc6c';\n    }\n\n    return '#aaaaaa';\n  }, [noColor, isRaiseHand, shouldRaiseHand, isMutedByMe, isSpeaking]);\n\n  return (\n    <AnimatedIcon\n      tgsUrl={LOCAL_TGS_URLS.VoiceOutlined}\n      play={playSegment.toString()}\n      playSegment={playSegment}\n      size={28}\n      color={microphoneColor}\n      className={className}\n      forceAlways\n      nonInteractive\n    />\n  );\n};\n\nexport default memo(OutlinedMicrophoneIcon);\n","// extracted by mini-css-extract-plugin\nexport default {\"root\":\"Wk7JwPx3\",\"subtitle\":\"ShcCNemD\",\"subtitleText\":\"UZLgp2cx\",\"icon\":\"vRc6jhKf\",\"subtitleBlue\":\"yA7bxEWw\",\"subtitleRed\":\"DnuZwImI\",\"subtitleGreen\":\"BkgYQGFq\",\"avatar\":\"ouHUJ9ff\"};","import type { FC } from '../../../lib/teact/teact';\nimport {\n  memo, useCallback, useMemo, useRef,\n} from '../../../lib/teact/teact';\nimport { withGlobal } from '../../../global';\n\nimport type { ApiPeer } from '../../../api/types';\nimport type { GroupCallParticipant as TypeGroupCallParticipant } from '../../../lib/secret-sauce';\n\nimport { GROUP_CALL_DEFAULT_VOLUME } from '../../../config';\nimport { THRESHOLD } from '../../../lib/secret-sauce';\nimport { selectChat, selectUser } from '../../../global/selectors';\nimport buildClassName from '../../../util/buildClassName';\nimport renderText from '../../common/helpers/renderText';\nimport formatGroupCallVolume from './helpers/formatGroupCallVolume';\n\nimport useContextMenuHandlers from '../../../hooks/useContextMenuHandlers';\nimport useOldLang from '../../../hooks/useOldLang';\n\nimport Avatar from '../../common/Avatar';\nimport FullNameTitle from '../../common/FullNameTitle';\nimport Icon from '../../common/icons/Icon';\nimport ListItem from '../../ui/ListItem';\nimport GroupCallParticipantMenu from './GroupCallParticipantMenu';\nimport OutlinedMicrophoneIcon from './OutlinedMicrophoneIcon';\n\nimport styles from './GroupCallParticipant.module.scss';\n\ntype OwnProps = {\n  participant: TypeGroupCallParticipant;\n};\n\ntype StateProps = {\n  peer?: ApiPeer;\n};\n\nconst GroupCallParticipant: FC<OwnProps & StateProps> = ({\n  participant,\n  peer,\n}) => {\n  const ref = useRef<HTMLDivElement>();\n  const menuRef = useRef<HTMLDivElement>();\n  const lang = useOldLang();\n\n  const {\n    isSelf, isMutedByMe, isMuted, hasVideoStream, hasPresentationStream,\n  } = participant;\n  const isSpeaking = (participant.amplitude || 0) > THRESHOLD;\n  const isRaiseHand = Boolean(participant.raiseHandRating);\n\n  const {\n    isContextMenuOpen,\n    contextMenuAnchor,\n    handleContextMenu,\n    handleBeforeContextMenu,\n    handleContextMenuClose,\n    handleContextMenuHide,\n  } = useContextMenuHandlers(ref, isSelf);\n\n  const getTriggerElement = useCallback(() => ref.current, []);\n\n  const getRootElement = useCallback(\n    () => ref.current!.closest('.custom-scroll, .no-scrollbar'),\n    [],\n  );\n\n  const getMenuElement = useCallback(\n    () => menuRef.current!,\n    [],\n  );\n\n  const getLayout = useCallback(\n    () => ({ withPortal: true }),\n    [],\n  );\n\n  const hasCustomVolume = Boolean(\n    !isMuted && isSpeaking && participant.volume && participant.volume !== GROUP_CALL_DEFAULT_VOLUME,\n  );\n\n  const [aboutText, aboutColor] = useMemo(() => {\n    if (isMutedByMe) {\n      return [lang('VoipGroupMutedForMe'), styles.subtitleRed];\n    }\n\n    if (isRaiseHand) {\n      return [lang('WantsToSpeak'), styles.subtitleBlue];\n    }\n\n    if (hasCustomVolume) {\n      return [\n        lang('SpeakingWithVolume', formatGroupCallVolume(participant))\n          .replace('%%', '%'),\n        styles.subtitleGreen,\n      ];\n    }\n\n    if (!isMuted && isSpeaking) {\n      return [\n        lang('Speaking'),\n        styles.subtitleGreen,\n      ];\n    }\n\n    if (isSelf) {\n      return [lang('ThisIsYou'), styles.subtitleBlue];\n    }\n\n    return participant.about ? [participant.about, ''] : [lang('Listening'), styles.subtitleBlue];\n  }, [isMutedByMe, isRaiseHand, hasCustomVolume, isMuted, isSpeaking, isSelf, participant, lang]);\n\n  if (!peer) {\n    return undefined;\n  }\n\n  return (\n    <ListItem\n      leftElement={<Avatar peer={peer} className={styles.avatar} />}\n      rightElement={<OutlinedMicrophoneIcon participant={participant} className={styles.icon} />}\n      className={styles.root}\n      onClick={handleContextMenu}\n      onMouseDown={handleBeforeContextMenu}\n      onContextMenu={handleContextMenu}\n      multiline\n      ripple\n      ref={ref}\n    >\n      <FullNameTitle peer={peer} withEmojiStatus className={styles.title} />\n      <span className={buildClassName(styles.subtitle, 'subtitle', aboutColor)}>\n        {hasPresentationStream && <Icon name=\"share-screen\" />}\n        {hasVideoStream && <Icon name=\"video\" />}\n        {hasCustomVolume && <Icon name=\"speaker\" />}\n        <span className={styles.subtitleText}>{renderText(aboutText)}</span>\n      </span>\n      <GroupCallParticipantMenu\n        participant={participant}\n        isDropdownOpen={isContextMenuOpen}\n        anchor={contextMenuAnchor}\n        getTriggerElement={getTriggerElement}\n        getRootElement={getRootElement}\n        getMenuElement={getMenuElement}\n        getLayout={getLayout}\n        onClose={handleContextMenuClose}\n        onCloseAnimationEnd={handleContextMenuHide}\n        menuRef={menuRef}\n      />\n    </ListItem>\n  );\n};\n\nexport default memo(withGlobal<OwnProps>(\n  (global, { participant }): Complete<StateProps> => {\n    return {\n      peer: selectUser(global, participant.id) || selectChat(global, participant.id),\n    };\n  },\n)(GroupCallParticipant));\n","import type { FC } from '../../../lib/teact/teact';\nimport { memo, useMemo } from '../../../lib/teact/teact';\nimport { getActions, withGlobal } from '../../../global';\n\nimport type { GroupCallParticipant as TypeGroupCallParticipant } from '../../../lib/secret-sauce';\n\nimport { selectActiveGroupCall } from '../../../global/selectors/calls';\nimport buildClassName from '../../../util/buildClassName';\nimport { compareFields } from '../../../util/iteratees';\n\nimport useInfiniteScroll from '../../../hooks/useInfiniteScroll';\nimport useLastCallback from '../../../hooks/useLastCallback';\n\nimport InfiniteScroll from '../../ui/InfiniteScroll';\nimport GroupCallParticipant from './GroupCallParticipant';\n\nimport styles from './GroupCallParticipantList.module.scss';\n\ntype OwnProps = {\n  panelOffset: number;\n  isLandscape: boolean;\n};\n\ntype StateProps = {\n  participantsCount: number;\n  participants?: Record<string, TypeGroupCallParticipant>;\n};\n\nconst GroupCallParticipantList: FC<OwnProps & StateProps> = ({\n  panelOffset,\n  participants,\n  participantsCount,\n  isLandscape,\n}) => {\n  const {\n    loadMoreGroupCallParticipants,\n  } = getActions();\n\n  const orderedParticipantIds = useMemo(() => {\n    return Object.values(participants || {}).sort(compareParticipants).map((participant) => participant.id);\n  }, [participants]);\n\n  const handleLoadMoreGroupCallParticipants = useLastCallback(() => {\n    loadMoreGroupCallParticipants();\n  });\n\n  const [viewportIds, getMore] = useInfiniteScroll(\n    handleLoadMoreGroupCallParticipants,\n    orderedParticipantIds,\n    orderedParticipantIds.length >= participantsCount,\n  );\n\n  return (\n    <InfiniteScroll\n      items={viewportIds}\n      onLoadMore={getMore}\n      style={`transform: translateY(${panelOffset}px);`}\n      className={buildClassName(styles.root, !isLandscape && styles.portrait)}\n    >\n      {participants && viewportIds?.map(\n        (participantId) => (\n          participants[participantId] && (\n            <GroupCallParticipant\n              key={participantId}\n              teactOrderKey={orderedParticipantIds.indexOf(participantId)}\n              participant={participants[participantId]}\n            />\n          )\n        ),\n      )}\n    </InfiniteScroll>\n  );\n};\n\nfunction compareParticipants(a: TypeGroupCallParticipant, b: TypeGroupCallParticipant) {\n  return compareFields(!a.isMuted, !b.isMuted)\n    || compareFields(a.presentation, b.presentation)\n    || compareFields(a.video, b.video)\n    || compareFields(a.raiseHandRating, b.raiseHandRating);\n}\n\nexport default memo(withGlobal<OwnProps>(\n  (global): Complete<StateProps> => {\n    const { participantsCount, participants } = selectActiveGroupCall(global) || {};\n\n    return {\n      participants,\n      participantsCount: participantsCount || 0,\n    };\n  },\n)(GroupCallParticipantList));\n","// extracted by mini-css-extract-plugin\nexport default {\"root\":\"npTa6CmI\",\"portrait\":\"v7oB2HTv\"};","// extracted by mini-css-extract-plugin\nexport default {\"wrapper\":\"DKuzmnN7\",\"hidden\":\"T_wodAHA\",\"noAnimate\":\"yPCkJzpi\",\"root\":\"eBq1NoLo\",\"speaking\":\"h4NcT6OS\",\"loader\":\"XedVWQii\",\"video\":\"eUXuK9Oz\",\"videoFallback\":\"eTpvBU_b eUXuK9Oz\",\"thumbnailWrapper\":\"R5ULTrF9\",\"thumbnail\":\"cjUWuViy\",\"flipped\":\"O2bTiH2E\",\"pinButton\":\"lPdblo0y\",\"bottomPanel\":\"T1deCDSn\",\"info\":\"LzFFayK3\",\"pinned\":\"B4WZhF9P\",\"name\":\"RBwMAuKp\",\"status\":\"z1ZZTsjC\",\"icon\":\"j1aDzn1H\"};","import type { FC } from '../../../lib/teact/teact';\nimport {\n  memo, useCallback, useEffect, useMemo, useRef, useState,\n} from '../../../lib/teact/teact';\nimport { withGlobal } from '../../../global';\n\nimport type { ApiChat, ApiUser } from '../../../api/types';\nimport type { GroupCallParticipant as TypeGroupCallParticipant } from '../../../lib/secret-sauce';\nimport type { VideoLayout, VideoParticipant } from './hooks/useGroupCallVideoLayout';\n\nimport { GROUP_CALL_DEFAULT_VOLUME } from '../../../config';\nimport fastBlur from '../../../lib/fastBlur';\nimport { requestMutation } from '../../../lib/fasterdom/fasterdom';\nimport { getUserStreams, THRESHOLD } from '../../../lib/secret-sauce';\nimport { selectChat, selectUser } from '../../../global/selectors';\nimport { animate } from '../../../util/animation';\nimport { IS_CANVAS_FILTER_SUPPORTED } from '../../../util/browser/windowEnvironment';\nimport buildClassName from '../../../util/buildClassName';\nimport { fastRaf } from '../../../util/schedulers';\nimport formatGroupCallVolume from './helpers/formatGroupCallVolume';\n\nimport useInterval from '../../../hooks/schedulers/useInterval';\nimport useContextMenuHandlers from '../../../hooks/useContextMenuHandlers';\nimport useLastCallback from '../../../hooks/useLastCallback';\nimport useOldLang from '../../../hooks/useOldLang';\n\nimport FullNameTitle from '../../common/FullNameTitle';\nimport Button from '../../ui/Button';\nimport Skeleton from '../../ui/placeholder/Skeleton';\nimport GroupCallParticipantMenu from './GroupCallParticipantMenu';\nimport OutlinedMicrophoneIcon from './OutlinedMicrophoneIcon';\n\nimport styles from './GroupCallParticipantVideo.module.scss';\n\nconst BLUR_RADIUS = 2;\nconst BLUR_ITERATIONS = 2;\nconst VIDEO_FALLBACK_UPDATE_INTERVAL = 1000;\n\ntype OwnProps = {\n  layout: VideoLayout;\n  setPinned: (participant?: VideoParticipant) => void;\n  pinnedVideo: VideoParticipant | undefined;\n  canPin: boolean;\n  participant: TypeGroupCallParticipant;\n  className?: string;\n};\n\ntype StateProps = {\n  user?: ApiUser;\n  chat?: ApiChat;\n};\n\nconst GroupCallParticipantVideo: FC<OwnProps & StateProps> = ({\n  layout,\n  pinnedVideo,\n  setPinned,\n  canPin,\n  className,\n  participant,\n  user,\n  chat,\n}) => {\n  const lang = useOldLang();\n\n  const thumbnailRef = useRef<HTMLCanvasElement>();\n  const videoRef = useRef<HTMLVideoElement>();\n  const videoFallbackRef = useRef<HTMLCanvasElement>();\n\n  const {\n    x, y, width, height, noAnimate, isRemoved,\n    type,\n  } = layout;\n  const {\n    isSelf, isMutedByMe, isMuted,\n  } = participant;\n  const isPinned = pinnedVideo?.id === participant.id && pinnedVideo?.type === type;\n  const isSpeaking = (participant.amplitude || 0) > THRESHOLD;\n  const isRaiseHand = Boolean(participant.raiseHandRating);\n  const shouldFlipVideo = type === 'video' && participant.isSelf;\n\n  const status = useMemo(() => {\n    if (isSelf) {\n      return lang('ThisIsYou');\n    }\n\n    if (isMutedByMe) {\n      return lang('VoipGroupMutedForMe');\n    }\n\n    if (isRaiseHand) {\n      return lang('WantsToSpeak');\n    }\n\n    if (isMuted || !isSpeaking) {\n      return lang('Listening');\n    }\n\n    if (participant.volume && participant.volume !== GROUP_CALL_DEFAULT_VOLUME) {\n      return lang('SpeakingWithVolume', formatGroupCallVolume(participant))\n        .replace('%%', '%');\n    }\n\n    return lang('Speaking');\n  }, [isSelf, isMutedByMe, isRaiseHand, isMuted, isSpeaking, participant, lang]);\n\n  const prevLayoutRef = useRef<VideoLayout>();\n  if (!isRemoved) {\n    prevLayoutRef.current = layout;\n  }\n  const {\n    x: prevX, y: prevY, width: prevWidth, height: prevHeight,\n  } = prevLayoutRef.current || {};\n\n  const [currentX, currentY, currentWidth, currentHeight] = isRemoved\n    ? [prevX, prevY, prevWidth, prevHeight] : [x, y, width, height];\n\n  const [isHidden, setIsHidden] = useState(!noAnimate);\n\n  const streams = getUserStreams(user?.id || chat!.id);\n  const actualStream = type === 'video' ? streams?.video : streams?.presentation;\n  const streamRef = useRef(actualStream);\n  if (actualStream?.active && actualStream?.getVideoTracks()[0].enabled) {\n    streamRef.current = actualStream;\n  }\n  const stream = streamRef.current;\n\n  const handleInactive = useLastCallback(() => {\n    const video = videoRef.current;\n    if (!video) return;\n    // eslint-disable-next-line no-null/no-null\n    video.srcObject = null;\n  });\n\n  useEffect(() => {\n    stream?.addEventListener('inactive', handleInactive);\n    return () => {\n      stream?.removeEventListener('inactive', handleInactive);\n    };\n  }, [handleInactive, stream]);\n\n  useEffect(() => {\n    setIsHidden(false);\n  }, []);\n\n  const [isLoading, setIsLoading] = useState(true);\n\n  const handleCanPlay = useLastCallback(() => {\n    setIsLoading(false);\n  });\n\n  // When video stream is removed, the video element starts showing empty black screen.\n  // To avoid that, we hide the video element and show the fallback frame instead, which is constantly updated\n  // every VIDEO_FALLBACK_UPDATE_INTERVAL milliseconds.\n  useInterval(() => {\n    if (!stream?.active) return;\n    const video = videoRef.current!;\n    const canvas = videoFallbackRef.current!;\n\n    requestMutation(() => {\n      canvas.width = video.videoWidth;\n      canvas.height = video.videoHeight;\n      canvas.getContext('2d')!.drawImage(video, 0, 0, canvas.width, canvas.height);\n    });\n  }, VIDEO_FALLBACK_UPDATE_INTERVAL);\n\n  useEffect(() => {\n    const video = videoRef.current;\n    const thumbnail = thumbnailRef.current;\n    if (!video || !thumbnail || !stream) return undefined;\n\n    const ctx = thumbnail.getContext('2d', { alpha: false });\n    if (!ctx) return undefined;\n\n    let isDrawing = true;\n    requestMutation(() => {\n      if (!isDrawing) return;\n      thumbnail.width = 16;\n      thumbnail.height = 16;\n      ctx.filter = 'blur(2px)';\n\n      const draw = () => {\n        if (!isDrawing) return false;\n        if (!stream.active) {\n          return false;\n        }\n        ctx.drawImage(video, 0, 0, video.videoWidth, video.videoHeight, 0, 0, thumbnail.width, thumbnail.height);\n        if (!IS_CANVAS_FILTER_SUPPORTED) {\n          fastBlur(ctx, 0, 0, thumbnail.width, thumbnail.height, BLUR_RADIUS, BLUR_ITERATIONS);\n        }\n        return true;\n      };\n\n      animate(draw, fastRaf);\n    });\n\n    return () => {\n      isDrawing = false;\n    };\n  }, [stream]);\n\n  const ref = useRef<HTMLDivElement>();\n  const menuRef = useRef<HTMLDivElement>();\n\n  const {\n    isContextMenuOpen,\n    contextMenuAnchor,\n    handleContextMenu,\n    handleContextMenuClose,\n    handleContextMenuHide,\n  } = useContextMenuHandlers(ref, isSelf);\n\n  const getTriggerElement = useCallback(() => ref.current, []);\n\n  const getRootElement = useCallback(\n    () => ref.current!.closest('.custom-scroll, .no-scrollbar'),\n    [],\n  );\n\n  const getMenuElement = useCallback(\n    () => menuRef.current!,\n    [],\n  );\n\n  const getLayout = useCallback(\n    () => ({ withPortal: true }),\n    [],\n  );\n\n  const handleClickPin = useCallback(() => {\n    setPinned(!isPinned ? {\n      id: user?.id || chat!.id,\n      type,\n    } : undefined);\n  }, [chat, isPinned, setPinned, type, user?.id]);\n\n  return (\n    <div\n      className={buildClassName(\n        styles.wrapper,\n        (isHidden || isRemoved) && styles.hidden,\n        noAnimate && styles.noAnimate,\n        className,\n        isPinned && styles.pinned,\n      )}\n      style={`--x: ${currentX}px; --y: ${currentY}px; --width: ${currentWidth}px; --height: ${currentHeight}px;`}\n      ref={ref}\n      onContextMenu={handleContextMenu}\n      onDoubleClick={canPin ? handleClickPin : undefined}\n    >\n      <div\n        className={buildClassName(\n          styles.root,\n          isSpeaking && styles.speaking,\n        )}\n      >\n        {isLoading && (\n          <Skeleton className={buildClassName(styles.video, styles.loader)} />\n        )}\n        {stream && (\n          <video\n            className={buildClassName(styles.video, shouldFlipVideo && styles.flipped)}\n            muted\n            autoPlay\n            playsInline\n            srcObject={stream}\n            ref={videoRef}\n            onCanPlay={handleCanPlay}\n          />\n        )}\n        <canvas\n          className={buildClassName(styles.videoFallback, shouldFlipVideo && styles.flipped)}\n          ref={videoFallbackRef}\n        />\n        <div className={styles.thumbnailWrapper}>\n          <canvas\n            className={buildClassName(styles.thumbnail, shouldFlipVideo && styles.flipped)}\n            ref={thumbnailRef}\n          />\n        </div>\n        {canPin && (\n          <Button\n            round\n            size=\"smaller\"\n            ripple\n            color=\"translucent\"\n            className={styles.pinButton}\n            ariaLabel={lang(isPinned ? 'lng_group_call_context_unpin_camera' : 'lng_group_call_context_pin_camera')}\n            onClick={handleClickPin}\n            iconName={isPinned ? 'unpin' : 'pin'}\n          />\n        )}\n        <div className={styles.bottomPanel}>\n          <div className={styles.info}>\n            <FullNameTitle peer={user || chat!} className={styles.name} />\n            <div className={styles.status}>{status}</div>\n          </div>\n          <OutlinedMicrophoneIcon participant={participant} className={styles.icon} noColor />\n        </div>\n      </div>\n\n      <GroupCallParticipantMenu\n        participant={participant}\n        isDropdownOpen={isContextMenuOpen}\n        anchor={contextMenuAnchor}\n        getTriggerElement={getTriggerElement}\n        getRootElement={getRootElement}\n        getMenuElement={getMenuElement}\n        getLayout={getLayout}\n        onClose={handleContextMenuClose}\n        onCloseAnimationEnd={handleContextMenuHide}\n        menuRef={menuRef}\n      />\n    </div>\n  );\n};\n\nexport default memo(withGlobal<OwnProps>(\n  (global, { participant }): Complete<StateProps> => {\n    return {\n      user: participant.isUser ? selectUser(global, participant.id) : undefined,\n      chat: !participant.isUser ? selectChat(global, participant.id) : undefined,\n    };\n  },\n)(GroupCallParticipantVideo));\n","export const vibrateShort = () => {\n  navigator.vibrate?.(50);\n};\n","// extracted by mini-css-extract-plugin\nexport default {\"root\":\"lKdhQ5pw\",\"spinner\":\"tyQNJC6B\",\"spinnerVisible\":\"LowChABq\",\"mutedByAdmin\":\"Ynow5UuE\",\"canUnmute\":\"bjKqp3SI\",\"icon\":\"Ea1XnQaX\"};","import type { FC } from '../../../lib/teact/teact';\nimport {\n  memo, useCallback, useEffect, useMemo, useRef, useState,\n} from '../../../lib/teact/teact';\nimport { getActions, withGlobal } from '../../../global';\n\nimport type { GroupCallConnectionState } from '../../../lib/secret-sauce';\n\nimport { selectActiveGroupCall, selectGroupCallParticipant } from '../../../global/selectors/calls';\nimport buildClassName from '../../../util/buildClassName';\nimport { vibrateShort } from '../../../util/vibrate';\nimport { LOCAL_TGS_URLS } from '../../common/helpers/animatedAssets';\n\nimport useOldLang from '../../../hooks/useOldLang';\nimport usePreviousDeprecated from '../../../hooks/usePreviousDeprecated';\n\nimport AnimatedIcon from '../../common/AnimatedIcon';\nimport Button from '../../ui/Button';\nimport Spinner from '../../ui/Spinner';\n\nimport styles from './MicrophoneButton.module.scss';\n\nconst CONNECTION_STATE_DEFAULT = 'discarded';\n\ntype OwnProps = {\n  className?: string;\n};\n\ntype StateProps = {\n  connectionState?: GroupCallConnectionState;\n  hasRequestedToSpeak: boolean;\n  isMuted?: boolean;\n  canSelfUnmute?: boolean;\n  noAudioStream: boolean;\n};\n\nconst REQUEST_TO_SPEAK_THROTTLE = 3000;\nconst HOLD_TO_SPEAK_TIME = 200;\nconst ICON_SIZE = 36;\n\nconst MicrophoneButton: FC<OwnProps & StateProps> = ({\n  className,\n  noAudioStream,\n  canSelfUnmute,\n  isMuted,\n  connectionState,\n}) => {\n  const {\n    toggleGroupCallMute,\n    requestToSpeak,\n    playGroupCallSound,\n  } = getActions();\n\n  const lang = useOldLang();\n  const muteMouseDownState = useRef('up');\n\n  const [isRequestingToSpeak, setIsRequestingToSpeak] = useState(false);\n  const isConnecting = connectionState !== 'connected';\n  const shouldRaiseHand = !canSelfUnmute && isMuted;\n  const prevShouldRaiseHand = usePreviousDeprecated(shouldRaiseHand);\n\n  useEffect(() => {\n    if (prevShouldRaiseHand && !shouldRaiseHand) {\n      playGroupCallSound({ sound: 'allowTalk' });\n    }\n  }, [playGroupCallSound, prevShouldRaiseHand, shouldRaiseHand]);\n\n  // Voice mini\n  // unmuted -> muted [69, 99]\n  // muted -> unmuted [36, 69]\n  // raise -> muted [0, 36]\n  // muted -> raise [99, 136]\n  // unmuted -> raise [136, 172]\n  // TODO should probably move to other component\n  const playSegment: [number, number] = useMemo(() => {\n    if (isRequestingToSpeak) {\n      const r = Math.floor(Math.random() * 100);\n      return (r < 32 ? [0, 120]\n        : (r < 64 ? [120, 240]\n          : (r < 97 ? [240, 420]\n            : [420, 540]\n          )\n        )\n      );\n    }\n    if (!prevShouldRaiseHand && shouldRaiseHand) {\n      return noAudioStream ? [99, 135] : [136, 172];\n    }\n    if (prevShouldRaiseHand && !shouldRaiseHand) {\n      return [0, 36];\n    }\n    if (!shouldRaiseHand) {\n      return noAudioStream ? [69, 99] : [36, 69];\n    }\n    return [0, 0];\n  }, [prevShouldRaiseHand, isRequestingToSpeak, noAudioStream, shouldRaiseHand]);\n\n  const animatedIconName = isRequestingToSpeak ? 'HandFilled' : 'VoiceMini';\n\n  const toggleMute = useCallback(() => {\n    vibrateShort();\n    toggleGroupCallMute();\n  }, [toggleGroupCallMute]);\n\n  const handleMouseDownMute = useCallback(() => {\n    if (shouldRaiseHand) {\n      if (isRequestingToSpeak) return;\n      vibrateShort();\n      requestToSpeak();\n      setIsRequestingToSpeak(true);\n      setTimeout(() => {\n        setIsRequestingToSpeak(false);\n      }, REQUEST_TO_SPEAK_THROTTLE);\n      return;\n    }\n    muteMouseDownState.current = 'down';\n    if (noAudioStream) {\n      setTimeout(() => {\n        if (muteMouseDownState.current === 'down') {\n          muteMouseDownState.current = 'hold';\n          toggleMute();\n        }\n      }, HOLD_TO_SPEAK_TIME);\n    }\n  }, [isRequestingToSpeak, noAudioStream, requestToSpeak, shouldRaiseHand, toggleMute]);\n\n  const handleMouseUpMute = useCallback(() => {\n    if (shouldRaiseHand) {\n      return;\n    }\n    toggleMute();\n    muteMouseDownState.current = 'up';\n  }, [shouldRaiseHand, toggleMute]);\n\n  return (\n    <Button\n      round\n      size=\"default\"\n      className={buildClassName(\n        styles.root,\n        !isConnecting && noAudioStream && styles.canUnmute,\n        !isConnecting && shouldRaiseHand && styles.mutedByAdmin,\n        className,\n      )}\n      onMouseDown={handleMouseDownMute}\n      onMouseUp={handleMouseUpMute}\n      ariaLabel={lang(isMuted ? 'VoipUnmute' : 'VoipMute')}\n      disabled={isConnecting}\n    >\n      <AnimatedIcon\n        tgsUrl={LOCAL_TGS_URLS[animatedIconName]}\n        size={ICON_SIZE}\n        play={playSegment.toString()}\n        playSegment={playSegment}\n        className={styles.icon}\n        forceAlways\n      />\n      <Spinner className={buildClassName(styles.spinner, isConnecting && styles.spinnerVisible)} color=\"white\" />\n    </Button>\n  );\n};\n\nexport default memo(withGlobal(\n  (global): Complete<StateProps> => {\n    const groupCall = selectActiveGroupCall(global);\n\n    const { connectionState } = groupCall || {};\n    const meParticipant = groupCall && selectGroupCallParticipant(global, groupCall.id, global.currentUserId!);\n\n    const {\n      raiseHandRating, hasAudioStream, canSelfUnmute, isMuted,\n    } = meParticipant || {};\n\n    return {\n      connectionState: connectionState || CONNECTION_STATE_DEFAULT,\n      hasRequestedToSpeak: Boolean(raiseHandRating),\n      noAudioStream: !hasAudioStream,\n      canSelfUnmute,\n      isMuted,\n    };\n  },\n)(MicrophoneButton));\n","// extracted by mini-css-extract-plugin\nexport default {\"root\":\"OsO5GKfn\",\"panelWrapper\":\"cUVoePr_\",\"panel\":\"Thuz79M3\",\"panelScrollTrigger\":\"zoK6Y6IS\",\"panelHeader\":\"DMBtCL9Z\",\"scrolled\":\"GdEH1Agb\",\"fullscreen\":\"JJx0QI2w\",\"landscape\":\"wamCuzMB\",\"headerButton\":\"gmyieSid\",\"firstButton\":\"hVnn6KBp\",\"lastButton\":\"iy78A5rG\",\"panelHeaderText\":\"TwEEA77i\",\"title\":\"pNZ9skLf\",\"bigger\":\"NumT3v5i\",\"subtitle\":\"gmfUKabx\",\"participants\":\"iTeC_RxH\",\"participantVideos\":\"PZmKIdTl\",\"addParticipantButton\":\"clmu2oBt\",\"videos\":\"ATwoMlAV\",\"mainVideoContainer\":\"hqFon3dV\",\"videosHeader\":\"KPHc659W\",\"appFullscreen\":\"cl2sfoBF\",\"videosHeaderLastButton\":\"_t50HVNJ\",\"videosContent\":\"oEEQZilE\",\"actions\":\"uGzi9s97\",\"actionButton\":\"foXbVcnN\",\"destructive\":\"YIR9Z9CZ\",\"canRequestToSpeak\":\"ZoiZQu_O\",\"muted\":\"wpvv1V6m\",\"portrait\":\"R6HQcMwx\",\"noVideoParticipants\":\"aepCFyJQ\",\"noSidebar\":\"XjgP21E6\"};","import '../../../global/actions/calls';\n\nimport type { FC } from '../../../lib/teact/teact';\nimport {\n  memo, useEffect, useMemo, useRef, useState,\n} from '../../../lib/teact/teact';\nimport { getActions, withGlobal } from '../../../global';\n\nimport type {\n  GroupCallConnectionState, GroupCallParticipant as TypeGroupCallParticipant,\n} from '../../../lib/secret-sauce';\nimport type { VideoParticipant } from './hooks/useGroupCallVideoLayout';\n\nimport { IS_SCREENSHARE_SUPPORTED } from '../../../lib/secret-sauce';\nimport { selectChat, selectTabState } from '../../../global/selectors';\nimport {\n  selectCanInviteToActiveGroupCall,\n  selectGroupCall,\n  selectGroupCallParticipant,\n  selectIsAdminInActiveGroupCall,\n} from '../../../global/selectors/calls';\nimport buildClassName from '../../../util/buildClassName';\nimport { compact } from '../../../util/iteratees';\n\nimport useAppLayout from '../../../hooks/useAppLayout';\nimport useFlag from '../../../hooks/useFlag';\nimport { useIntersectionObserver, useIsIntersecting } from '../../../hooks/useIntersectionObserver';\nimport useLastCallback from '../../../hooks/useLastCallback';\nimport useOldLang from '../../../hooks/useOldLang';\nimport { useFullscreenStatus } from '../../../hooks/window/useFullscreen';\nimport useGroupCallVideoLayout from './hooks/useGroupCallVideoLayout';\n\nimport Button from '../../ui/Button';\nimport Checkbox from '../../ui/Checkbox';\nimport FloatingActionButton from '../../ui/FloatingActionButton';\nimport Modal from '../../ui/Modal';\nimport GroupCallParticipantList from './GroupCallParticipantList';\nimport GroupCallParticipantVideo from './GroupCallParticipantVideo';\nimport MicrophoneButton from './MicrophoneButton';\n\nimport styles from './GroupCall.module.scss';\n\nconst INTERSECTION_THROTTLE = 200;\n\nexport type OwnProps = {\n  groupCallId: string;\n};\n\ntype StateProps = {\n  isCallPanelVisible: boolean;\n  connectionState: GroupCallConnectionState;\n  title?: string;\n  meParticipant?: TypeGroupCallParticipant;\n  participantsCount?: number;\n  isAdmin: boolean;\n  participants: Record<string, TypeGroupCallParticipant>;\n  canInvite: boolean;\n};\n\nconst GroupCall: FC<OwnProps & StateProps> = ({\n  groupCallId,\n  isCallPanelVisible,\n  connectionState,\n  participantsCount,\n  title,\n  meParticipant,\n  isAdmin,\n  participants,\n  canInvite,\n}) => {\n  const {\n    toggleGroupCallVideo,\n    toggleGroupCallPresentation,\n    leaveGroupCall,\n    toggleGroupCallPanel,\n    connectToActiveGroupCall,\n    playGroupCallSound,\n    createGroupCallInviteLink,\n  } = getActions();\n\n  const lang = useOldLang();\n  const containerRef = useRef<HTMLDivElement>();\n\n  const primaryVideoContainerRef = useRef<HTMLDivElement>();\n  const secondaryVideoContainerRef = useRef<HTMLDivElement>();\n\n  const panelScrollTriggerRef = useRef<HTMLDivElement>();\n  const panelRef = useRef<HTMLDivElement>();\n\n  const [isLeaving, setIsLeaving] = useState(false);\n  const isOpen = !isCallPanelVisible && !isLeaving;\n\n  const { observe } = useIntersectionObserver({\n    rootRef: panelRef,\n    throttleMs: INTERSECTION_THROTTLE,\n    isDisabled: !isOpen,\n  });\n\n  const hasScrolled = !useIsIntersecting(panelScrollTriggerRef, isOpen ? observe : undefined);\n\n  const { isMobile, isLandscape } = useAppLayout();\n\n  const [isFullscreen, openFullscreen, closeFullscreen] = useFlag();\n  const [isSidebarOpen, openSidebar, closeSidebar] = useFlag(true);\n  const isLandscapeLayout = Boolean(isFullscreen && isLandscape);\n  const isAppFullscreen = useFullscreenStatus();\n\n  const firstPresentation = useMemo(() => {\n    return Object.values(participants).find(({ presentation }) => presentation);\n  }, [participants]);\n  const videoParticipants = useMemo(() => Object.values(participants)\n    .filter(({ video, presentation }) => video || presentation)\n    .flatMap(({ id, video, presentation }) => compact([\n      video ? {\n        id,\n        type: 'video' as const,\n      } : undefined,\n      presentation ? {\n        id,\n        type: 'screen' as const,\n      } : undefined,\n    ])),\n  [participants]);\n  const hasVideoParticipants = videoParticipants.length > 0;\n\n  const groupCallTitle = title || lang('VoipGroupVoiceChat');\n  const membersString = lang('Participants', participantsCount, 'i');\n\n  const [isConfirmLeaveModalOpen, openConfirmLeaveModal, closeConfirmLeaveModal] = useFlag();\n  const [isEndGroupCallModal, setIsEndGroupCallModal] = useState(false);\n  const [shouldEndGroupCall, setShouldEndGroupCall] = useState(false);\n\n  const hasVideo = meParticipant?.hasVideoStream;\n  const hasPresentation = meParticipant?.hasPresentationStream;\n  const hasAudioStream = meParticipant?.hasAudioStream;\n  const isConnecting = connectionState !== 'connected';\n  const canSelfUnmute = meParticipant?.canSelfUnmute;\n  const canRequestToSpeak = !canSelfUnmute && !hasAudioStream;\n\n  useEffect(() => {\n    if (connectionState === 'connected') {\n      playGroupCallSound({ sound: 'join' });\n    } else if (connectionState === 'reconnecting') {\n      playGroupCallSound({ sound: 'connecting' });\n    }\n  }, [connectionState]);\n\n  const handleCloseConfirmLeaveModal = useLastCallback(() => {\n    closeConfirmLeaveModal();\n    setIsEndGroupCallModal(false);\n  });\n\n  const handleToggleFullscreen = useLastCallback(() => {\n    if (!containerRef.current || isMobile) return;\n\n    if (isFullscreen) {\n      closeFullscreen();\n    } else {\n      openFullscreen();\n    }\n  });\n\n  const handleToggleSidebar = useLastCallback(() => {\n    if (isSidebarOpen) {\n      closeSidebar();\n    } else {\n      openSidebar();\n    }\n  });\n\n  const handleToggleGroupCallPanel = useLastCallback(() => {\n    toggleGroupCallPanel();\n  });\n\n  const handleInviteMember = useLastCallback(() => {\n    createGroupCallInviteLink();\n  });\n\n  const handleClickVideo = useLastCallback(() => {\n    toggleGroupCallVideo();\n  });\n\n  useEffect(() => {\n    connectToActiveGroupCall();\n  }, [connectToActiveGroupCall, groupCallId]);\n\n  const handleLeaveGroupCall = useLastCallback(() => {\n    if (isAdmin && !isConfirmLeaveModalOpen) {\n      openConfirmLeaveModal();\n      return;\n    }\n    playGroupCallSound({ sound: 'leave' });\n    setIsLeaving(true);\n    closeConfirmLeaveModal();\n  });\n\n  const handleCloseAnimationEnd = useLastCallback(() => {\n    if (!isLeaving) return;\n\n    leaveGroupCall({\n      shouldDiscard: shouldEndGroupCall,\n    });\n  });\n\n  const handleToggleGroupCallPresentation = useLastCallback(() => {\n    toggleGroupCallPresentation();\n  });\n\n  const canPinVideo = videoParticipants.length > 1 && !isMobile;\n  const isLandscapeWithVideos = isLandscapeLayout && hasVideoParticipants;\n  const [pinnedVideo, setPinnedVideo] = useState<VideoParticipant | undefined>(undefined);\n  const {\n    videoLayout,\n    panelOffset,\n  } = useGroupCallVideoLayout({\n    primaryContainerRef: primaryVideoContainerRef,\n    secondaryContainerRef: secondaryVideoContainerRef,\n    videoParticipants,\n    isLandscapeLayout,\n    pinnedVideo,\n  });\n\n  const handleSetPinnedVideo = useLastCallback((video: VideoParticipant | undefined) => {\n    setPinnedVideo(video);\n    if (video && !isFullscreen) {\n      openFullscreen();\n    }\n  });\n\n  const handleOpenFirstPresentation = useLastCallback(() => {\n    if (!firstPresentation) return;\n\n    setPinnedVideo({\n      id: firstPresentation.id,\n      type: 'screen',\n    });\n  });\n\n  useEffect(handleOpenFirstPresentation, [handleOpenFirstPresentation, Boolean(firstPresentation)]);\n\n  useEffect(() => {\n    if (!pinnedVideo) return;\n    if (!videoParticipants.some((l) => l.type === pinnedVideo.type && l.id === pinnedVideo.id)) {\n      setPinnedVideo(undefined);\n    }\n  }, [pinnedVideo, videoLayout, videoParticipants]);\n\n  return (\n    <Modal\n      isOpen={isOpen}\n      onClose={toggleGroupCallPanel}\n      className={buildClassName(\n        styles.root,\n        (isFullscreen || isMobile) && styles.fullscreen,\n        isAppFullscreen && styles.appFullscreen,\n        isLandscapeLayout && styles.landscape,\n        !hasVideoParticipants && styles.noVideoParticipants,\n        !isLandscapeLayout && styles.portrait,\n        !isSidebarOpen && isLandscapeWithVideos && styles.noSidebar,\n      )}\n      dialogRef={containerRef}\n      onCloseAnimationEnd={handleCloseAnimationEnd}\n    >\n      {isLandscapeWithVideos && (\n        <div className={styles.videos}>\n          <div className={styles.videosHeader}>\n            {!isMobile && (\n              <Button\n                round\n                size=\"smaller\"\n                color=\"translucent\"\n                onClick={handleToggleFullscreen}\n                className={buildClassName(styles.headerButton, styles.firstButton)}\n                ariaLabel={lang(isFullscreen ? 'AccExitFullscreen' : 'AccSwitchToFullscreen')}\n                iconName={isFullscreen ? 'smallscreen' : 'fullscreen'}\n              />\n            )}\n\n            <h3 className={buildClassName(styles.title, styles.bigger)}>\n              {title || lang('VoipGroupVoiceChat')}\n            </h3>\n\n            {isLandscapeWithVideos && !isSidebarOpen && (\n              <Button\n                round\n                size=\"smaller\"\n                color=\"translucent\"\n                className={buildClassName(styles.headerButton, styles.videosHeaderLastButton)}\n                onClick={handleToggleSidebar}\n                ariaLabel={lang('AccDescrExpandPanel')}\n                iconName=\"sidebar\"\n              />\n            )}\n          </div>\n\n          <div\n            className={styles.videosContent}\n            ref={primaryVideoContainerRef}\n          />\n        </div>\n      )}\n\n      <div className={styles.panelWrapper} ref={panelRef}>\n        <div className={buildClassName(styles.panel, 'custom-scroll')}>\n          <div className={styles.panelScrollTrigger} ref={panelScrollTriggerRef} />\n\n          <div className={buildClassName(styles.panelHeader, hasScrolled && styles.scrolled)}>\n            {!isLandscapeWithVideos && !isMobile && (\n              <Button\n                round\n                size=\"smaller\"\n                color=\"translucent\"\n                ripple={!isMobile}\n                className={buildClassName(\n                  styles.firstButton,\n                  styles.headerButton,\n                )}\n                onClick={handleToggleFullscreen}\n                ariaLabel={lang('AccSwitchToFullscreen')}\n                iconName=\"fullscreen\"\n              />\n            )}\n\n            {isMobile && (\n              <Button\n                round\n                size=\"smaller\"\n                color=\"translucent\"\n                onClick={handleToggleGroupCallPanel}\n                className={buildClassName(styles.headerButton, styles.firstButton)}\n                ariaLabel={lang('Close')}\n                iconName=\"close\"\n              />\n            )}\n\n            {isLandscapeWithVideos && (\n              <Button\n                round\n                size=\"smaller\"\n                ripple={!isMobile}\n                className={buildClassName(\n                  styles.firstButton,\n                  styles.headerButton,\n                )}\n                color=\"translucent\"\n                onClick={handleToggleSidebar}\n                ariaLabel={lang('AccDescrCollapsePanel')}\n                iconName=\"sidebar\"\n              />\n            )}\n\n            <div className={styles.panelHeaderText}>\n              <h3 className={buildClassName(styles.title, isLandscapeWithVideos && styles.bigger)}>\n                {isLandscapeWithVideos ? membersString : groupCallTitle}\n              </h3>\n              {!isLandscapeWithVideos && (\n                <span className={styles.subtitle}>\n                  {membersString}\n                </span>\n              )}\n            </div>\n\n            {!isLandscapeWithVideos && canInvite && (\n              <Button\n                round\n                size=\"smaller\"\n                ripple={!isMobile}\n                className={buildClassName(\n                  styles.lastButton,\n                  styles.headerButton,\n                )}\n                color=\"translucent\"\n                onClick={handleInviteMember}\n                ariaLabel={lang('VoipGroupInviteMember')}\n                iconName=\"add-user\"\n              />\n            )}\n          </div>\n\n          <div className={styles.participants}>\n            <div\n              className={styles.participantVideos}\n              ref={secondaryVideoContainerRef}\n              style={`height: ${panelOffset}px;`}\n            >\n              {videoLayout.map((layout) => {\n                const participant = participants[layout.participantId];\n                if (!layout.isRemounted || !participant) {\n                  return (\n                    <div\n                      teactOrderKey={layout.orderKey}\n                      key={`${layout.participantId}_${layout.type}`}\n                    />\n                  );\n                }\n\n                return (\n                  <GroupCallParticipantVideo\n                    teactOrderKey={layout.orderKey}\n                    key={`${layout.participantId}_${layout.type}`}\n                    layout={layout}\n                    canPin={canPinVideo}\n                    setPinned={handleSetPinnedVideo}\n                    pinnedVideo={pinnedVideo}\n                    participant={participant}\n                  />\n                );\n              })}\n            </div>\n            <GroupCallParticipantList\n              panelOffset={panelOffset}\n              isLandscape={isLandscapeWithVideos}\n            />\n          </div>\n        </div>\n\n        <FloatingActionButton\n          key=\"add-participant\"\n          isShown={isLandscapeWithVideos && canInvite}\n          onClick={handleInviteMember}\n          className={styles.addParticipantButton}\n          ariaLabel={lang('VoipGroupInviteMember')}\n          iconName=\"add-user-filled\"\n        />\n      </div>\n\n      <div className={styles.mainVideoContainer}>\n        {videoLayout.map((layout) => {\n          const participant = participants[layout.participantId];\n          if (layout.isRemounted || !participant) {\n            return (\n              <div\n                teactOrderKey={layout.orderKey}\n                key={`${layout.participantId}_${layout.type}`}\n              />\n            );\n          }\n          return (\n            <GroupCallParticipantVideo\n              teactOrderKey={layout.orderKey}\n              key={`${layout.participantId}_${layout.type}`}\n              layout={layout}\n              canPin={canPinVideo}\n              setPinned={handleSetPinnedVideo}\n              pinnedVideo={pinnedVideo}\n              participant={participant}\n              className={styles.video}\n            />\n          );\n        })}\n      </div>\n\n      <div className={styles.actions}>\n        <Button\n          round\n          size=\"default\"\n          ripple\n          className={buildClassName(\n            styles.actionButton,\n            !hasAudioStream && styles.muted,\n            canRequestToSpeak && styles.canRequestToSpeak,\n          )}\n          onClick={handleClickVideo}\n          ariaLabel={lang(hasVideo ? 'VoipStopVideo' : 'VoipStartVideo')}\n          disabled={isConnecting}\n          iconName={!hasVideo ? 'video-stop' : 'video'}\n        />\n\n        <Button\n          round\n          size=\"default\"\n          ripple\n          className={buildClassName(\n            styles.actionButton,\n            !hasAudioStream && styles.muted,\n            canRequestToSpeak && styles.canRequestToSpeak,\n          )}\n          onClick={handleToggleGroupCallPresentation}\n          ariaLabel={lang(hasPresentation ? 'lng_group_call_screen_share_stop' : 'lng_group_call_tooltip_screen')}\n          disabled={isConnecting || !IS_SCREENSHARE_SUPPORTED}\n          iconName={!hasPresentation ? 'share-screen-stop' : 'share-screen'}\n        />\n\n        <MicrophoneButton className={styles.actionButton} />\n\n        <Button\n          round\n          size=\"default\"\n          ripple\n          className={buildClassName(\n            styles.actionButton,\n            !hasAudioStream && styles.muted,\n            canRequestToSpeak && styles.canRequestToSpeak,\n          )}\n          ariaLabel={lang('lng_group_call_settings')}\n          disabled\n          iconName=\"settings-filled\"\n        />\n\n        <Button\n          round\n          size=\"default\"\n          ripple\n          className={buildClassName(\n            styles.actionButton,\n            styles.destructive,\n          )}\n          onClick={handleLeaveGroupCall}\n          ariaLabel={lang('lng_group_call_leave')}\n          iconName=\"close\"\n        />\n      </div>\n\n      <Modal\n        isOpen={isConfirmLeaveModalOpen}\n        onClose={handleCloseConfirmLeaveModal}\n        className=\"error\"\n        title={lang(isEndGroupCallModal ? 'VoipGroupEndAlertTitle' : 'VoipGroupLeaveAlertTitle')}\n      >\n        <p>{lang(isEndGroupCallModal ? 'VoipGroupEndAlertText' : 'VoipGroupLeaveAlertText')}</p>\n        {!isEndGroupCallModal && (\n          <Checkbox\n            className=\"dialog-checkbox\"\n            label={lang('VoipGroupEndChat')}\n            checked={shouldEndGroupCall}\n            onCheck={setShouldEndGroupCall}\n          />\n        )}\n        <div className=\"dialog-buttons\">\n          <Button isText className=\"confirm-dialog-button\" onClick={handleLeaveGroupCall}>\n            {lang(isEndGroupCallModal ? 'VoipGroupEnd' : 'VoipGroupLeave')}\n          </Button>\n          <Button isText className=\"confirm-dialog-button\" onClick={handleCloseConfirmLeaveModal}>\n            {lang('Cancel')}\n          </Button>\n        </div>\n      </Modal>\n    </Modal>\n  );\n};\n\nexport default memo(withGlobal<OwnProps>(\n  (global, { groupCallId }): Complete<StateProps> => {\n    const {\n      connectionState, title, participants, participantsCount, chatId,\n    } = selectGroupCall(global, groupCallId) || {};\n\n    const chat = chatId ? selectChat(global, chatId) : undefined;\n\n    return {\n      connectionState,\n      title: title || chat?.title,\n      participantsCount,\n      meParticipant: selectGroupCallParticipant(global, groupCallId, global.currentUserId!),\n      isCallPanelVisible: Boolean(selectTabState(global).isCallPanelVisible),\n      isAdmin: selectIsAdminInActiveGroupCall(global),\n      participants,\n      canInvite: selectCanInviteToActiveGroupCall(global),\n    };\n  },\n)(GroupCall));\n","import type {\n  ElementRef } from '../../../../lib/teact/teact';\nimport {\n  useEffect, useMemo, useState,\n} from '../../../../lib/teact/teact';\n\nimport useLastCallback from '../../../../hooks/useLastCallback';\nimport usePreviousDeprecated from '../../../../hooks/usePreviousDeprecated';\nimport useResizeObserver from '../../../../hooks/useResizeObserver';\n\nconst PADDING_HORIZONTAL = 10;\nconst PADDING_VERTICAL = 8;\nconst PREFERRED_PANEL_VIDEO_HEIGHT = 240;\n\nexport type VideoLayout = {\n  participantId: string;\n  type: 'video' | 'screen';\n  x: number;\n  y: number;\n  width: number;\n  height: number;\n  shouldRemount?: boolean;\n  isRemounted?: boolean;\n  noAnimate?: boolean;\n  isRemoved?: boolean;\n  orderKey: number;\n};\n\nexport type VideoParticipant = {\n  id: string;\n  type: 'video' | 'screen';\n};\n\nexport default function useGroupCallVideoLayout({\n  primaryContainerRef,\n  secondaryContainerRef,\n  videoParticipants,\n  isLandscapeLayout,\n  pinnedVideo,\n}: {\n  primaryContainerRef: ElementRef<HTMLDivElement>;\n  secondaryContainerRef: ElementRef<HTMLDivElement>;\n  videoParticipants: VideoParticipant[];\n  isLandscapeLayout: boolean;\n  pinnedVideo: VideoParticipant | undefined;\n}) {\n  const [videoLayout, setVideoLayout] = useState<VideoLayout[]>([]);\n  const [panelOffset, setPanelOffset] = useState(0);\n  const videosCount = videoParticipants.length;\n  const prevVideosCount = usePreviousDeprecated(videosCount);\n  const prevVideoParticipants = usePreviousDeprecated(videoParticipants);\n  const removedVideoParticipants = useMemo(() => {\n    return prevVideoParticipants?.filter(\n      ({ id, type }) => !videoParticipants.some((p) => p.id === id && p.type === type),\n    );\n  }, [prevVideoParticipants, videoParticipants]);\n\n  const recalculateLayout = useLastCallback(() => {\n    const primaryContainer = primaryContainerRef.current;\n    const secondaryContainer = secondaryContainerRef.current;\n    if (!secondaryContainer) return;\n\n    const removed = prevVideosCount !== undefined && prevVideosCount > videosCount\n      ? prevVideosCount - videosCount : 0;\n\n    const {\n      x: secondaryInitialX,\n      y: secondaryInitialY,\n      width: secondaryContainerWidth,\n    } = secondaryContainer.getBoundingClientRect();\n\n    const layout: VideoLayout[] = [];\n    if (pinnedVideo !== undefined || !primaryContainer || !isLandscapeLayout) {\n      const isRemounted = true;\n      let skip = false;\n      let pinnedSkipIndex = 0;\n      let pinnedPush: VideoLayout | undefined;\n      let participants = videoParticipants;\n      if (pinnedVideo && primaryContainer && isLandscapeLayout) {\n        pinnedSkipIndex = participants\n          .findIndex(({ id, type }) => id === pinnedVideo.id && type === pinnedVideo.type);\n        if (pinnedSkipIndex !== -1) {\n          const {\n            x: initialX,\n            y: initialY,\n            width: containerWidth,\n            height: containerHeight,\n          } = primaryContainer.getBoundingClientRect();\n\n          const { id: participantId, type } = pinnedVideo;\n\n          pinnedPush = {\n            x: initialX,\n            y: initialY,\n            width: containerWidth,\n            height: containerHeight,\n            participantId,\n            type,\n            orderKey: pinnedSkipIndex,\n          };\n          skip = true;\n          participants = participants\n            .filter(({ id, type: videoType }) => id !== participantId || videoType !== pinnedVideo.type);\n        }\n      }\n\n      const secondaryVideosCounts = skip ? videosCount - 1 : videosCount;\n\n      const isFirstBig = secondaryVideosCounts % 2 === 1;\n      const columns = 2;\n      const rows = Math.ceil(secondaryVideosCounts / columns);\n      const smallWidth = (secondaryContainerWidth - (columns - 1) * PADDING_HORIZONTAL) / columns;\n      const heightTotal = Math.max(0, isFirstBig\n        ? (PREFERRED_PANEL_VIDEO_HEIGHT + (rows - 1) * smallWidth + (rows - 1) * PADDING_VERTICAL)\n        : rows * smallWidth + (rows - 1) * PADDING_VERTICAL);\n\n      for (let i = 0; i < secondaryVideosCounts; i++) {\n        const isBig = isFirstBig && i === 0;\n        const width = isBig ? secondaryContainerWidth : smallWidth;\n        const height = isBig ? PREFERRED_PANEL_VIDEO_HEIGHT : smallWidth;\n\n        const realIndex = isFirstBig && i !== 0 ? i + 1 : i;\n\n        const x = (isRemounted ? 0 : secondaryInitialX) + (realIndex % columns) * (width + PADDING_HORIZONTAL);\n        const y = (isRemounted ? 0 : secondaryInitialY) + (isFirstBig && i !== 0 ? (\n          PREFERRED_PANEL_VIDEO_HEIGHT + PADDING_VERTICAL\n          + (Math.floor(realIndex / columns) - 1) * (height + PADDING_VERTICAL)\n        ) : (\n          Math.floor(realIndex / columns) * (height + PADDING_VERTICAL)\n        ));\n        layout.push({\n          x,\n          y,\n          width,\n          height,\n          shouldRemount: !isRemounted,\n          isRemounted,\n          noAnimate: true,\n          participantId: participants[i].id,\n          type: participants[i].type,\n          orderKey: i >= pinnedSkipIndex ? i + 1 : i,\n        });\n      }\n\n      if (pinnedPush) {\n        layout.splice(pinnedSkipIndex, 0, pinnedPush);\n      }\n\n      if (removedVideoParticipants) {\n        for (let i = 0; i < removed; i++) {\n          layout.push({\n            x: 0,\n            y: 0,\n            width: 0,\n            height: 0,\n            isRemounted,\n            isRemoved: true,\n            participantId: removedVideoParticipants[i].id,\n            type: removedVideoParticipants[i].type,\n            orderKey: i + videosCount,\n          });\n        }\n      }\n\n      setPanelOffset(heightTotal);\n      setVideoLayout(layout);\n      return;\n    }\n\n    const {\n      x: initialX,\n      y: initialY,\n      width: containerWidth,\n      height: containerHeight,\n    } = primaryContainer.getBoundingClientRect();\n\n    const columns = calculateColumnsCount(videosCount);\n    const rows = Math.ceil(videosCount / columns);\n    const totalGridSize = rows * columns;\n    const shouldFillLastRow = totalGridSize > videosCount;\n    const width = (containerWidth - (columns - 1) * PADDING_HORIZONTAL) / columns;\n    const height = (containerHeight - (rows - 1) * PADDING_VERTICAL) / rows;\n\n    const lastRowWidth = width * (videosCount % columns);\n    for (let i = 0; i < videosCount; i++) {\n      const row = Math.floor(i / columns);\n      const shouldCenter = shouldFillLastRow && row === rows - 1;\n      const x = initialX + (i % columns) * (width + PADDING_HORIZONTAL)\n        + (shouldCenter ? (containerWidth - lastRowWidth) / 2 : 0);\n      const y = initialY + Math.floor(i / columns) * (height + PADDING_VERTICAL);\n      layout.push({\n        x,\n        y,\n        width,\n        height,\n        participantId: videoParticipants[i].id,\n        type: videoParticipants[i].type,\n        orderKey: i,\n      });\n    }\n\n    if (removedVideoParticipants) {\n      for (let i = 0; i < removed; i++) {\n        layout.push({\n          x: 0,\n          y: 0,\n          width: 0,\n          height: 0,\n          isRemoved: true,\n          participantId: removedVideoParticipants[i].id,\n          type: removedVideoParticipants[i].type,\n          orderKey: i + videosCount,\n        });\n      }\n    }\n\n    setPanelOffset(0);\n    setVideoLayout(layout);\n  });\n\n  useEffect(recalculateLayout, [\n    recalculateLayout, videoParticipants, isLandscapeLayout, pinnedVideo,\n  ]);\n\n  useResizeObserver(primaryContainerRef, recalculateLayout, !primaryContainerRef.current);\n  useResizeObserver(secondaryContainerRef, recalculateLayout, !secondaryContainerRef.current);\n\n  return {\n    videoLayout, panelOffset,\n  };\n}\n\nfunction calculateColumnsCount(videosCount: number) {\n  if (videosCount >= 25) {\n    return 5;\n  } else if (videosCount >= 13) {\n    return 4;\n  } else if (videosCount >= 7) {\n    return 3;\n  } else if (videosCount >= 3) {\n    return 2;\n  } else {\n    return 1;\n  }\n}\n","import { memo, useEffect } from '../../lib/teact/teact';\nimport { getActions, withGlobal } from '../../global';\n\nimport type { ApiGroupCall, ApiUser } from '../../api/types';\n\nimport { selectTabState } from '../../global/selectors';\nimport { selectActiveGroupCall, selectPhoneCallUser } from '../../global/selectors/calls';\nimport buildClassName from '../../util/buildClassName';\n\nimport useOldLang from '../../hooks/useOldLang';\n\nimport './ActiveCallHeader.scss';\n\ntype StateProps = {\n  isCallPanelVisible?: boolean;\n  groupCall?: ApiGroupCall;\n  phoneCallUser?: ApiUser;\n};\n\nconst ActiveCallHeader = ({\n  groupCall,\n  phoneCallUser,\n  isCallPanelVisible,\n}: StateProps) => {\n  const { toggleGroupCallPanel } = getActions();\n\n  const lang = useOldLang();\n\n  useEffect(() => {\n    document.body.classList.toggle('has-call-header', Boolean(isCallPanelVisible));\n    window.tauri?.markTitleBarOverlay(!isCallPanelVisible);\n\n    return () => {\n      document.body.classList.toggle('has-call-header', false);\n      window.tauri?.markTitleBarOverlay(true);\n    };\n  }, [isCallPanelVisible]);\n\n  function handleToggleGroupCallPanel() {\n    toggleGroupCallPanel();\n  }\n\n  if (!groupCall && !phoneCallUser) return undefined;\n\n  return (\n    <div\n      className={buildClassName(\n        'ActiveCallHeader',\n        isCallPanelVisible && 'open',\n      )}\n      onClick={handleToggleGroupCallPanel}\n    >\n      <span className=\"title\">{phoneCallUser?.firstName || groupCall?.title || lang('VoipGroupVoiceChat')}</span>\n    </div>\n  );\n};\n\nexport default memo(withGlobal(\n  (global): Complete<StateProps> => {\n    const tabState = selectTabState(global);\n    return {\n      groupCall: tabState.isMasterTab ? selectActiveGroupCall(global) : undefined,\n      isCallPanelVisible: tabState.isCallPanelVisible,\n      phoneCallUser: tabState.isMasterTab ? selectPhoneCallUser(global) : undefined,\n    };\n  },\n)(ActiveCallHeader));\n","// extracted by mini-css-extract-plugin\nexport default {\"root\":\"lBO3RZUM\",\"button\":\"ch2sqAKW\",\"active\":\"OQxlsRp7\",\"button-text\":\"aHguvLcL\",\"buttonText\":\"aHguvLcL\"};","import type { FC } from '../../../lib/teact/teact';\nimport type React from '../../../lib/teact/teact';\nimport { memo } from '../../../lib/teact/teact';\n\nimport type { IconName } from '../../../types/icons';\n\nimport buildClassName from '../../../util/buildClassName';\n\nimport Icon from '../../common/icons/Icon';\nimport Button from '../../ui/Button';\n\nimport styles from './PhoneCallButton.module.scss';\n\ntype OwnProps = {\n  onClick: VoidFunction;\n  label: string;\n  icon?: IconName;\n  iconClassName?: string;\n  customIcon?: React.ReactNode;\n  className?: string;\n  isDisabled?: boolean;\n  isActive?: boolean;\n};\n\nconst PhoneCallButton: FC<OwnProps> = ({\n  onClick,\n  label,\n  customIcon,\n  icon,\n  iconClassName,\n  className,\n  isDisabled,\n  isActive,\n}) => {\n  return (\n    <div className={styles.root}>\n      <Button\n        round\n        className={buildClassName(className, styles.button, isActive && styles.active)}\n        onClick={onClick}\n        disabled={isDisabled}\n      >\n        {customIcon || <Icon name={icon!} className={iconClassName} />}\n      </Button>\n      <div className={styles.buttonText}>{label}</div>\n    </div>\n  );\n};\n\nexport default memo(PhoneCallButton);\n","// extracted by mini-css-extract-plugin\nexport default {\"root\":\"GNYRVAUg\",\"blurred\":\"RBmbMiou\",\"single-column\":\"O7cZE08z\",\"singleColumn\":\"O7cZE08z\",\"header\":\"GI6dY5aJ\",\"close-button\":\"ULiJZuaP\",\"closeButton\":\"ULiJZuaP\",\"emojis-backdrop\":\"RFBKZpjx\",\"emojisBackdrop\":\"RFBKZpjx\",\"open\":\"zi1NlOXX\",\"emojis\":\"DFco1VIN\",\"emoji-tooltip\":\"MRIShZ3V\",\"emojiTooltip\":\"MRIShZ3V\",\"user-info\":\"eaUe2A0c\",\"userInfo\":\"eaUe2A0c\",\"buttons\":\"qIeflO02\",\"leave\":\"hclywYYk\",\"accept\":\"ln_ZBUHy\",\"accept-icon\":\"cVRd3twS\",\"acceptIcon\":\"cVRd3twS\",\"main-video\":\"bGlBFSJq\",\"mainVideo\":\"bGlBFSJq\",\"second-video\":\"TOFu1n5x\",\"secondVideo\":\"TOFu1n5x\",\"visible\":\"LOnSFN9w\",\"fullscreen\":\"Omg5T1o6\"};","import '../../../global/actions/calls';\n\nimport {\n  memo, useCallback, useEffect, useMemo, useRef,\n} from '../../../lib/teact/teact';\nimport { getActions, withGlobal } from '../../../global';\n\nimport type { ApiPhoneCall, ApiUser } from '../../../api/types';\n\nimport {\n  getStreams, IS_SCREENSHARE_SUPPORTED, switchCameraInputP2p, toggleStreamP2p,\n} from '../../../lib/secret-sauce';\nimport { selectTabState } from '../../../global/selectors';\nimport { selectPhoneCallUser } from '../../../global/selectors/calls';\nimport {\n  IS_ANDROID,\n  IS_IOS,\n  IS_REQUEST_FULLSCREEN_SUPPORTED,\n} from '../../../util/browser/windowEnvironment';\nimport buildClassName from '../../../util/buildClassName';\nimport { formatMediaDuration } from '../../../util/dates/dateFormat';\nimport { getServerTime } from '../../../util/serverTime';\nimport { LOCAL_TGS_URLS } from '../../common/helpers/animatedAssets';\nimport renderText from '../../common/helpers/renderText';\n\nimport useInterval from '../../../hooks/schedulers/useInterval';\nimport useAppLayout from '../../../hooks/useAppLayout';\nimport useFlag from '../../../hooks/useFlag';\nimport useForceUpdate from '../../../hooks/useForceUpdate';\nimport useOldLang from '../../../hooks/useOldLang';\n\nimport AnimatedIcon from '../../common/AnimatedIcon';\nimport Avatar from '../../common/Avatar';\nimport Button from '../../ui/Button';\nimport Modal from '../../ui/Modal';\nimport PhoneCallButton from './PhoneCallButton';\n\nimport styles from './PhoneCall.module.scss';\n\ntype StateProps = {\n  user?: ApiUser;\n  phoneCall?: ApiPhoneCall;\n  isOutgoing: boolean;\n  isCallPanelVisible?: boolean;\n};\n\nconst PhoneCall = ({\n  user,\n  isOutgoing,\n  phoneCall,\n  isCallPanelVisible,\n}: StateProps) => {\n  const lang = useOldLang();\n  const {\n    hangUp, requestMasterAndAcceptCall, playGroupCallSound, toggleGroupCallPanel, connectToActivePhoneCall,\n  } = getActions();\n  const containerRef = useRef<HTMLDivElement>();\n\n  const [isFullscreen, openFullscreen, closeFullscreen] = useFlag();\n  const { isMobile } = useAppLayout();\n\n  const toggleFullscreen = useCallback(() => {\n    if (isFullscreen) {\n      closeFullscreen();\n    } else {\n      openFullscreen();\n    }\n  }, [closeFullscreen, isFullscreen, openFullscreen]);\n\n  const handleToggleFullscreen = useCallback(() => {\n    if (!containerRef.current) return;\n\n    if (isFullscreen) {\n      document.exitFullscreen().then(closeFullscreen);\n    } else {\n      containerRef.current.requestFullscreen().then(openFullscreen);\n    }\n  }, [closeFullscreen, isFullscreen, openFullscreen]);\n\n  useEffect(() => {\n    if (!IS_REQUEST_FULLSCREEN_SUPPORTED) return undefined;\n    const container = containerRef.current;\n    if (!container) return undefined;\n\n    container.addEventListener('fullscreenchange', toggleFullscreen);\n\n    return () => {\n      container.removeEventListener('fullscreenchange', toggleFullscreen);\n    };\n  }, [toggleFullscreen]);\n\n  const handleClose = useCallback(() => {\n    toggleGroupCallPanel();\n    if (isFullscreen) {\n      closeFullscreen();\n    }\n  }, [closeFullscreen, isFullscreen, toggleGroupCallPanel]);\n\n  const isDiscarded = phoneCall?.state === 'discarded';\n  const isBusy = phoneCall?.reason === 'busy';\n\n  const isIncomingRequested = phoneCall?.state === 'requested' && !isOutgoing;\n  const isOutgoingRequested = (phoneCall?.state === 'requested' || phoneCall?.state === 'waiting') && isOutgoing;\n  const isActive = phoneCall?.state === 'active';\n  const isConnected = phoneCall?.isConnected;\n\n  const [isHangingUp, startHangingUp, stopHangingUp] = useFlag();\n  const handleHangUp = useCallback(() => {\n    startHangingUp();\n    hangUp();\n  }, [hangUp, startHangingUp]);\n\n  useEffect(() => {\n    if (isHangingUp) {\n      playGroupCallSound({ sound: 'end' });\n    } else if (isIncomingRequested) {\n      playGroupCallSound({ sound: 'incoming' });\n    } else if (isBusy) {\n      playGroupCallSound({ sound: 'busy' });\n    } else if (isDiscarded) {\n      playGroupCallSound({ sound: 'end' });\n    } else if (isOutgoingRequested) {\n      playGroupCallSound({ sound: 'ringing' });\n    } else if (isConnected) {\n      playGroupCallSound({ sound: 'connect' });\n    }\n  }, [isBusy, isDiscarded, isIncomingRequested, isOutgoingRequested, isConnected, playGroupCallSound, isHangingUp]);\n\n  useEffect(() => {\n    if (phoneCall?.id) {\n      stopHangingUp();\n    } else {\n      connectToActivePhoneCall();\n    }\n  }, [connectToActivePhoneCall, phoneCall?.id, stopHangingUp]);\n\n  const forceUpdate = useForceUpdate();\n\n  useInterval(forceUpdate, isConnected ? 1000 : undefined);\n\n  const callStatus = useMemo(() => {\n    const state = phoneCall?.state;\n    if (isHangingUp) {\n      return lang('lng_call_status_hanging');\n    }\n    if (isBusy) return 'busy';\n    if (state === 'requesting') {\n      return lang('lng_call_status_requesting');\n    } else if (state === 'requested') {\n      return isOutgoing ? lang('lng_call_status_ringing') : lang('lng_call_status_incoming');\n    } else if (state === 'waiting') {\n      return lang('lng_call_status_waiting');\n    } else if (state === 'active' && isConnected) {\n      return undefined;\n    } else {\n      return lang('lng_call_status_exchanging');\n    }\n  }, [isBusy, isConnected, isHangingUp, isOutgoing, lang, phoneCall?.state]);\n\n  const hasVideo = phoneCall?.videoState === 'active';\n  const hasPresentation = phoneCall?.screencastState === 'active';\n\n  const streams = getStreams();\n  const hasOwnAudio = streams?.ownAudio?.getTracks()[0].enabled;\n  const hasOwnPresentation = streams?.ownPresentation?.getTracks()[0].enabled;\n  const hasOwnVideo = streams?.ownVideo?.getTracks()[0].enabled;\n\n  const [isHidingPresentation, startHidingPresentation, stopHidingPresentation] = useFlag();\n  const [isHidingVideo, startHidingVideo, stopHidingVideo] = useFlag();\n\n  const handleTogglePresentation = useCallback(() => {\n    if (hasOwnPresentation) {\n      startHidingPresentation();\n    }\n    if (hasOwnVideo) {\n      startHidingVideo();\n    }\n    setTimeout(async () => {\n      await toggleStreamP2p('presentation');\n      stopHidingPresentation();\n      stopHidingVideo();\n    }, 250);\n  }, [\n    hasOwnPresentation, hasOwnVideo, startHidingPresentation, startHidingVideo, stopHidingPresentation, stopHidingVideo,\n  ]);\n\n  const handleToggleVideo = useCallback(() => {\n    if (hasOwnVideo) {\n      startHidingVideo();\n    }\n    if (hasOwnPresentation) {\n      startHidingPresentation();\n    }\n    setTimeout(async () => {\n      await toggleStreamP2p('video');\n      stopHidingPresentation();\n      stopHidingVideo();\n    }, 250);\n  }, [\n    hasOwnPresentation, hasOwnVideo, startHidingPresentation, startHidingVideo, stopHidingPresentation, stopHidingVideo,\n  ]);\n\n  const handleToggleAudio = useCallback(() => {\n    void toggleStreamP2p('audio');\n  }, []);\n\n  const [isEmojiOpen, openEmoji, closeEmoji] = useFlag();\n\n  const [isFlipping, startFlipping, stopFlipping] = useFlag();\n\n  const handleFlipCamera = useCallback(() => {\n    startFlipping();\n    switchCameraInputP2p();\n    setTimeout(stopFlipping, 250);\n  }, [startFlipping, stopFlipping]);\n\n  const timeElapsed = phoneCall?.startDate && (getServerTime() - phoneCall.startDate);\n\n  useEffect(() => {\n    if (phoneCall?.state === 'discarded') {\n      setTimeout(hangUp, 250);\n    }\n  }, [hangUp, phoneCall?.reason, phoneCall?.state]);\n\n  return (\n    <Modal\n      isOpen={phoneCall && phoneCall?.state !== 'discarded' && !isCallPanelVisible}\n      onClose={handleClose}\n      className={buildClassName(\n        styles.root,\n        isMobile && styles.singleColumn,\n      )}\n      dialogRef={containerRef}\n    >\n      <Avatar\n        peer={user}\n        size=\"jumbo\"\n        className={hasVideo || hasPresentation ? styles.blurred : ''}\n      />\n      {phoneCall?.screencastState === 'active' && streams?.presentation\n        && <video className={styles.mainVideo} muted autoPlay playsInline srcObject={streams.presentation} />}\n      {phoneCall?.videoState === 'active' && streams?.video\n        && <video className={styles.mainVideo} muted autoPlay playsInline srcObject={streams.video} />}\n      <video\n        className={buildClassName(\n          styles.secondVideo,\n          !isHidingPresentation && hasOwnPresentation && styles.visible,\n          isFullscreen && styles.fullscreen,\n        )}\n        muted\n        autoPlay\n        playsInline\n        srcObject={streams?.ownPresentation}\n      />\n      <video\n        className={buildClassName(\n          styles.secondVideo,\n          !isHidingVideo && hasOwnVideo && styles.visible,\n          isFullscreen && styles.fullscreen,\n        )}\n        muted\n        autoPlay\n        playsInline\n        srcObject={streams?.ownVideo}\n      />\n      <div className={styles.header}>\n        {IS_REQUEST_FULLSCREEN_SUPPORTED && (\n          <Button\n            round\n            size=\"smaller\"\n            color=\"translucent\"\n            iconName={isFullscreen ? 'smallscreen' : 'fullscreen'}\n            onClick={handleToggleFullscreen}\n            ariaLabel={lang(isFullscreen ? 'AccExitFullscreen' : 'AccSwitchToFullscreen')}\n          />\n        )}\n\n        <Button\n          round\n          size=\"smaller\"\n          color=\"translucent\"\n          iconName=\"close\"\n          onClick={handleClose}\n          className={styles.closeButton}\n        />\n      </div>\n      <div\n        className={buildClassName(styles.emojisBackdrop, isEmojiOpen && styles.open)}\n        onClick={!isEmojiOpen ? openEmoji : closeEmoji}\n      >\n        <div className={buildClassName(styles.emojis, isEmojiOpen && styles.open)}>\n          {phoneCall?.isConnected && phoneCall?.emojis && renderText(phoneCall.emojis, ['emoji'])}\n        </div>\n        <div className={buildClassName(styles.emojiTooltip, isEmojiOpen && styles.open)}>\n          {lang('CallEmojiKeyTooltip', user?.firstName).replace('%%', '%')}\n        </div>\n      </div>\n      <div className={styles.userInfo}>\n        <h1>{user?.firstName}</h1>\n        <span className={styles.status}>{callStatus || formatMediaDuration(timeElapsed || 0)}</span>\n      </div>\n      <div className={styles.buttons}>\n        <PhoneCallButton\n          onClick={handleToggleAudio}\n          icon=\"microphone\"\n          isDisabled={!isActive}\n          isActive={hasOwnAudio}\n          label={lang(hasOwnAudio ? 'lng_call_mute_audio' : 'lng_call_unmute_audio')}\n        />\n        <PhoneCallButton\n          onClick={handleToggleVideo}\n          icon=\"video\"\n          isDisabled={!isActive}\n          isActive={hasOwnVideo}\n          label={lang(hasOwnVideo ? 'lng_call_stop_video' : 'lng_call_start_video')}\n        />\n        {hasOwnVideo && (IS_ANDROID || IS_IOS) && (\n          <PhoneCallButton\n            onClick={handleFlipCamera}\n            customIcon={(\n              <AnimatedIcon\n                tgsUrl={LOCAL_TGS_URLS.CameraFlip}\n                playSegment={!isFlipping ? [0, 1] : [0, 10]}\n                size={32}\n              />\n            )}\n            isDisabled={!isActive}\n            label={lang('VoipFlip')}\n          />\n        )}\n        {IS_SCREENSHARE_SUPPORTED && (\n          <PhoneCallButton\n            onClick={handleTogglePresentation}\n            icon=\"share-screen\"\n            isDisabled={!isActive}\n            isActive={hasOwnPresentation}\n            label={lang('lng_call_screencast')}\n          />\n        )}\n        {isIncomingRequested && (\n          <PhoneCallButton\n            onClick={requestMasterAndAcceptCall}\n            icon=\"phone-discard\"\n            isDisabled={isDiscarded}\n            label={lang('lng_call_accept')}\n            className={styles.accept}\n            iconClassName={styles.acceptIcon}\n          />\n        )}\n        <PhoneCallButton\n          onClick={handleHangUp}\n          icon=\"phone-discard\"\n          isDisabled={isDiscarded}\n          label={lang(isIncomingRequested ? 'lng_call_decline' : 'lng_call_end_call')}\n          className={styles.leave}\n        />\n      </div>\n    </Modal>\n  );\n};\n\nexport default memo(withGlobal(\n  (global): Complete<StateProps> => {\n    const { phoneCall, currentUserId } = global;\n    const { isCallPanelVisible, isMasterTab } = selectTabState(global);\n    const user = selectPhoneCallUser(global);\n\n    return {\n      isCallPanelVisible: Boolean(isCallPanelVisible),\n      user,\n      isOutgoing: phoneCall?.adminId === currentUserId,\n      phoneCall: isMasterTab ? phoneCall : undefined,\n    };\n  },\n)(PhoneCall));\n","// extracted by mini-css-extract-plugin\nexport default {\"stars\":\"P7EfDKJN\",\"star\":\"t8LJLFSN\",\"isFilled\":\"_XX6q8YW\",\"comment\":\"EvL0WaKD\",\"visible\":\"v5hn1XvT\"};","import type { FC } from '../../../lib/teact/teact';\nimport {\n  memo, useCallback, useRef, useState,\n} from '../../../lib/teact/teact';\nimport { getActions } from '../../../global';\n\nimport buildClassName from '../../../util/buildClassName';\n\nimport useOldLang from '../../../hooks/useOldLang';\n\nimport Icon from '../../common/icons/Icon';\nimport Button from '../../ui/Button';\nimport InputText from '../../ui/InputText';\nimport Modal from '../../ui/Modal';\n\nimport styles from './RatePhoneCallModal.module.scss';\n\nexport type OwnProps = {\n  isOpen?: boolean;\n};\n\nconst RatePhoneCallModal: FC<OwnProps> = ({\n  isOpen,\n}) => {\n  const { closeCallRatingModal, setCallRating } = getActions();\n\n  const inputRef = useRef<HTMLInputElement>();\n\n  const lang = useOldLang();\n  const [rating, setRating] = useState<number | undefined>();\n\n  const handleSend = useCallback(() => {\n    if (!rating) {\n      closeCallRatingModal();\n      return;\n    }\n    setCallRating({\n      rating: rating + 1,\n      comment: inputRef.current?.value || '',\n    });\n  }, [closeCallRatingModal, rating, setCallRating]);\n\n  function handleClickStar(index: number) {\n    return () => setRating(rating === index ? undefined : index);\n  }\n\n  const handleCancelClick = useCallback(() => {\n    closeCallRatingModal();\n  }, [closeCallRatingModal]);\n\n  return (\n    <Modal title={lang('lng_call_rate_label')} className=\"narrow\" onClose={closeCallRatingModal} isOpen={isOpen}>\n      <div className={styles.stars}>\n        {new Array(5).fill(undefined).map((_, i) => {\n          const isFilled = rating !== undefined && rating >= i;\n          return (\n            <Icon\n              name={isFilled ? 'favorite-filled' : 'favorite'}\n              className={buildClassName(\n                isFilled && styles.isFilled,\n                styles.star,\n              )}\n              onClick={handleClickStar(i)}\n            />\n          );\n        })}\n      </div>\n      <InputText\n        ref={inputRef}\n        placeholder={lang('lng_call_rate_comment')}\n        className={buildClassName(styles.comment, rating !== 4 && rating !== undefined && styles.visible)}\n      />\n\n      <div className=\"dialog-buttons mt-2\">\n        <Button className=\"confirm-dialog-button\" isText onClick={handleSend}>\n          {lang('Send')}\n        </Button>\n        <Button className=\"confirm-dialog-button\" isText onClick={handleCancelClick}>{lang('Cancel')}</Button>\n      </div>\n    </Modal>\n  );\n};\n\nexport default memo(RatePhoneCallModal);\n","import { initializeSoundsForSafari } from '../global/actions/ui/calls';\nimport { IS_IOS, IS_SAFARI } from '../util/browser/windowEnvironment';\n\nexport { default as GroupCall } from '../components/calls/group/GroupCall';\nexport { default as ActiveCallHeader } from '../components/calls/ActiveCallHeader';\nexport { default as PhoneCall } from '../components/calls/phone/PhoneCall';\nexport { default as RatePhoneCallModal } from '../components/calls/phone/RatePhoneCallModal';\n\nif (IS_SAFARI || IS_IOS) {\n  document.addEventListener('click', initializeSoundsForSafari, { once: true });\n}\n","import type { ElementRef } from '../../lib/teact/teact';\nimport { useEffect, useLayoutEffect, useState } from '../../lib/teact/teact';\n\nimport { IS_TAURI } from '../../util/browser/globalEnvironment';\nimport { IS_IOS } from '../../util/browser/windowEnvironment';\n\ntype ReturnType = [boolean, () => void, () => void] | [false];\ntype CallbackType = (isPlayed: boolean) => void;\n\nconst prop = getBrowserFullscreenElementProp();\n\nexport default function useFullscreen<T extends HTMLElement>(elRef: ElementRef<T>, exitCallback?: CallbackType,\n  enterCallback?: CallbackType): ReturnType {\n  const [isFullscreen, setIsFullscreen] = useState(Boolean(prop && document[prop]));\n\n  const setFullscreen = () => {\n    if (!elRef.current || !(prop || IS_IOS) || isFullscreen) {\n      return;\n    }\n    safeRequestFullscreen(elRef.current);\n    setIsFullscreen(true);\n  };\n\n  const exitFullscreen = () => {\n    if (!elRef.current) {\n      return;\n    }\n    safeExitFullscreen();\n    setIsFullscreen(false);\n  };\n\n  useLayoutEffect(() => {\n    const element = elRef.current;\n    const listener = () => {\n      const isEnabled = Boolean(prop && document[prop]);\n      setIsFullscreen(isEnabled);\n      if (isEnabled) {\n        enterCallback?.(false);\n      } else {\n        exitCallback?.(false);\n      }\n      // In Firefox fullscreen video controls are not visible by default, so we force them manually\n      if (element instanceof HTMLVideoElement) element.controls = isEnabled;\n    };\n\n    const listenerEnter = () => {\n      setIsFullscreen(true);\n      if (enterCallback) enterCallback(true);\n    };\n\n    const listenerExit = () => {\n      setIsFullscreen(false);\n      if (exitCallback) exitCallback(false);\n    };\n\n    document.addEventListener('fullscreenchange', listener, false);\n    document.addEventListener('webkitfullscreenchange', listener, false);\n    document.addEventListener('mozfullscreenchange', listener, false);\n\n    if (element) {\n      element.addEventListener('webkitbeginfullscreen', listenerEnter, false);\n      element.addEventListener('webkitendfullscreen', listenerExit, false);\n    }\n\n    return () => {\n      document.removeEventListener('fullscreenchange', listener, false);\n      document.removeEventListener('webkitfullscreenchange', listener, false);\n      document.removeEventListener('mozfullscreenchange', listener, false);\n      if (element) {\n        element.removeEventListener('webkitbeginfullscreen', listenerEnter, false);\n        element.removeEventListener('webkitendfullscreen', listenerExit, false);\n      }\n    };\n    // eslint-disable-next-line\n  }, []);\n\n  if (!prop && !IS_IOS) {\n    return [false];\n  }\n\n  return [isFullscreen, setFullscreen, exitFullscreen];\n}\n\nexport const useFullscreenStatus = () => {\n  const [isFullscreen, setIsFullscreen] = useState(false);\n\n  useEffect(() => {\n    const listener = () => {\n      setIsFullscreen(checkIfFullscreen());\n    };\n\n    let removeTauriListener: VoidFunction | undefined;\n    const setupTauriListener = async () => {\n      const tauriWindow = await window.tauri?.getCurrentWindow();\n      removeTauriListener = await tauriWindow.onResized(() => {\n        tauriWindow.isFullscreen().then(setIsFullscreen);\n      });\n    };\n\n    if (IS_TAURI) {\n      window.tauri?.getCurrentWindow().then((tauriWindow) => {\n        tauriWindow.isFullscreen().then(setIsFullscreen);\n      });\n      setupTauriListener();\n    }\n\n    document.addEventListener('fullscreenchange', listener, false);\n    document.addEventListener('webkitfullscreenchange', listener, false);\n    document.addEventListener('mozfullscreenchange', listener, false);\n\n    return () => {\n      removeTauriListener?.();\n\n      document.removeEventListener('fullscreenchange', listener, false);\n      document.removeEventListener('webkitfullscreenchange', listener, false);\n      document.removeEventListener('mozfullscreenchange', listener, false);\n    };\n  }, []);\n\n  return isFullscreen;\n};\n\nfunction getBrowserFullscreenElementProp() {\n  if (typeof document.fullscreenElement !== 'undefined') {\n    return 'fullscreenElement';\n  } else if (typeof document.mozFullScreenElement !== 'undefined') {\n    return 'mozFullScreenElement';\n  } else if (typeof document.webkitFullscreenElement !== 'undefined') {\n    return 'webkitFullscreenElement';\n  }\n  return '';\n}\n\nexport function checkIfFullscreen() {\n  const fullscreenProp = getBrowserFullscreenElementProp();\n  return Boolean(fullscreenProp && document[fullscreenProp]);\n}\n\nexport function safeRequestFullscreen(element: HTMLElement) {\n  if (element.requestFullscreen) {\n    element.requestFullscreen();\n  } else if (element.webkitRequestFullscreen) {\n    element.webkitRequestFullscreen();\n  } else if (element.webkitEnterFullscreen) {\n    element.webkitEnterFullscreen();\n  } else if (element.mozRequestFullScreen) {\n    element.mozRequestFullScreen();\n  }\n}\n\nexport function safeExitFullscreen() {\n  if (document.exitFullscreen) {\n    document.exitFullscreen();\n  } else if (document.mozCancelFullScreen) {\n    document.mozCancelFullScreen();\n  } else if (document.webkitCancelFullScreen) {\n    document.webkitCancelFullScreen();\n  } else if (document.webkitExitFullscreen) {\n    document.webkitExitFullscreen();\n  }\n}\n","import type { ElementRef } from '@teact';\nimport { memo, type TeactNode, useRef } from '@teact';\n\nimport buildClassName from '../../../util/buildClassName';\nimport buildStyle from '../../../util/buildStyle';\n\nimport Sparkles from '../Sparkles';\n\nimport styles from './GiftEffectWrapper.module.scss';\n\ntype OwnProps = {\n  children: TeactNode;\n  ref?: ElementRef<HTMLDivElement>;\n  className?: string;\n  style?: string;\n  withSparkles?: boolean;\n  sparklesClassName?: string;\n  sparklesColor?: string;\n  glowColor?: string;\n  onClick?: NoneToVoidFunction;\n};\n\nconst GiftEffectWrapper = ({\n  children,\n  ref,\n  className,\n  style,\n  withSparkles,\n  sparklesClassName,\n  sparklesColor,\n  glowColor,\n  onClick,\n}: OwnProps) => {\n  let containerRef = useRef<HTMLDivElement>();\n  if (ref) {\n    containerRef = ref;\n  }\n\n  return (\n    <div\n      ref={containerRef}\n      className={buildClassName(styles.root, className)}\n      style={buildStyle(glowColor && `--glow-color: ${glowColor}`, style)}\n      onClick={onClick}\n    >\n      {withSparkles && (\n        <Sparkles\n          preset=\"button\"\n          className={buildClassName(styles.sparkles, sparklesClassName)}\n          style={buildStyle(sparklesColor && `color: ${sparklesColor}`)}\n        />\n      )}\n      {children}\n    </div>\n  );\n};\n\nexport default memo(GiftEffectWrapper);\n","// extracted by mini-css-extract-plugin\nexport default {\"root\":\"Z9JWyzAs\",\"sparkles\":\"fQBp2vKr\"};","import { useRef } from '../lib/teact/teact';\n\nimport { LoadMoreDirection } from '../types';\n\nimport { areSortedArraysEqual } from '../util/iteratees';\nimport useForceUpdate from './useForceUpdate';\nimport useLastCallback from './useLastCallback';\nimport usePreviousDeprecated from './usePreviousDeprecated';\n\ntype GetMore = (args: { direction: LoadMoreDirection }) => void;\ntype LoadMoreBackwards = (args: { offsetId?: string | number }) => void;\n\nconst DEFAULT_LIST_SLICE = 30;\n\nconst useInfiniteScroll = <ListId extends string | number>(\n  loadMoreBackwards?: LoadMoreBackwards,\n  listIds?: ListId[],\n  isDisabled = false,\n  listSlice = DEFAULT_LIST_SLICE,\n): [ListId[]?, GetMore?, number?] => {\n  const requestParamsRef = useRef<{\n    direction?: LoadMoreDirection;\n    offsetId?: ListId;\n  }>();\n\n  const currentStateRef = useRef<{ viewportIds: ListId[]; isOnTop: boolean; offset: number } | undefined>();\n  if (!currentStateRef.current && listIds && !isDisabled) {\n    const {\n      newViewportIds,\n      newIsOnTop,\n      fromOffset,\n    } = getViewportSlice(listIds, LoadMoreDirection.Forwards, listSlice, listIds[0]);\n    currentStateRef.current = { viewportIds: newViewportIds, isOnTop: newIsOnTop, offset: fromOffset };\n  }\n\n  const forceUpdate = useForceUpdate();\n\n  if (isDisabled) {\n    requestParamsRef.current = {};\n  }\n\n  const prevListIds = usePreviousDeprecated(listIds);\n  const prevIsDisabled = usePreviousDeprecated(isDisabled);\n  if (listIds && !isDisabled && (listIds !== prevListIds || isDisabled !== prevIsDisabled)) {\n    const { viewportIds, isOnTop } = currentStateRef.current || {};\n    const currentMiddleId = viewportIds && !isOnTop ? viewportIds[Math.round(viewportIds.length / 2)] : undefined;\n    const defaultOffsetId = currentMiddleId && listIds.includes(currentMiddleId) ? currentMiddleId : listIds[0];\n    const { offsetId = defaultOffsetId, direction = LoadMoreDirection.Forwards } = requestParamsRef.current || {};\n    const { newViewportIds, newIsOnTop, fromOffset } = getViewportSlice(listIds, direction, listSlice, offsetId);\n\n    requestParamsRef.current = {};\n\n    if (!viewportIds || !areSortedArraysEqual(viewportIds, newViewportIds)) {\n      currentStateRef.current = { viewportIds: newViewportIds, isOnTop: newIsOnTop, offset: fromOffset };\n    }\n  } else if (!listIds) {\n    currentStateRef.current = undefined;\n  }\n\n  const getMore: GetMore = useLastCallback(({\n    direction,\n    noScroll,\n  }: { direction: LoadMoreDirection; noScroll?: boolean }) => {\n    const { viewportIds } = currentStateRef.current || {};\n\n    const offsetId = viewportIds\n      ? direction === LoadMoreDirection.Backwards ? viewportIds[viewportIds.length - 1] : viewportIds[0]\n      : undefined;\n\n    if (!listIds) {\n      if (loadMoreBackwards) {\n        loadMoreBackwards({ offsetId });\n      }\n\n      return;\n    }\n\n    const {\n      newViewportIds, areSomeLocal, areAllLocal, newIsOnTop, fromOffset,\n    } = getViewportSlice(listIds, direction, listSlice, offsetId);\n\n    if (areSomeLocal && !(viewportIds && areSortedArraysEqual(viewportIds, newViewportIds))) {\n      currentStateRef.current = { viewportIds: newViewportIds, isOnTop: newIsOnTop, offset: fromOffset };\n      forceUpdate();\n    }\n\n    if (!areAllLocal && loadMoreBackwards) {\n      if (!noScroll) {\n        requestParamsRef.current = { ...requestParamsRef.current, direction, offsetId };\n      }\n\n      loadMoreBackwards({ offsetId });\n    }\n  });\n\n  return isDisabled ? [listIds] : [currentStateRef.current?.viewportIds, getMore, currentStateRef.current?.offset];\n};\n\nfunction getViewportSlice<ListId extends string | number>(\n  sourceIds: ListId[],\n  direction: LoadMoreDirection,\n  listSlice: number,\n  offsetId?: ListId,\n) {\n  const { length } = sourceIds;\n  const index = offsetId ? sourceIds.indexOf(offsetId) : 0;\n  const isForwards = direction === LoadMoreDirection.Forwards;\n  const indexForDirection = isForwards ? index : (index + 1) || length;\n  const from = Math.max(0, indexForDirection - listSlice);\n  const to = indexForDirection + listSlice - 1;\n  const newViewportIds = sourceIds.slice(Math.max(0, from), to + 1);\n\n  let areSomeLocal;\n  let areAllLocal;\n  switch (direction) {\n    case LoadMoreDirection.Forwards:\n      areSomeLocal = indexForDirection >= 0;\n      areAllLocal = from >= 0;\n      break;\n    case LoadMoreDirection.Backwards:\n      areSomeLocal = indexForDirection < length;\n      areAllLocal = to <= length - 1;\n      break;\n  }\n\n  return {\n    newViewportIds,\n    areSomeLocal,\n    areAllLocal,\n    newIsOnTop: newViewportIds[0] === sourceIds[0],\n    fromOffset: from,\n  };\n}\n\nexport default useInfiniteScroll;\n"],"names":["memo","withGlobal","global","userId","chat","selectCurrentChat","user","selectUser","contactName","getUserFirstOrLastName","undefined","DeleteMemberModal","isOpen","onClose","deleteChatMember","getActions","lang","useOldLang","handleDeleteChatMember","useCallback","chatId","id","_jsx","ConfirmDialog","title","textParts","renderText","confirmLabel","confirmHandler","confirmIsDestructive","FakeIcon","fakeType","useLang","className","children","resetScroll","container","scrollTop","IS_IOS","style","overflow","mul_table","shg_table","boxBlurCanvasRGB","context","top_x","top_y","width","height","radius","iterations","Number","isNaN","imageData","getImageData","pixels","data","rsum","gsum","bsum","x","y","i","p","p1","p2","yp","yi","yw","wm","hm","rad1","r","g","b","mul_sum","shg_sum","vmin","vmax","putImageData","VerifiedIcon","_jsxs","viewBox","d","FullNameTitle","peer","noVerified","noFake","withEmojiStatus","emojiStatusSize","isSavedMessages","isSavedDialog","noLoopLimit","canCopyTitle","iconElement","isMonoforum","monoforumBadgeClassName","withStatusTextColor","onEmojiStatusClick","observeIntersection","showNotification","oldLang","realPeer","customPeer","isUser","isApiPeerUser","getUserFullName","getChatTitle","isPremium","canShowEmojiStatus","emojiStatus","emojiStatusId","type","documentId","handleTitleClick","useLastCallback","e","stopEvent","copyTextToClipboard","message","specialTitle","useMemo","titleKey","isAnonymousForwardsChat","isChatWithRepliesBot","isChatWithVerificationCodesBot","botVerificationIconId","buildClassName","CustomEmoji","size","loopLimit","EMOJI_STATUS_LOOP_LIMIT","observeIntersectionForLoading","dir","role","onClick","_Fragment","isVerified","Transition","slideClassName","activeKey","name","direction","shouldCleanup","GiftEffectWrapper","withSparkles","sparklesClassName","sparklesColor","textColor","StarIcon","IconWithSpinner","iconName","isLoading","Spinner","color","Icon","selectChatGroupCall","fullInfo","selectChatFullInfo","groupCallId","selectGroupCall","groupCalls","byId","selectGroupCallParticipant","participantId","participants","selectIsAdminInActiveGroupCall","selectActiveGroupCall","selectChat","isChatBasicGroup","isCreator","Boolean","adminRights","manageCall","activeGroupCallId","selectPhoneCallUser","phoneCall","currentUserId","adminId","selectCanInviteToActiveGroupCall","groupCall","getMainUsername","inviteLink","toTelegramSource","source","fromTelegramSource","getAmplitude","array","scale","length","total","rms","Math","sqrt","min","p2pPayloadTypeToConference","feedbackTypes","clockrate","parameters","channels","THRESHOLD","IS_SCREENSHARE_SUPPORTED","navigator","mediaDevices","IS_ECHO_CANCELLATION_SUPPORTED","getSupportedConstraints","echoCancellation","IS_NOISE_SUPPRESSION_SUPPORTED","noiseSuppression","sessionDescription","isP2p","sdp","Error","sections","split","map","s","reduce","acc","el","match","hasOwnProperty","filter","lookup","prefix","sectionName","find","line","startsWith","substr","Object","values","section","parseExtmaps","l","uri","parsePayloadTypes","payloads","fbParams","subtype","q","value","some","z","payload","assign","f","keys","rawSource","sourceAudio","rawSourceVideo","rawSourceScreencast","hash","fingerprint","setup","console","log","ufrag","pwd","fingerprints","ssrc","semantics","sources","slice","audioExtmap","videoExtmap","screencastExtmap","audioPayloadTypes","videoPayloadTypes","screencastPayloadTypes","conference","isAnswer","isPresentation","lines","add","push","sessionId","ssrcs","audioExtensions","videoExtensions","transport","candidates","mid","join","addCandidate","c","sdpString","str","foundation","component","protocol","priority","ip","port","generation","addTransport","forEach","addPayloadType","payloadType","parametersString","key","fbParam","addSsrcEntry","entry","payloadTypes","isVideo","isMain","isRemoved","sourceGroups","sourceGroup","ssrcTelegram","endpoint","silence","ctx","oscillator","createOscillator","dst","connect","createMediaStreamDestination","start","MediaStream","stream","getAudioTracks","enabled","black","canvas","document","createElement","getContext","fillRect","captureStream","getVideoTracks","state","leavePresentation","isFromToggle","screenshareDataChannel","close","screenshareConnection","onUpdate","getUserStreams","streams","setVolume","volume","participantFunctions","isStreamEnabled","streamType","myId","getTracks","updateGroupCallStreams","hasAudioStream","hasVideoStream","hasPresentationStream","amplitude","speaking","async","getUserStream","facing","audioStream","getDisplayMedia","audio","video","media","getUserMedia","facingMode","vid","srcObject","deferred","Deferred","oncanplay","resolve","promise","toggleStream","connection","track","sender","getSenders","newStream","replaceTrack","audioContext","audioSource","createMediaStreamSource","analyser","audioAnalyser","createAnalyser","minDecibels","maxDecibels","smoothingTimeConstant","fftSize","getCurrentAmplitude","Uint8Array","frequencyBinCount","getByteFrequencyData","stop","disconnect","updateConnectionState","connectionState","leaveGroupCall","dataChannel","analyserInterval","clearInterval","analyzeAmplitudes","prevAmplitude","handleUpdateGroupCallParticipants","updatedParticipants","participant","isSelf","newEndpoints","isMuted","canSelfUnmute","isLeft","isAudioLeft","isMutedByMe","isVideoLeft","isVideoJoined","isPresentationLeft","presentation","hasVideo","hasAudio","hasPresentation","lastMid","toString","updatingParticipantsQueue","buildSdp","setRemoteDescription","answer","createAnswer","setLocalDescription","newConference","answerNew","error","handleTrack","audioElement","mediaStream","kind","onended","window","AudioContext","gainNode","createGain","gain","muteNode","destination","addTrack","test","Audio","muted","remove","toggleMute","initializeConnection","RTCPeerConnection","createDataChannel","onopen","onmessage","JSON","parse","colibriClass","onerror","oniceconnectionstatechange","iceConnectionState","onconnectionstatechange","ontrack","onnegotiationneeded","offer","createOffer","offerToReceiveVideo","offerToReceiveAudio","parseSdp","audioSsrc","videoSsrc","screenshareConference","videoStream","updateStreams","mediaState","toggleStreamP2p","ownAudio","ownVideo","ownPresentation","blackVideo","blackPresentation","sendMediaState","err","stopPhoneCall","emitSignalingData","videoRotation","isBatteryLow","videoState","screencastState","filterVP8","mediaContent","isOutgoing","idx","findIndex","vp8PayloadType","rtxIdx","apt","sendInitialSetup","ssrcGroups","rtpExtensions","screencast","processSignalingMessage","pendingCandidates","gotInitialSetup","candidate","commitPendingIceCandidates","xmlns","Date","now","localDescription","Promise","all","addIceCandidate","sdpMLineIndex","tryAddCandidate","conn","params","addActionHandler","actions","isFromLibrary","shouldDiscard","shouldRemove","rejoin","isPageUnload","tabId","getCurrentTabId","updateActiveGroupCall","participantsCount","setGlobal","callApi","call","getGlobal","removeGroupCall","removeGroupCallAudioElement","toggleGroupCallPanel","force","afterHangUp","requestMasterAndJoinGroupCall","videoStopped","raiseHand","floor","GROUP_CALL_VOLUME_MULTIPLIER","startSharingScreen","presentationPaused","getGroupCallAudioElement","getGroupCallAudioContext","safePlay","setInterval","joinGroupCall","apiUpdate","result","inviteHash","loadMoreGroupCallParticipants","loadFullChat","dhConfig","gAHash","hangUp","gB","stringify","encodedData","updateTabState","ratingPhoneCall","rating","comment","selectTabState","setTimeout","EMOJI_DATA","Uint16Array","EMOJI_OFFSETS","update","toggleGroupCallPresentation","updateGroupCallParticipant","omit","updateGroupCall","isSpeakerDisabled","handleUpdateGroupCallConnection","ARE_CALLS_SUPPORTED","isBusy","accessHash","connections","libraryVersions","version","langProvider","firstName","needRating","isCallPanelVisible","gA","keyFingerprint","emojis","newCall","gAOrB","shouldStartVideo","iceServers","urls","isTurn","isStun","username","credentialType","credential","password","iceTransportPolicy","bundlePolicy","iceCandidatePoolSize","onicecandidate","play","catch","transceiver","iceRestart","slnc","screenshare","dc","negotiated","joinPhoneCall","sendSignalingData","isP2pAllowed","isConnected","then","formatGroupCallVolume","GROUP_CALL_DEFAULT_VOLUME","SPEAKER_ICON_DISABLED_SEGMENT","SPEAKER_ICON_ENABLED_SEGMENT","isAdmin","GroupCallParticipantMenu","onCloseAnimationEnd","isDropdownOpen","menuRef","menuPositionOptions","toggleGroupCallMute","setGroupCallParticipantVolume","openChat","requestToSpeak","isDeleteUserModalOpen","openDeleteUserModal","closeDeleteUserModal","useFlag","isRaiseHand","raiseHandRating","shouldRaiseHand","localVolume","setLocalVolume","useState","shouldPlay","setShouldPlay","isLocalVolumeZero","speakerIconPlaySegment","useEffect","handleSetLocalVolume","runThrottled","ms","noFirst","deps","useThrottledCallback","cb","useRunThrottled","handleRemove","stopPropagation","handleCancelRequestToSpeak","handleMute","handleOpenProfile","Menu","ref","withPortal","max","onChange","target","AnimatedIcon","tgsUrl","LOCAL_TGS_URLS","Speaker","playSegment","MenuItem","icon","destructive","OutlinedMicrophoneIcon","noColor","isSpeaking","prevIsRaiseHand","usePreviousDeprecated","prevIsMuted","microphoneColor","VoiceOutlined","forceAlways","nonInteractive","GroupCallParticipant","useRef","isContextMenuOpen","contextMenuAnchor","handleContextMenu","handleBeforeContextMenu","handleContextMenuClose","handleContextMenuHide","useContextMenuHandlers","getTriggerElement","current","getRootElement","closest","getMenuElement","getLayout","hasCustomVolume","aboutText","aboutColor","styles","subtitleRed","subtitleBlue","replace","subtitleGreen","about","ListItem","leftElement","Avatar","avatar","rightElement","root","onMouseDown","onContextMenu","multiline","ripple","subtitle","subtitleText","anchor","compareParticipants","a","compareFields","GroupCallParticipantList","panelOffset","isLandscape","orderedParticipantIds","sort","handleLoadMoreGroupCallParticipants","viewportIds","getMore","useInfiniteScroll","InfiniteScroll","items","onLoadMore","teactOrderKey","indexOf","GroupCallParticipantVideo","layout","pinnedVideo","setPinned","canPin","thumbnailRef","videoRef","videoFallbackRef","noAnimate","isPinned","shouldFlipVideo","status","prevLayoutRef","prevX","prevY","prevWidth","prevHeight","currentX","currentY","currentWidth","currentHeight","isHidden","setIsHidden","actualStream","streamRef","active","handleInactive","addEventListener","removeEventListener","setIsLoading","handleCanPlay","useInterval","requestMutation","videoWidth","videoHeight","drawImage","thumbnail","alpha","isDrawing","animate","draw","IS_CANVAS_FILTER_SUPPORTED","fastBlur","fastRaf","handleClickPin","onDoubleClick","Skeleton","autoPlay","playsInline","onCanPlay","Button","round","ariaLabel","vibrateShort","vibrate","meParticipant","hasRequestedToSpeak","noAudioStream","MicrophoneButton","playGroupCallSound","muteMouseDownState","isRequestingToSpeak","setIsRequestingToSpeak","isConnecting","prevShouldRaiseHand","sound","random","animatedIconName","handleMouseDownMute","handleMouseUpMute","onMouseUp","disabled","canInvite","GroupCall","toggleGroupCallVideo","connectToActiveGroupCall","createGroupCallInviteLink","containerRef","primaryVideoContainerRef","secondaryVideoContainerRef","panelScrollTriggerRef","panelRef","isLeaving","setIsLeaving","observe","useIntersectionObserver","rootRef","throttleMs","isDisabled","hasScrolled","useIsIntersecting","isMobile","useAppLayout","isFullscreen","openFullscreen","closeFullscreen","isSidebarOpen","openSidebar","closeSidebar","isLandscapeLayout","isAppFullscreen","useFullscreenStatus","firstPresentation","videoParticipants","flatMap","compact","hasVideoParticipants","groupCallTitle","membersString","isConfirmLeaveModalOpen","openConfirmLeaveModal","closeConfirmLeaveModal","isEndGroupCallModal","setIsEndGroupCallModal","shouldEndGroupCall","setShouldEndGroupCall","canRequestToSpeak","handleCloseConfirmLeaveModal","handleToggleFullscreen","handleToggleSidebar","handleToggleGroupCallPanel","handleInviteMember","handleClickVideo","handleLeaveGroupCall","handleCloseAnimationEnd","handleToggleGroupCallPresentation","canPinVideo","isLandscapeWithVideos","setPinnedVideo","videoLayout","primaryContainerRef","secondaryContainerRef","setVideoLayout","setPanelOffset","videosCount","prevVideosCount","prevVideoParticipants","removedVideoParticipants","recalculateLayout","primaryContainer","secondaryContainer","removed","secondaryInitialX","secondaryInitialY","secondaryContainerWidth","getBoundingClientRect","isRemounted","pinnedPush","skip","pinnedSkipIndex","initialX","initialY","containerWidth","containerHeight","orderKey","videoType","secondaryVideosCounts","isFirstBig","columns","rows","ceil","smallWidth","heightTotal","isBig","realIndex","PREFERRED_PANEL_VIDEO_HEIGHT","shouldRemount","splice","calculateColumnsCount","shouldFillLastRow","lastRowWidth","row","useResizeObserver","useGroupCallVideoLayout","handleSetPinnedVideo","handleOpenFirstPresentation","Modal","fullscreen","appFullscreen","landscape","noVideoParticipants","portrait","noSidebar","dialogRef","videos","videosHeader","headerButton","firstButton","bigger","videosHeaderLastButton","videosContent","panelWrapper","panel","panelScrollTrigger","panelHeader","scrolled","panelHeaderText","lastButton","participantVideos","FloatingActionButton","isShown","addParticipantButton","mainVideoContainer","actionButton","Checkbox","label","checked","onCheck","isText","tabState","isMasterTab","phoneCallUser","ActiveCallHeader","body","classList","toggle","tauri","markTitleBarOverlay","PhoneCallButton","customIcon","iconClassName","isActive","PhoneCall","requestMasterAndAcceptCall","connectToActivePhoneCall","toggleFullscreen","exitFullscreen","requestFullscreen","IS_REQUEST_FULLSCREEN_SUPPORTED","handleClose","isDiscarded","reason","isIncomingRequested","isOutgoingRequested","isHangingUp","startHangingUp","stopHangingUp","handleHangUp","forceUpdate","useForceUpdate","callStatus","hasOwnAudio","hasOwnPresentation","hasOwnVideo","isHidingPresentation","startHidingPresentation","stopHidingPresentation","isHidingVideo","startHidingVideo","stopHidingVideo","handleTogglePresentation","handleToggleVideo","handleToggleAudio","isEmojiOpen","openEmoji","closeEmoji","isFlipping","startFlipping","stopFlipping","handleFlipCamera","switchCameraInputP2p","timeElapsed","startDate","getServerTime","singleColumn","blurred","mainVideo","secondVideo","visible","header","closeButton","emojisBackdrop","open","emojiTooltip","userInfo","formatMediaDuration","buttons","IS_ANDROID","CameraFlip","accept","acceptIcon","leave","RatePhoneCallModal","closeCallRatingModal","setCallRating","inputRef","setRating","handleSend","handleCancelClick","Array","fill","_","isFilled","index","InputText","placeholder","IS_SAFARI","initializeSoundsForSafari","once","prop","getBrowserFullscreenElementProp","useFullscreen","elRef","exitCallback","enterCallback","setIsFullscreen","useLayoutEffect","element","listener","isEnabled","HTMLVideoElement","controls","listenerEnter","listenerExit","setFullscreen","webkitRequestFullscreen","webkitEnterFullscreen","mozRequestFullScreen","mozCancelFullScreen","webkitCancelFullScreen","webkitExitFullscreen","checkIfFullscreen","removeTauriListener","IS_TAURI","getCurrentWindow","tauriWindow","onResized","setupTauriListener","fullscreenElement","mozFullScreenElement","webkitFullscreenElement","fullscreenProp","glowColor","buildStyle","Sparkles","preset","getViewportSlice","sourceIds","listSlice","offsetId","indexForDirection","LoadMoreDirection","Forwards","from","to","newViewportIds","areSomeLocal","areAllLocal","Backwards","newIsOnTop","fromOffset","loadMoreBackwards","listIds","requestParamsRef","currentStateRef","isOnTop","offset","prevListIds","prevIsDisabled","currentMiddleId","defaultOffsetId","includes","areSortedArraysEqual","noScroll"],"ignoreList":[],"sourceRoot":""}